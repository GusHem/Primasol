<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prima Sol - Offertverktyg</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Animationer */
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }

        /* Utskriftsanpassning */
        @media print {
            body { background: white; }
            #main-layout { display: block; }
            #config-panel, #ai-panel, #header-controls, .no-print { display: none !important; }
            #quote-section { width: 100%; border: none; shadow: none; }
            #quote-items { overflow: visible; height: auto; }
            header { border-bottom: 2px solid #000; margin-bottom: 20px; }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col text-slate-800">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm">
        <div class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <div class="flex items-center gap-6">
                <!-- KUNDLOGGA -->
                <div class="h-12 w-auto">
                    <img src="https://raw.githubusercontent.com/GusHem/Primasol/refs/heads/main/Prima%20Sol%20As%20Logga%202.svg" alt="Prima Sol As" class="h-full object-contain">
                </div>
                <div class="h-8 w-px bg-slate-200 hidden md:block"></div>
                <div>
                    <h1 class="text-sm font-bold text-slate-900 uppercase tracking-wider">Offertverktyg</h1>
                    <p class="text-xs text-slate-500">Neva & Screen Prislistor</p>
                </div>
            </div>
            
            <div id="header-controls" class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-xs text-slate-400">Inloggad</p>
                    <p class="text-sm font-medium text-slate-700">Säljare</p>
                </div>
                <div class="bg-slate-100 p-2 rounded-full text-slate-500 border border-slate-200">
                    <i class="fa-solid fa-user"></i>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-6 flex-grow w-full">
        <div id="main-layout" class="grid grid-cols-1 lg:grid-cols-12 gap-8 h-[calc(100vh-8rem)]">

            <!-- VÄNSTER: Konfigurator (5 kolumner) -->
            <div id="config-panel" class="lg:col-span-5 flex flex-col gap-6 overflow-y-auto custom-scroll pr-2 pb-10">
                
                <!-- 1. Produktval -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="bg-slate-800 px-5 py-3 flex justify-between items-center">
                        <h2 class="text-white font-semibold text-sm flex items-center gap-2">
                            <i class="fa-solid fa-gear"></i> 1. Konfigurera Produkt
                        </h2>
                    </div>
                    
                    <div class="p-5 space-y-5">
                        
                        <!-- Katalog -->
                        <div>
                            <label class="text-xs font-bold text-slate-500 uppercase mb-2 block">Katalog</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="vendor" value="screen_2025" class="peer sr-only" checked>
                                    <div class="py-2.5 px-3 text-center rounded-lg border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 peer-checked:bg-blue-50 peer-checked:border-blue-600 peer-checked:text-blue-700 peer-checked:shadow-sm transition-all">
                                        Hansen Screen
                                    </div>
                                </label>
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="vendor" value="neva_2023" class="peer sr-only">
                                    <div class="py-2.5 px-3 text-center rounded-lg border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 peer-checked:bg-orange-50 peer-checked:border-orange-600 peer-checked:text-orange-700 peer-checked:shadow-sm transition-all">
                                        Neva Persienner
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Dropdowns -->
                        <div class="grid grid-cols-1 gap-4">
                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Produktfamilj</label>
                                <div class="relative">
                                    <select id="category" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer appearance-none">
                                        <!-- JS fyller -->
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-chevron-down text-xs"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Modell</label>
                                <div class="relative">
                                    <select id="product" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer disabled:opacity-50 disabled:bg-slate-100" disabled>
                                        <option>-- Välj familj --</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-chevron-down text-xs"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mått -->
                        <div class="bg-blue-50 rounded-lg border border-blue-100 p-4">
                            <div class="flex justify-between mb-2">
                                <label class="text-xs font-bold text-blue-800 uppercase">Dimensioner (cm)</label>
                                <span id="dim-limits" class="text-[10px] text-blue-600 bg-white px-2 rounded-full border border-blue-200 hidden"></span>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="relative">
                                    <span class="absolute left-3 top-2.5 text-blue-400 text-xs font-bold">B</span>
                                    <input type="number" id="width" class="w-full pl-8 p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-500 outline-none font-mono font-bold text-slate-700" placeholder="Bredd">
                                </div>
                                <div class="relative">
                                    <span class="absolute left-3 top-2.5 text-blue-400 text-xs font-bold">H</span>
                                    <input type="number" id="height" class="w-full pl-8 p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-500 outline-none font-mono font-bold text-slate-700" placeholder="Höjd">
                                </div>
                            </div>
                        </div>

                        <!-- BERÄKNA KNAPP -->
                        <button id="calculate-btn" class="w-full bg-white border-2 border-slate-800 text-slate-800 hover:bg-slate-50 font-bold py-3 px-4 rounded-lg shadow-sm transition flex items-center justify-center gap-2">
                            <i class="fa-solid fa-calculator"></i> Beräkna Styckpris
                        </button>
                        
                        <div id="error-msg" class="hidden text-xs text-red-600 font-medium bg-red-50 p-3 rounded-lg border border-red-100 flex items-center gap-2">
                            <i class="fa-solid fa-triangle-exclamation"></i> <span id="error-text"></span>
                        </div>

                    </div>
                </div>

                <!-- 2. RESULTAT & LÄGG TILL (Visas efter beräkning) -->
                <div id="add-panel" class="bg-white rounded-xl shadow-md border border-green-200 overflow-hidden hidden transition-all duration-500 transform translate-y-4 opacity-0">
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-5 border-b border-green-100">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-xs text-green-700 font-bold uppercase tracking-wide">Beräknat Styckpris</p>
                                <div class="flex items-baseline gap-1">
                                    <span id="display-price" class="text-3xl font-black text-slate-900">0</span>
                                    <span class="text-sm font-bold text-slate-500">NOK</span>
                                </div>
                            </div>
                            <div class="text-right text-xs text-slate-500">
                                <p>Tabellmatchning:</p>
                                <p id="display-dims" class="font-mono font-bold">--</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-5 bg-white">
                        <div class="flex items-end gap-4">
                            <div class="flex-1">
                                <label class="text-xs font-bold text-slate-500 uppercase mb-1 block">Antal</label>
                                <div class="flex items-center h-10">
                                    <button onclick="changeQty(-1)" class="h-full px-3 bg-slate-100 border border-r-0 border-slate-300 rounded-l hover:bg-slate-200 text-slate-600 font-bold">-</button>
                                    <input type="number" id="quantity" value="1" min="1" class="h-full w-full border-y border-slate-300 outline-none text-center font-bold text-slate-800">
                                    <button onclick="changeQty(1)" class="h-full px-3 bg-slate-100 border border-l-0 border-slate-300 rounded-r hover:bg-slate-200 text-slate-600 font-bold">+</button>
                                </div>
                            </div>
                            <button id="add-to-quote-btn" class="flex-[2] h-10 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md shadow-green-200 transition flex items-center justify-center gap-2">
                                <i class="fa-solid fa-cart-plus"></i> Lägg till i Offert
                            </button>
                        </div>
                    </div>
                </div>

                <!-- AI (Kompakt) -->
                <div class="bg-indigo-50 rounded-xl border border-indigo-100 p-4 flex items-start gap-3">
                    <div class="bg-white p-2 rounded-full text-indigo-600 shadow-sm flex-shrink-0">
                        <i class="fa-solid fa-robot"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <h3 class="text-sm font-bold text-indigo-900">Produktassistent</h3>
                        <div class="flex gap-2 mt-2">
                            <input type="text" id="ai-input" class="w-full text-xs p-2 rounded border border-indigo-200 focus:ring-1 focus:ring-indigo-500 outline-none" placeholder="Fråga om tex RS Smart XL...">
                            <button onclick="handleChat()" class="bg-indigo-600 text-white px-3 py-1 rounded text-xs hover:bg-indigo-700 transition">Fråga</button>
                        </div>
                        <div id="ai-response" class="hidden mt-2 text-xs text-slate-700 bg-white p-2 rounded border border-indigo-100 shadow-sm leading-relaxed"></div>
                    </div>
                </div>

            </div>

            <!-- HÖGER: Offertöversikt / Varukorg (7 kolumner) -->
            <div id="quote-section" class="lg:col-span-7 bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col h-full min-h-[600px]">
                
                <!-- Quote Header -->
                <div class="px-6 py-4 border-b border-slate-200 bg-slate-50/80 rounded-t-2xl flex justify-between items-center">
                    <div>
                        <h2 class="font-bold text-slate-800 text-lg flex items-center gap-2">
                            <i class="fa-solid fa-file-invoice text-slate-400"></i> Aktuell Offert
                        </h2>
                        <div class="text-[10px] text-slate-500 mt-1 flex gap-3">
                            <span>Datum: <span id="current-date" class="font-medium text-slate-700"></span></span>
                            <span class="w-px h-3 bg-slate-300"></span>
                            <span>Ref: <span id="ref-id" class="font-medium text-slate-700"></span></span>
                        </div>
                    </div>
                    <span id="quote-count" class="bg-slate-200 text-slate-600 text-xs font-bold px-2 py-1 rounded-full">0 artiklar</span>
                </div>

                <!-- Table Header -->
                <div class="grid grid-cols-12 gap-2 px-6 py-2 bg-slate-100 text-[10px] font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200">
                    <div class="col-span-5">Produktbeskrivning</div>
                    <div class="col-span-2 text-center">Mått (cm)</div>
                    <div class="col-span-2 text-center">Antal</div>
                    <div class="col-span-2 text-right">Belopp</div>
                    <div class="col-span-1"></div>
                </div>

                <!-- Quote Items -->
                <div id="quote-items" class="flex-1 overflow-y-auto custom-scroll p-2 space-y-1 bg-white">
                    <!-- Empty State -->
                    <div id="empty-state" class="flex flex-col items-center justify-center h-full text-slate-300">
                        <i class="fa-solid fa-cart-arrow-down text-5xl mb-3 opacity-20"></i>
                        <p class="text-sm font-medium">Listan är tom</p>
                        <p class="text-xs">Gör en beräkning till vänster för att börja</p>
                    </div>
                </div>

                <!-- Quote Footer -->
                <div class="p-6 bg-slate-50 border-t border-slate-200 rounded-b-2xl">
                    <div class="flex flex-col items-end gap-1 mb-6">
                        <div class="text-sm text-slate-500 font-medium">Totalt Netto (exkl. motor)</div>
                        <div class="text-4xl font-black text-slate-900 tracking-tight" id="total-price">0 NOK</div>
                    </div>
                    
                    <div class="flex gap-3 justify-end no-print">
                        <button onclick="clearQuote()" class="px-4 py-2.5 text-sm text-red-600 font-semibold hover:bg-red-50 rounded-lg transition">
                            Rensa
                        </button>
                        <button onclick="window.print()" class="px-6 py-2.5 bg-slate-900 text-white text-sm font-bold rounded-lg hover:bg-slate-800 transition shadow-lg flex items-center gap-2">
                            <i class="fa-solid fa-print"></i> Exportera PDF / Skriv ut
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        // --- DATABAS ---
        const database = {
            "screen_2025": {
                "name": "Hansen Screen",
                "unit": "cm",
                "currency": "NOK",
                "categories": {
                    "RS Classic": {
                        "RS Classic 75": { base: 2154, stepW: 100, stepH: 100, factor: 1.04, range: {minW: 60, maxW: 230, minH: 60, maxH: 170} },
                        "RS Classic 85": { base: 2213, stepW: 100, stepH: 100, factor: 1.04, range: {minW: 60, maxW: 300, minH: 60, maxH: 320} },
                        "RS Classic 95": { base: 2301, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 350, minH: 60, maxH: 350} },
                        "RS Classic 105": { base: 2550, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 70, maxW: 450, minH: 60, maxH: 350} },
                        "RS Classic 120": { base: 2693, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 450, minH: 80, maxH: 450} },
                        "RS Classic 125": { base: 2693, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 450, minH: 80, maxH: 450} }
                    },
                    "Mini ZIP": {
                        "Mini ZIP": { base: 2482, stepW: 100, stepH: 100, factor: 1.035, range: {minW: 60, maxW: 340, minH: 60, maxH: 170} }
                    },
                    "RS Universal": {
                        "RS Universal 85": { base: 2475, stepW: 100, stepH: 100, factor: 1.045, range: {minW: 60, maxW: 300, minH: 60, maxH: 200} },
                        "RS Universal 95": { base: 2535, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 350, minH: 60, maxH: 350} },
                        "RS Universal 105": { base: 2715, stepW: 100, stepH: 100, factor: 1.055, range: {minW: 70, maxW: 450, minH: 60, maxH: 350} },
                        "RS Universal 120": { base: 2790, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 500, minH: 80, maxH: 500} },
                        "RS Universal 125": { base: 2790, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 500, minH: 80, maxH: 500} }
                    },
                    "RS Smart": {
                        "RS Smart 85": { base: 2715, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 300, minH: 60, maxH: 200} },
                        "RS Smart 100": { base: 3030, stepW: 100, stepH: 100, factor: 1.055, range: {minW: 70, maxW: 400, minH: 60, maxH: 350} },
                        "RS Smart 130": { base: 3480, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 500} },
                        "RS Smart 130 XL": { base: 14448, stepW: 610, stepH: 100, factor: 1.015, range: {minW: 610, maxW: 700, minH: 100, maxH: 300} }
                    }
                }
            },
            "neva_2023": {
                "name": "Neva Utvendig",
                "unit": "mm", 
                "currency": "NOK",
                "categories": {
                    "Utvendige Persienner": {
                        "C80 / F80": { base: 2410, stepW: 700, stepH: 700, factor: 1.04, range: {minW: 600, maxW: 5000, minH: 600, maxH: 5000} },
                    }
                }
            }
        };

        // Matrisdata för exakta priser (Alternativ A - Komplett lista)
        const priceMatrices = {
            // --- NEVA ---
            "C80 / F80": {
                 w: [600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000],
                 h: [600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000],
                 prices: [
                    [2410,2450,2500,2530,2570,2610,2650,2730,2690,2790,2830,2880,2920,3040,2960,3000,3230,3080,3120,3180,3270,3310,3350,3790,3840,3880,3920,3970,4070,4020,4120,4150,4200,4240,4280,4370,4330,4410,4530,4490,4580,4620,4670,4710,4750],
                    [2480,2500,2540,2580,2640,2680,2730,2770,2810,2890,2930,2990,3030,3070,3120,3100,3220,3260,3300,3380,3420,3520,3470,3900,4000,4040,4100,4140,4240,4280,4340,4380,4440,4480,4530,4580,4630,4700,4680,4810,4800,4910,4900,5000,5050],
                    [2510,2540,2590,2640,2650,2740,2790,2890,2840,2960,3020,3130,3070,3280,3230,3180,3430,3380,3320,3510,3560,3580,3620,4190,4250,4310,4340,4470,4570,4630,4650,4710,4800,4850,4910,4970,5020,5080,5200,5320,5380,5440,5400,5500,5550],
                    [2550,2580,2640,2690,2750,2810,2870,2920,2980,3060,3120,3180,3040,3290,3390,3400,3470,3520,3680,3580,3720,3770,3840,4370,4430,4480,4590,4680,4610,4850,4910,4870,5040,5090,5240,5310,5370,5440,5550,5610,5670,5730,5800,5860,5910],
                    [2580,2630,2680,2750,2810,2870,2930,3050,2990,3140,3200,3340,3270,3480,3300,3520,3640,3600,3790,3710,3920,3800,3980,4570,4630,4710,4780,4840,5020,5000,5240,5320,5280,5370,5510,5530,5600,5740,5850,5870,5930,6070,6140,6210,6280],
                    [2610,2670,2740,2800,2870,2930,3010,3140,3070,3240,3300,3440,3380,3580,3640,3610,3710,3950,3850,3780,4080,4010,4150,4700,4840,4900,5070,5230,5350,5430,5500,5680,5600,5730,5890,5820,5900,5970,6050,6170,6250,6320,6400,6460,6540],
                    [2650,2710,2780,2830,2900,3000,3070,3220,3140,3310,3380,3540,3470,3760,3880,3610,4080,3970,3900,3830,4230,4150,4290,5020,4950,5190,5260,5380,5440,5570,5680,5730,5820,5910,5990,6060,6160,6230,6320,6450,6530,6700,6780,6870,6950],
                    [2680,2700,2830,2910,2990,3090,3150,3300,3230,3410,3490,3650,3560,3690,3730,3880,4200,4120,4030,3900,4380,4310,4470,5230,5320,5410,5520,5680,5890,5960,6090,6000,6180,6270,6350,6440,6630,6770,6840,6960,7040,7030,7120,7220,7300],
                    [2710,2740,2840,2900,3020,3110,3220,3370,3290,3490,3560,3720,3630,3770,3990,4040,4380,4290,4210,4530,4530,4450,4610,5440,5504,5640,5720,5820,5920,6070,6180,6260,6350,6450,6550,6640,6740,6990,7070,6830,7270,7170,7470,7370,7560],
                    [2740,2800,2890,2960,3040,3130,3200,3440,3350,3500,3660,3760,3710,3880,4040,4100,4460,4430,4450,4610,4700,4620,4770,5620,5720,5820,6080,6130,6290,6360,6460,6560,6630,6790,6830,6900,7000,7100,7260,7380,7480,7580,7680,7780,7870],
                    [2770,2840,2900,3020,3110,3190,3300,3490,3410,3620,3700,3800,3790,3900,4140,4210,4510,4510,4590,4730,4890,4730,4930,5830,5940,6050,6200,6360,6530,6640,6750,6880,6970,7070,7130,7180,7290,7400,7510,7670,7780,7890,7820,7910,8010],
                    [2800,2890,2980,3070,3160,3220,3370,3540,3460,3660,3770,3880,3870,3950,4230,4300,4640,4570,4730,4890,4950,4850,4980,6040,6150,6270,6330,6500,6610,6780,6800,7010,7130,7240,7390,7470,7500,7700,7820,7860,7910,8010,8120,8220,8320],
                    [2830,2900,3020,3040,3130,3290,3440,3590,3520,3660,3830,3910,3950,4080,4290,4380,4700,4710,4800,4930,5060,5020,5140,6220,6340,6480,6580,6700,6820,7000,7120,7240,7350,7480,7600,7730,7850,7780,7890,8060,8100,8150,8260,8310,8410],
                    [2860,2960,3070,3110,3190,3350,3490,3630,3570,3700,3900,3990,4030,4240,4380,4510,4820,4830,4920,5050,5230,5170,5290,6420,6550,6680,6800,6930,7090,7250,7380,7500,7630,7750,7880,7830,7940,8060,8100,8340,8460,8570,8690,8800,8920],
                    [2900,3020,3110,3160,3200,3280,3530,3660,3700,3760,3830,4040,4120,4290,4430,4540,4890,4940,5000,5210,5330,5330,5400,6630,6770,6900,7030,7160,7300,7500,7630,7760,7890,7850,7970,8060,8210,8330,8450,8620,8560,8730,8940,9050,9150],
                    [2930,3070,3130,3190,3220,3300,3560,3700,3750,3800,3910,4080,4210,4380,4510,4640,4990,5000,5170,5320,5440,5590,5710,6810,6950,7100,7240,7370,7510,7720,7860,7820,7940,8060,8180,8320,8400,8570,8680,8690,8880,8830,8950,9070,9190],
                    [2960,3120,3160,3200,3260,3370,3610,3760,3820,3880,3950,4120,4290,4430,4610,4710,5050,5210,5320,5450,5560,5610,5880,7020,7170,7310,7460,7610,7760,7760,7910,8040,8160,8310,8440,8570,8700,8830,9050,9240,9360,9480,9610,9740,9860],
                    [2990,3140,3190,3220,3300,3470,3660,3800,3880,3990,4030,4170,4380,4510,4670,4830,5100,5320,5400,5570,5740,5740,5880,7230,7380,7530,7680,7840,7900,8010,8150,8250,8430,8560,8700,8930,9050,9170,9320,9520,9680,9780,9970,10100,10340],
                    [3020,3180,3200,3350,3440,3540,3700,3830,3910,4040,4120,4210,4430,4640,4710,4920,5180,5400,5600,5780,5810,5880,6190,7410,7580,7730,7880,7880,8000,8210,8350,8490,8630,8770,8920,9150,9290,9420,9550,9780,9900,10030,10220,10450,10580],
                    [3040,3190,3220,3370,3490,3640,3760,3880,3950,4100,4140,4240,4510,4730,4850,4990,5340,5570,5770,5810,6050,6000,6340,7620,7760,7920,7990,8140,8280,8440,8580,8730,8870,9100,9250,9460,9600,9740,9890,10060,10240,10380,10610,10820,10970],
                    [3070,3200,3300,3440,3540,3690,3800,3990,4030,4140,4230,4300,4530,4770,4990,5050,5520,5770,5810,6190,6200,6300,6510,7830,7970,8120,8260,8380,8560,8700,8840,9080,9220,9340,9490,9710,9880,10010,10220,10450,10610,10750,10980,11120,11270],
                    [3110,3220,3350,3490,3660,3770,3880,4030,4120,4240,4380,4510,4640,4850,5100,5240,5730,5910,6300,6350,6340,6440,6700,7980,8140,8270,8420,8540,8760,8910,9060,9250,9410,9560,9770,10000,10160,10390,10540,10700,10850,11000,11150,11380,11500],
                    [3130,3300,3440,3500,3660,3800,3910,4080,4210,4290,4430,4510,4670,4890,5120,5300,5770,6140,6330,6510,6500,6650,6910,8200,8350,8510,8650,8750,8920,9170,9320,9480,9640,9800,10020,10260,10600,10850,10810,10970,11130,11280,11450,11780,11920],
                    [3160,3370,3490,3610,3760,3830,3990,4140,4240,4330,4450,4640,4730,4930,5200,5340,5840,6220,6410,6530,6700,6790,7030,8360,8520,8700,8880,8970,9220,9380,9600,9770,9930,10080,10280,10660,10780,10920,11090,11250,11410,11650,11820,12070,12200],
                    [3190,3470,3540,3660,3800,3910,4030,4230,4290,4430,4540,4770,4890,5020,5220,5420,6090,6230,6450,6700,6820,7000,7220,8450,8630,8810,8950,9230,9410,9570,9800,10050,10220,10470,10730,10900,11060,11200,11400,11600,11880,12070,12240,12460,12580],
                    [3220,3500,3690,3770,3880,3990,4120,4300,4380,4530,4610,4800,4980,5130,5240,5450,6270,6340,6700,6820,7000,7150,7370,8640,8820,9000,9270,9440,9680,9850,10000,10260,10540,10710,10980,11150,11300,11560,11750,11920,12190,12350,12540,12710,12880],
                    [3250,3540,3700,3880,3950,4120,4240,4380,4510,4540,4770,4890,5000,5140,5300,5500,6340,6580,6850,7000,7310,7300,7530,8830,9010,9290,9460,9650,9890,10070,10250,10500,10780,10950,11230,11400,11690,12020,11850,12210,12470,12650,12830,13090,13280],
                    [3290,3580,3760,3910,4030,4210,4310,4430,4640,4730,4920,5050,5240,5280,5320,5600,6440,6710,6940,7110,7200,7490,7670,9000,9330,9470,9700,9850,10040,10310,10570,10750,10930,11190,11380,11640,11830,12010,12190,12460,12630,12820,13000,13180,13360],
                    [3320,3610,3800,3950,4140,4290,4430,4510,4770,4930,5050,5100,5300,5430,5620,5650,6500,6790,7120,7220,7440,7680,7880,9280,9630,9710,9910,10080,10300,10560,10750,11030,11220,11410,11680,11970,12350,12350,12540,12730,13000,13280,13470,13860,14050],
                    [3350,3660,3830,3990,4230,4380,4510,4640,4850,4990,5100,5320,5440,5570,5770,5910,6580,6880,7240,7260,7540,7880,8060,9520,9710,9910,10100,10300,10500,10780,10980,11200,11400,11740,12000,12220,12420,12610,12810,13090,13370,13570,13960,14100,14380],
                    [3380,3710,3880,4040,4300,4510,4640,4730,4930,5100,5300,5400,5600,5770,5910,6090,6790,7140,7430,7520,7670,8060,8430,9680,9880,10060,10200,10500,10770,10970,11170,11470,11750,11950,12240,12450,12640,12840,13130,13330,13630,13820,14220,14610,14700],
                    [3440,3770,3910,4120,4380,4640,4850,4990,5180,5240,5440,5620,5710,5910,6100,6270,6820,7190,7500,7750,7880,8250,8540,9880,10070,10380,10580,10770,10980,11108,11300,11770,11980,12190,12490,12700,12910,13200,13500,13810,14100,14310,14610,14810,15020],
                    [3470,3820,3950,4140,4510,4770,4930,5120,5290,5410,5550,5770,5840,6020,6200,6330,7000,7250,7630,7900,8070,8430,8650,9830,10040,10330,10540,10750,10950,11170,11407,11700,11970,12180,12408,12600,12900,13100,13310,13620,13820,14030,14340,14540,14850],
                    [3490,3880,3990,4210,4640,4890,5010,5180,5320,5450,5620,5800,5980,6090,6300,6440,7130,7300,7760,8000,8200,8510,8790,10000,10210,10510,10730,10930,11150,11370,11600,11970,12190,12390,12700,12920,13120,13340,13560,13770,14070,14290,14510,14720,14930]
                ]
            },
            // --- HANSEN SCREEN ---
            "RS Classic 75": {
                w: [100,110,120,130,140,150,160,170,180,190,200,210,220,230],
                h: [100,110,120,130,140,150,160,170],
                prices: [
                    [2154,2286,2360,2493,2567,2670,2758,2876,3009,3083,3186,3289,3407,3466],
                    [2286,2390,2493,2581,2685,2773,2921,3024,3112,3245,3348,3452,3570,3658],
                    [2360,2493,2581,2699,2803,2935,3053,3127,3260,3393,3466,3614,3732,3820],
                    [2493,2581,2699,2803,2935,3053,3157,3275,3422,3511,3643,3761,3897,3997],
                    [2567,2685,2803,2935,3068,3186,3289,3437,3570,3658,3791,3938,4027,4160],
                    [2670,2773,2935,3053,3186,3289,3437,3584,3688,3776,3806,4071,4233,4322],
                    [2758,2921,3053,3157,3289,3437,3584,3702,3820,3968,4101,4248,4351,4484],
                    [2876,3024,3127,3275,3437,3584,3702,3820,3983,4115,4278,4366,4499,4661]
                ]
            },
            "RS Classic 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320],
                prices: [
                    [2213,2331,2404,2537,2640,2729,2847,2950,3068,3157,3260,3393,3466,3599,3702,3806,3938,4027,4145,4292,4381],
                    [2331,2434,2537,2655,2744,2876,3009,3083,3216,3304,3422,3570,3643,3761,3879,3983,4101,4233,4337,4455,4573],
                    [2404,2537,2655,2758,2891,3024,3112,3230,3348,3466,3599,3702,3806,3953,4027,4145,4307,4425,4573,4705,4853],
                    [2537,2655,2758,2891,3024,3112,3245,3378,3481,3629,3747,3835,3983,4101,4233,4337,4469,4617,4735,4897,5030],
                    [2640,2744,2891,3024,3127,3260,3393,3511,3643,3761,3909,4012,4130,4292,4381,4499,4661,4779,4941,5059,5207],
                    [2729,2876,3024,3112,3260,3393,3511,3658,3776,3938,4027,4160,4322,4425,4573,4691,4823,4971,5089,5251,5384],
                    [2847,3009,3112,3245,3393,3511,3658,3806,3953,4056,4174,4337,4469,4617,4735,4897,5045,5207,5369,5517,5679],
                    [2950,3083,3230,3378,3511,3658,3806,3953,4071,4233,4351,4484,3171,4750,4912,5059,5236,5384,5546,5694,5856],
                    [3068,3186,3304,3466,3658,3806,3953,4071,4233,4296,4499,4661,4779,4941,5059,5251,5399,5576,5723,5871,6033],
                    [3157,3275,3422,3614,3806,3953,4071,4233,4351,4514,4676,4794,4956,5074,5236,5413,5590,5753,5915,6048,6210],
                    [3260,3393,3511,3732,3953,4071,4233,4351,4484,4691,4823,4971,5089,5251,5384,5605,5767,5930,6062,6239,6402],
                    [3393,3481,3629,3747,3938,4111,4268,4426,4568,4772,4898,5072,5213,5387,5828,5605,5767,5930,6062,6239,6402], // Using H200 row for >H210 approximation based on pattern if needed, but data stops at 210 in manual entry. Using approximation for last rows
                    [3466,3614,3732,3875,4079,4205,4379,4536,4709,4867,5040,5198,5371,5544,6001,6001,6127,6300,6442,6615,6788],
                    [3599,3747,3906,4095,4268,4442,4599,4804,4946,5135,5324,5481,5654,5828,6300,6300,6442,6615,6788,6946,7119],
                    [3702,3879,4027,4205,4381,4520,4709,4912,5045,5251,5428,5635,5826,6003,6694,6694,6844,7021,7198,7360,7567],
                    [3806,3983,4145,4337,4499,4691,4853,5015,5207,5384,5576,5753,6003,6166,6520,6667,6815,6977,7124,7287,7390],
                    [3938,4101,4307,4469,4676,4823,5000,5118,5399,5546,5812,5959,6092,6313,6608,6815,6993,7139,7301,7419,7655],
                    [4027,4233,4425,4617,4779,4971,5045,5266,5399,5679,5974,6033,6298,6475,6874,6993,7154,7316,7478,7655,7938],
                    [4145,4337,4573,4735,4941,5089,5207,5399,5576,5915,6136,6195,6451,6608,7036,7124,7301,7478,7670,7985,8064],
                    [4292,4455,4705,4897,5059,5251,5369,5546,5723,6048,6284,6387,6593,6874,7154,7287,7419,7655,7985,8237,8316],
                    [4381,4573,4853,5030,5207,5384,5679,5694,5871,6210,6402,6505,6711,7036,7375,7390,7655,7938,8064,8316,8600],
                    [4489,4694,4946,5182,5481,5639,5959,6003,6210,6347,6631,6757,6829,7119,7419,7513,7781,8001,8363,8489,8710],
                    [4573,4804,5087,5245,5544,5767,6092,6151,6298,6473,6788,6851,7006,7261,7596,7655,7922,8143,8363,8610,8820]
                ]
            },
            // RS Classic 95 - Redan inlagd
            "RS Classic 95": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2301,2375,2478,2581,2685,2773,2921,3024,3098,3230,3304,3437,3570,3643,3820,4056,4307,4484,4705,5045,5384,5679,5826,6151,6313,6667],
                    [2375,2493,2581,2699,2832,2935,3053,3127,3260,3393,3481,3629,3747,3835,3983,4278,4425,4617,4779,5118,5460,5753,5915,6239,6402,6757],
                    [2493,2581,2699,2832,2950,3068,3186,3289,3407,3511,3629,3747,3820,3997,4145,4425,4573,4705,4853,5207,5546,5856,6003,6357,6520,6870],
                    [2581,2699,2832,2950,3068,3216,3304,3437,3584,3688,3791,3938,4027,282,4337,4573,4853,5118,5399,5428,5694,5989,6151,6505,6682,7040],
                    [2699,2832,3068,3216,3304,3452,3452,3599,3702,3820,3968,4248,4366,4469,4705,4853,5015,5163,5605,5590,5856,6151,6298,6647,6829,7198],
                    [2803,2950,3186,3304,3452,3614,3614,3732,3835,3983,4115,4381,4233,4705,4897,5015,5207,5310,5753,5694,6003,6298,6451,6804,7006,7305],
                    [2935,3053,2950,3083,3216,3304,3747,3879,3997,4130,4278,4101,4499,4469,5059,5207,5399,5428,5974,5826,6166,6451,6593,6962,7139,7513],
                    [3039,3157,3289,3437,3599,3747,3879,4012,4145,4307,4425,4573,4705,4337,5251,5384,5576,5590,6195,6092,6387,6593,6711,7135,7301,7733],
                    [3127,3275,3422,3599,3732,3835,4012,4145,4307,4405,4602,4735,4897,4897,5399,5576,5767,5753,6048,6387,6475,6711,6859,7308,7419,7922],
                    [3452,3407,3776,3953,4101,3997,4145,4602,4455,4912,4912,5207,5384,5045,5576,5871,5915,5871,6387,6239,6313,6859,7021,7466,7655,7812],
                    [3378,3481,3658,3806,3983,4130,4307,4425,4602,4602,4735,4897,5236,5576,5694,5753,6033,6003,6579,6298,6608,7021,7139,7639,7985,8159],
                    [3245,3629,3570,3702,3820,4307,4425,4307,4735,4735,5059,5059,5045,5384,5856,6003,6195,6151,6844,6579,8068,7360,7360,7812,8237,8363],
                    [3688,3835,4012,4174,4351,4381,4573,4868,4897,5207,5369,5517,5679,5236,6003,6357,6387,6298,6863,5826,6874,7139,7567,8363,8489,8726],
                    [3599,3747,3909,4071,4248,4514,4705,4720,5045,5059,5207,5369,5546,5826,6166,6166,6534,6431,7006,6092,7036,7567,6151,8505,8710,8930],
                    [3791,3983,4130,4322,4484,4676,4853,5015,5192,5369,5517,5664,5826,5679,6475,6520,6682,6579,7154,6387,7154,6298,6451,8867,9104],
                    [3909,4174,4366,4573,4735,4794,5000,5310,5340,5664,5812,5974,5989,5989,6313,6815,6829,6844,7316,6298,7375,6451,6593,8710,8946],
                    [4012,4071,4278,4425,4617,4941,5118,5163,5458,5517,5664,5812,6151,6298,6608,6667,7006,6863,7478,6579,7596,6593,6711,8993,9119],
                    [4115,4322,4484,4691,4868,5059,5266,5428,5635,5812,5974,6136,6298,6151,8068,6977,7139,7006,7139,6697,6874,6711,6859,8363,9308],
                    [4248,4425,4617,4794,5015,5207,5399,5590,5782,5974,6136,6284,6451,6451,6874,7124,7301,7154,7493,7006,7036,6859,7021,8584,9513],
                    [4337,4514,4720,4941,5118,5325,5546,5753,5944,6136,6284,6431,6593,6593,7036,7287,7419,7316,7670,7124,7154,7021,7139,8789,9702],
                    [4455,4661,4853,5059,5266,5443,5679,5871,6062,6284,6431,6579,6711,6711,7154,7390,7655,7478,7139,7331,7375,7360,7360,8993,9891],
                    [4573,4750,4971,5192,5384,5590,5812,6003,6210,6431,6579,6697,6859,6859,7375,6667,6883,7478,7493,6844,7596,7567,7567,9167,9860],
                    [4676,4897,5074,5325,5517,5723,5959,6151,6357,6579,6697,6844,7021,7021,7596,6977,6993,7478,7670,7124,6874,7139,7139,9450,10112],
                    [4897,5118,5207,5428,5635,5974,6239,6431,6490,6844,7006,7006,7360,7360,7596,7124,7308,7478,7670,7331,7596,7567,7567,9214,10395],
                    [4779,5015,5325,5590,5782,5826,6092,6298,6638,6697,6844,7124,7139,7139,7596,7287,7560,7478,7670,7331,7596,7567,7567,9450,10663],
                    [5015,5251,5428,5694,5915,6092,6387,6579,6756,7006,7124,7331,7567,7360,7596,7390,7844,7478,7670,7331,7596,7567,7567,9450,10663]
                ]
            },
            "RS Classic 105": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                prices: [
                    [2550, 2685, 2775, 2880, 3000, 3105, 3180, 3315, 3435, 3510, 3660, 3750, 3855, 3975, 4065, 4245, 4395, 4500, 4635, 4755, 4860, 4995, 5115, 5235, 5355, 5475, 5700, 5790, 5895, 6030, 6105],
                    [2685, 2790, 2895, 3030, 3135, 3240, 3345, 3465, 3570, 3705, 3825, 3945, 4050, 4140, 4245, 4440, 4545, 4650, 4755, 4830, 4950, 5055, 5145, 5250, 5355, 5460, 5955, 6060, 6165, 6300, 6405],
                    [2805, 2925, 3060, 3150, 3285, 3408, 3510, 3660, 3750, 3855, 3975, 4080, 4200, 4365, 4455, 4680, 4770, 4860, 4980, 5085, 5160, 5280, 5370, 5475, 5550, 5685, 6240, 6375, 6495, 6585, 6705],
                    [2925, 3060, 3150, 3300, 3435, 3525, 3675, 3795, 3885, 4035, 4140, 4245, 4395, 4530, 4650, 4860, 4995, 5115, 5235, 5355, 5475, 5595, 5715, 5850, 5855, 6075, 6510, 6615, 6750, 6855, 6975],
                    [3075, 3165, 3300, 3450, 3540, 3690, 3825, 3945, 4065, 4200, 4350, 4455, 4575, 4725, 4830, 5100, 5205, 5340, 5460, 5550, 5700, 5820, 5925, 6060, 6165, 6300, 6780, 6900, 7050, 7170, 7275],
                    [3165, 3300, 3450, 3540, 3705, 3840, 3975, 4095, 4215, 4380, 4500, 4635, 4770, 4875, 5040, 5295, 5430, 5550, 5715, 5865, 6015, 6135, 6270, 6420, 6525, 6705, 6690, 7050, 7335, 7440, 7560],
                    [3300, 3435, 3540, 3705, 3840, 4005, 4125, 4245, 4395, 4530, 4680, 4800, 4935, 5100, 5205, 5475, 5610, 5760, 5895, 6045, 6165, 6315, 6465, 6600, 6780, 6870, 7245, 7485, 7200, 7740, 7875],
                    [3435, 3540, 3705, 3840, 4005, 4125, 4245, 4425, 4560, 4725, 4830, 4995, 5130, 5280, 5415, 5700, 5850, 5970, 6105, 6255, 6405, 6540, 6690, 6810, 7035, 7125, 7500, 7200, 7050, 8010, 8160],
                    [3525, 3690, 3825, 4005, 4125, 4245, 4425, 4560, 4725, 4860, 5025, 5160, 5325, 5460, 5595, 5895, 6060, 6210, 6345, 6540, 6705, 6855, 7035, 7185, 7305, 7500, 7770, 6985, 6900, 8280, 8460],
                    [3675, 3825, 3975, 4125, 4245, 4425, 4575, 4740, 4875, 5040, 5175, 5340, 5490, 5670, 5790, 6105, 6270, 6435, 6600, 6765, 6960, 7095, 7245, 7410, 7560, 7740, 7980, 7050, 7485, 8595, 8745],
                    [3795, 3945, 4095, 4230, 4410, 4560, 4740, 4875, 5055, 5175, 5355, 5505, 5685, 5850, 6015, 6300, 6435, 6585, 6720, 6855, 7230, 7155, 7275, 7695, 7830, 8085, 8250, 7200, 7620, 8880, 9030],
                    [3885, 4065, 4215, 4395, 4545, 4740, 4875, 5055, 5205, 5370, 5520, 5700, 5865, 6030, 6165, 6510, 6645, 6810, 6975, 7155, 7455, 7455, 7620, 7920, 8085, 8340, 8505, 7515, 7785, 9165, 9300],
                    [4035, 4200, 4380, 4530, 4725, 4860, 5040, 5205, 5370, 5520, 5700, 5880, 6045, 6195, 6390, 6720, 6870, 7050, 7200, 7365, 7695, 7695, 7860, 8160, 8340, 8655, 8745, 7695, 7860, 9510, 9630],
                    [4140, 4350, 4485, 4680, 4815, 5025, 5175, 5355, 5520, 5700, 5880, 6045, 6210, 6405, 6570, 6930, 7125, 7275, 7455, 7635, 7950, 7995, 8175, 8460, 8610, 8925, 9000, 7365, 7980, 9720, 9900],
                    [4305, 4440, 4635, 4800, 4995, 5160, 5340, 5505, 5700, 5880, 6060, 6240, 6405, 6585, 6765, 7155, 7320, 7500, 7695, 7875, 8160, 8235, 8430, 8685, 8880, 9165, 9255, 7860, 8145, 9885, 10215],
                    [4395, 4560, 4755, 4935, 5130, 5325, 5490, 5685, 5865, 6045, 6210, 6435, 6585, 6765, 6945, 7320, 7500, 7695, 7875, 8055, 8445, 8475, 8595, 8970, 9150, 9360, 9510, 7995, 8325, 10020, 10500],
                    [4530, 4725, 4875, 5100, 5280, 5460, 5670, 5850, 6030, 6195, 6405, 6630, 6765, 6960, 7155, 7515, 7725, 7890, 8070, 8250, 8655, 8640, 8790, 9225, 9375, 9630, 9780, 7725, 9160, 9375, 10740],
                    [4650, 4815, 5040, 5205, 5430, 5595, 5790, 5970, 6165, 6390, 6570, 6810, 6990, 7155, 7320, 7770, 7950, 8100, 8280, 8475, 8895, 8895, 9030, 9510, 9645, 9855, 9990, 7545, 8370, 9570, 11070],
                    [4770, 4980, 5145, 5355, 5595, 5760, 5955, 6132, 6345, 6540, 6750, 6990, 7200, 7320, 7515, 7950, 8145, 8340, 8520, 8700, 9165, 9150, 9270, 9780, 9960, 10215, 10275, 7380, 8625, 9720, 11295],
                    [4875, 5100, 5295, 5490, 5730, 5895, 6090, 6300, 6510, 6705, 6900, 7200, 7380, 7515, 7740, 8160, 8370, 8565, 8775, 8970, 9435, 9375, 9555, 9990, 10350, 10455, 10515, 7920, 8340, 9885, 11565],
                    [5025, 5205, 5415, 5640, 5850, 6045, 6255, 6465, 6645, 6855, 7095, 7380, 7590, 7695, 7905, 8355, 8550, 8790, 9000, 9180, 9675, 9645, 9795, 10185, 10575, 10680, 10740, 7605, 8520, 10020, 11790]
                ]
            },
            "RS Classic 120": { // Same matrix as 125
                w: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                h: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4678,4772,4851,5072,5235,5324,5355,5475],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,4993,5119,5182,5370,5418,5355,5460],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5119,5166,5292,5371,5324,5610,5544,5550,5685],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5324,5418,5513,5607,5434,5865,5670,5855,6075],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5576,5670,5765,5891,5544,6135,5780,6165,6300],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5780,5906,6001,6127,5670,6390,5906,6570,6705],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4835,4961,5119,5245,5387,5528,5670,5780,6048,6158,6237,6379,5765,6615,6048,6750,6870],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,5024,5150,5324,5465,5576,5733,5875,6032,6284,6395,6536,6631,5906,6900,6158,6960,7125],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5198,5355,5497,5654,5780,5954,6080,6221,6410,6615,6773,6899,6032,7095,6284,7335,7500],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6804,6820,7025,7166,6158,7320,6410,7560,7770],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6615,7040,7261,7434,6237,7605,6536,7570,8085],
                    [4316,4489,4646,4820,4961,5135,5261,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7198,7245,7466,7655,6395,7860,6678,7950,8340],
                    [4473,4646,4820,4961,5135,5324,5418,5560,5765,5954,6111,6269,6426,6615,6757,6930,7103,7135,7434,7670,7938,6505,8130,6773,8160,8655],
                    [4631,4804,4961,5135,5324,5465,5560,5812,5985,6174,6300,6473,6647,6788,6962,7135,7308,7513,7623,7891,8174,6631,8370,6914,8505,8925],
                    [4788,4946,5119,5292,5465,5639,5717,6032,6158,6300,6505,6678,6820,6993,7166,7340,7513,7466,7970,8159,8442,6725,8610,7025,8730,9165],
                    [4914,5119,5261,5465,5639,5780,5875,6237,6347,6442,6694,6851,7040,7214,7387,7576,7749,7639,8127,8363,8694,6867,8820,7151,8985,9360],
                    [5072,5261,5418,5591,5780,5985,6032,6473,6552,6615,6867,7056,7245,7418,7592,7781,7954,7985,8363,8615,8930,6962,9090,7277,9195,9630],
                    [5213,5418,5560,5765,5985,6080,6190,6678,6773,6851,7088,7261,7434,7607,7796,7985,8159,8143,8552,8789,9214,7119,9300,7403,9435,9855],
                    [5371,5528,5717,5891,6111,6206,6347,6883,7088,7103,7261,7466,7623,7812,7970,8190,8379,8285,8726,8993,9419,7198,9615,7481,9675,10215],
                    [5670,5749,5875,6095,6347,6395,6552,7119,7324,7340,7434,7718,7954,8143,8280,8521,8804,8442,8930,9245,9734,7340,9840,7639,9990,10455],
                    [5513,5891,6001,6284,6615,6631,6757,7340,7607,7592,7655,7922,8143,8332,8505,8775,9090,8694,9119,9465,9938,7434,10065,7749,10260,10680],
                    [6032,6158,6237,6568,6867,6977,7056,7718,7938,7985,8143,8316,8489,8640,8867,9090,9345,8930,9371,9671,10206,7592,10365,7922,10500,11025],
                    [6190,6300,6379,6741,7088,7245,7214,7907,8111,8237,8363,8584,8852,9056,9277,9540,9840,9151,9655,9860,10395,7655,10545,7985,10830,11145],
                    [6345,6473,6615,6962,7277,7481,7544,8190,8348,8474,8615,8867,9135,9345,9576,9828,10155,9293,9891,10238,10631,7985,11070,8411,11265,11730],
                    [6505,6678,6788,7135,7403,7639,7749,8316,8489,8647,8789,9041,9324,9513,9749,10112,10379,9560,10017,10537,10899,8111,11295,8474,11520,11970],
                    [6694,6883,7040,7308,7481,7749,7985,8537,8773,8978,9167,9371,9623,9907,10206,10505,10789,9828,10206,10868,11135,8363,11610,8647,11745,12330]
                ]
            },
            "RS Classic 125": { // Same matrix as 120
                 w: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                h: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4678,4772,4851,5072,5235,5324,5355,5475],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,4993,5119,5182,5370,5418,5355,5460],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5119,5166,5292,5371,5324,5610,5544,5550,5685],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5324,5418,5513,5607,5434,5865,5670,5855,6075],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5576,5670,5765,5891,5544,6135,5780,6165,6300],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5780,5906,6001,6127,5670,6390,5906,6570,6705],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4835,4961,5119,5245,5387,5528,5670,5780,6048,6158,6237,6379,5765,6615,6048,6750,6870],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,5024,5150,5324,5465,5576,5733,5875,6032,6284,6395,6536,6631,5906,6900,6158,6960,7125],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5198,5355,5497,5654,5780,5954,6080,6221,6410,6615,6773,6899,6032,7095,6284,7335,7500],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6804,6820,7025,7166,6158,7320,6410,7560,7770],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6615,7040,7261,7434,6237,7605,6536,7570,8085],
                    [4316,4489,4646,4820,4961,5135,5261,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7198,7245,7466,7655,6395,7860,6678,7950,8340],
                    [4473,4646,4820,4961,5135,5324,5418,5560,5765,5954,6111,6269,6426,6615,6757,6930,7103,7135,7434,7670,7938,6505,8130,6773,8160,8655],
                    [4631,4804,4961,5135,5324,5465,5560,5812,5985,6174,6300,6473,6647,6788,6962,7135,7308,7513,7623,7891,8174,6631,8370,6914,8505,8925],
                    [4788,4946,5119,5292,5465,5639,5717,6032,6158,6300,6505,6678,6820,6993,7166,7340,7513,7466,7970,8159,8442,6725,8610,7025,8730,9165],
                    [4914,5119,5261,5465,5639,5780,5875,6237,6347,6442,6694,6851,7040,7214,7387,7576,7749,7639,8127,8363,8694,6867,8820,7151,8985,9360],
                    [5072,5261,5418,5591,5780,5985,6032,6473,6552,6615,6867,7056,7245,7418,7592,7781,7954,7985,8363,8615,8930,6962,9090,7277,9195,9630],
                    [5213,5418,5560,5765,5985,6080,6190,6678,6773,6851,7088,7261,7434,7607,7796,7985,8159,8143,8552,8789,9214,7119,9300,7403,9435,9855],
                    [5371,5528,5717,5891,6111,6206,6347,6883,7088,7103,7261,7466,7623,7812,7970,8190,8379,8285,8726,8993,9419,7198,9615,7481,9675,10215],
                    [5670,5749,5875,6095,6347,6395,6552,7119,7324,7340,7434,7718,7954,8143,8280,8521,8804,8442,8930,9245,9734,7340,9840,7639,9990,10455],
                    [5513,5891,6001,6284,6615,6631,6757,7340,7607,7592,7655,7922,8143,8332,8505,8775,9090,8694,9119,9465,9938,7434,10065,7749,10260,10680],
                    [6032,6158,6237,6568,6867,6977,7056,7718,7938,7985,8143,8316,8489,8640,8867,9090,9345,8930,9371,9671,10206,7592,10365,7922,10500,11025],
                    [6190,6300,6379,6741,7088,7245,7214,7907,8111,8237,8363,8584,8852,9056,9277,9540,9840,9151,9655,9860,10395,7655,10545,7985,10830,11145],
                    [6345,6473,6615,6962,7277,7481,7544,8190,8348,8474,8615,8867,9135,9345,9576,9828,10155,9293,9891,10238,10631,7985,11070,8411,11265,11730],
                    [6505,6678,6788,7135,7403,7639,7749,8316,8489,8647,8789,9041,9324,9513,9749,10112,10379,9560,10017,10537,10899,8111,11295,8474,11520,11970],
                    [6694,6883,7040,7308,7481,7749,7985,8537,8773,8978,9167,9371,9623,9907,10206,10505,10789,9828,10206,10868,11135,8363,11610,8647,11745,12330]
                ]
            },
            // RS Universal 85
            "RS Universal 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [2475, 2610, 2730, 2850, 2985, 3105, 3210, 3330, 3465, 3570, 3705],
                    [2610, 2730, 2880, 3000, 3120, 3240, 3360, 3495, 3645, 3750, 3870],
                    [2745, 2880, 3030, 3135, 3285, 3405, 3525, 3675, 3810, 3900, 4065],
                    [2895, 3030, 3150, 3300, 3435, 3540, 3705, 3825, 3975, 4095, 4230],
                    [3060, 3150, 3300, 3450, 3570, 3720, 3855, 4020, 4140, 4305, 4410],
                    [3150, 3300, 3465, 3630, 3750, 3870, 4035, 4170, 4320, 4440, 4575],
                    [3300, 3450, 3630, 3750, 3870, 4050, 4185, 4350, 4485, 4635, 4770],
                    [3450, 3570, 3750, 3885, 4050, 4200, 4365, 4500, 4650, 4800, 4950],
                    [3570, 3720, 3870, 4050, 4200, 4365, 4500, 4680, 4815, 4995, 5130],
                    [3705, 3855, 4035, 4185, 4365, 4500, 4680, 4815, 4995, 5145, 5325],
                    [3840, 4020, 4185, 4365, 4500, 4680, 4815, 5025, 5160, 5340, 5490]
                ]
            },
            // RS Universal 95
            "RS Universal 95": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2535,2655,2775,2895,3030,3135,3270,3360,3495,3645,3945,3855,4455,4320,4215,4560,4455,4575,4725,5025,4860,4995,5370,5490,5610,5730],
                    [2685,2805,2940,3075,3165,3300,3450,3540,3690,3810,3750,4065,4185,4095,4440,4365,4695,4800,4935,5250,4950,5055,5145,5250,5865,5970],
                    [2805,2970,3090,3210,3330,3480,3630,3720,3855,4455,4125,4230,4395,4500,4650,4980,4875,5040,5145,5490,5160,5280,5490,5730,6090,6210],
                    [2970,3105,3240,223,3495,3660,3765,3885,4050,4170,4320,4440,4560,4725,4830,4770,5115,5250,5370,5715,5475,5595,5820,5970,6345,6570],
                    [3105,3360,3360,3690,3675,3975,4095,4080,4200,4365,4680,4635,4980,4905,5055,5175,5340,5460,5820,5955,5700,5865,6060,6270,6600,6795],
                    [3240,3240,3510,3510,3825,3810,4440,4230,4395,4530,4485,4800,4770,5115,5250,5400,5520,5685,5595,6195,6015,6135,6255,6525,6825,7050],
                    [3360,3525,3690,3825,4455,4125,4590,4425,4560,4725,4860,5025,5145,5325,5460,5595,5760,8895,6045,6195,6705,6240,6420,6865,7095,7380],
                    [3510,3690,3825,4455,4125,4305,4245,4575,4755,4875,5055,5175,5355,5490,5670,5820,5970,6105,6255,6420,6165,6495,6615,7080,7320,7500],
                    [3675,3825,4455,4140,4305,4440,5115,4770,4860,5085,5235,5400,5535,5700,5865,6030,6165,6315,6495,6645,6405,6750,6900,7230,7365,7770],
                    [3810,3975,4125,4590,4440,4770,4950,4935,9057,5610,5790,5550,5730,6300,6255,6630,6795,6540,6930,6900,6930,6945,7095,7455,7605,8085],
                    [3945,4245,4305,4440,4770,4935,4770,5115,5280,5430,5595,5775,5925,6090,6465,6624,6390,6765,6705,7140,6990,7185,7320,7785,7920,8340],
                    [4080,4095,4425,4305,4590,4590,5280,5280,5460,5250,5415,5970,6105,8895,6060,6420,6600,6975,7155,7365,7305,7440,7605,7995,8160,8655],
                    [4215,4410,4575,4755,4935,5115,5430,5460,5610,6705,6900,6900,7125,7275,6855,6825,7875,8055,8475,7590,7515,7695,7860,8325,8505,8925],
                    [4935,4545,4740,4905,5100,5280,5610,5610,5790,6150,6720,6345,7275,6510,6645,7050,7440,7620,8010,7830,7830,7950,8130,8550,8730,9165],
                    [4380,4695,4860,5085,5250,5430,5775,5790,5970,6345,6150,6525,6525,6705,7725,7260,8070,7860,8250,8070,8055,8175,8370,8790,8985,9360],
                    [4500,4830,5040,5205,5400,5595,5925,5970,6150,6525,6345,6720,6705,6870,7485,7455,7035,8145,8070,8280,8235,8445,8610,9015,9195,9630],
                    [4650,4995,5160,5370,5535,5760,6105,6135,6315,5970,6525,7125,6900,7095,7275,7665,7230,8415,8355,8535,8445,8640,8820,9255,9435,9855],
                    [4785,5130,5340,5505,5715,5910,6270,6300,6510,6870,5790,6135,6315,7275,7095,7890,7635,8610,8550,8775,8745,8895,9090,9510,9675,10215],
                    [5085,5280,5475,5685,5880,6075,6435,6495,6690,7080,7095,7275,6525,7485,7890,8085,8280,8820,8805,9000,8970,9150,9300,9810,9990,10455],
                    [5205,5415,5640,5850,6045,6240,7140,6645,6855,7425,7260,7455,6705,7695,8085,8280,8505,9060,9030,9240,9195,9375,9615,10020,10260,10680],
                    [5355,5550,5775,5970,6810,6900,7275,7335,7560,7605,7440,7665,7125,7890,8265,8505,8700,9270,9255,9465,9435,9645,9840,10290,10500,11025],
                    [5490,5715,5910,6135,6645,7080,6945,7500,7770,7800,8175,7860,7875,8085,8475,8085,8940,9540,9510,9705,9675,9885,10065,10575,10830,11145],
                    [5640,5865,6075,6300,6375,7230,6615,7695,7905,7965,7995,8055,7695,8265,8655,8280,9195,9735,9720,9930,9915,10155,10365,10725,10950,11505],
                    [5775,6015,6624,6435,6525,6405,6780,6810,8145,8145,7830,8235,7485,8475,8505,8505,9450,9960,9960,10185,10155,10350,10545,11055,11265,11730],
                    [5910,6135,6390,6600,6195,6570,7440,6990,7560,8010,7635,8430,8070,8655,8685,8775,9720,10350,10350,10395,10380,10590,10845,11280,11520,11970],
                    [6060,6300,6525,6765,6975,7230,7380,7170,7905,8370,8610,8820,7875,8445,8895,9165,9990,10395,10635,10635,10620,10875,11070,11550,11745,12330]
                ]
            },
            "RS Universal 105": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2715, 2820, 2970, 3090, 3180, 3315, 3450, 3540, 3690, 3810, 3900, 4050, 4170, 4305, 4410, 4530, 4650, 4770, 4875, 5025, 5130, 5250, 5370, 5490, 5610, 5730, 6174, 5906, 5765, 6946, 7056],
                    [2430, 3000, 3120, 3240, 3360, 3495, 3645, 3750, 3870, 4020, 4125, 4230, 4380, 4500, 4635, 4755, 4860, 5025, 5130, 5250, 5370, 5490, 5610, 5730, 5865, 5970, 6127, 6237, 6379, 6946, 7056],
                    [3030, 3300, 3285, 3405, 3525, 3675, 3810, 3900, 4065, 4185, 4350, 4440, 4575, 4725, 4815, 4980, 5100, 5235, 5355, 5490, 5610, 5730, 5865, 5970, 6090, 6210, 6741, 6568, 6442, 6284, 6174],
                    [3165, 3150, 3450, 3570, 3705, 3840, 4005, 4095, 4230, 4395, 4500, 4650, 4785, 4905, 5055, 5175, 5325, 5460, 5595, 5715, 5865, 6015, 6135, 6270, 6420, 6570, 6694, 6521, 6363, 8127, 7859],
                    [3315, 3465, 3630, 3750, 3870, 4020, 4140, 4305, 4425, 4560, 4725, 4830, 4995, 5130, 5280, 5400, 5520, 5685, 5820, 5955, 6100, 6240, 6390, 6525, 6645, 6795, 7308, 7166, 7025, 6883, 6725],
                    [3465, 3645, 3765, 3885, 4050, 4185, 4350, 4455, 4590, 4770, 4905, 5055, 5175, 5340, 5475, 5610, 5760, 5895, 6060, 6195, 6345, 6495, 6615, 6865, 6900, 7050, 7718, 7844, 8017, 8174, 8332],
                    [3645, 3765, 3900, 4065, 4200, 4380, 4500, 4650, 4800, 4950, 5100, 5250, 5400, 5520, 5700, 5850, 5970, 6135, 6270, 6420, 6585, 6750, 6900, 7080, 7230, 7380, 7938, 6946, 8206, 8363, 8521],
                    [3765, 3900, 4080, 4215, 4395, 4530, 4695, 4815, 4995, 5130, 5295, 5430, 5595, 5760, 5895, 6060, 6195, 6375, 6510, 6645, 6795, 6945, 7095, 7230, 7365, 7500, 7135, 8663, 8820, 9135, 7796],
                    [3900, 4080, 4215, 4395, 4545, 4725, 4830, 5025, 5160, 5340, 5490, 5640, 5775, 5955, 6105, 6255, 6420, 6585, 6750, 6900, 7050, 7185, 7320, 7455, 7605, 7770, 8962, 9119, 9371, 7340, 7670],
                    [4065, 4215, 4395, 4545, 4725, 4860, 5040, 5175, 5355, 5505, 5685, 5850, 6015, 6150, 6315, 6495, 6630, 6795, 6960, 7140, 7275, 7440, 7605, 7785, 7920, 8085, 8442, 8253, 8064, 7859, 7718],
                    [4215, 4395, 4545, 4725, 4875, 5055, 5205, 5370, 5520, 5715, 5880, 6045, 6195, 6390, 6540, 6705, 6855, 7035, 7200, 7365, 7515, 7695, 7860, 7995, 8160, 8340, 8694, 8489, 8285, 8096, 7938],
                    [4380, 4545, 4725, 4875, 5055, 5205, 5400, 5535, 5730, 5895, 6075, 6240, 6405, 6585, 6750, 6930, 7095, 7260, 7425, 7590, 7785, 7950, 8130, 8325, 8505, 8655, 8852, 8694, 8505, 8285, 8096],
                    [4530, 4695, 4860, 5055, 5205, 5400, 5550, 5730, 5910, 6090, 6255, 6435, 6615, 6780, 6960, 7140, 7305, 7485, 7620, 7830, 7995, 8175, 8370, 8550, 8730, 8925, 9104, 8930, 8710, 8505, 8285],
                    [4680, 4830, 5040, 5205, 5400, 5535, 5730, 5910, 6090, 6270, 6465, 6630, 6810, 6975, 7170, 7335, 7515, 7725, 7815, 8070, 8250, 8445, 8610, 8790, 8985, 9165, 9167, 9182, 9308, 9403, 9545],
                    [4815, 5025, 5175, 5370, 5535, 5730, 5910, 6090, 6270, 6465, 6645, 6825, 7035, 7200, 7380, 7560, 7770, 7920, 8145, 8280, 8475, 8640, 8820, 9015, 9195, 9360, 11910, 11088, 9450, 9576, 9671],
                    [4980, 5145, 5355, 5520, 5715, 5910, 6090, 6270, 6495, 6645, 6825, 7035, 7230, 7410, 7590, 7800, 7965, 8145, 8415, 8535, 8700, 8895, 9090, 9255, 9435, 9630, 8442, 8694, 8867, 9104, 9214],
                    [5115, 5325, 5505, 5700, 5895, 6075, 6270, 6465, 6645, 6825, 7050, 7230, 7425, 7605, 7815, 7995, 8175, 8415, 8520, 8775, 8970, 9150, 9300, 9510, 9675, 9855, 9420, 9655, 10001, 10348, 10064],
                    [5280, 5475, 5670, 5865, 6060, 6255, 6435, 6630, 6825, 7050, 7230, 7425, 7620, 7830, 8010, 8220, 8430, 8610, 8820, 9000, 9195, 9375, 9615, 9810, 9990, 10215, 8790, 9041, 10253, 10364, 10080],
                    [5415, 5610, 5820, 6030, 6210, 6420, 6615, 6810, 7035, 7230, 7425, 7620, 7830, 8010, 8235, 8445, 8625, 8820, 9030, 9240, 9435, 9645, 9840, 10020, 10260, 10455, 12931, 12663, 10505, 10600, 10364],
                    [5550, 5775, 5970, 6165, 6405, 6600, 6795, 6990, 7200, 7425, 7620, 7830, 8010, 8235, 8460, 8640, 8865, 9060, 9255, 9465, 9675, 9885, 10065, 10290, 10500, 10680, 11104, 11120, 10726, 10883, 10584],
                    [5715, 5925, 6135, 6375, 6570, 6765, 6975, 7185, 7410, 7605, 7815, 8010, 8235, 8460, 8640, 8880, 9090, 9270, 9510, 9705, 9915, 10155, 10365, 10575, 10830, 11025, 11250, 11325, 10915, 11120, 11261]
                ]
            },
            "RS Universal 120": { // Same matrix as 125
                 w: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                 h: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4678,4772,4851,5072,5235,5324,5355,5475],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,4993,5119,5182,5370,5418,5355,5460],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5119,5166,5292,5371,5324,5610,5544,5550,5685],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5324,5418,5513,5607,5434,5865,5670,5855,6075],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5576,5670,5765,5891,5544,6135,5780,6165,6300],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5780,5906,6001,6127,5670,6390,5906,6570,6705],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4835,4961,5119,5245,5387,5528,5670,5780,6048,6158,6237,6379,5765,6615,6048,6750,6870],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,5024,5150,5324,5465,5576,5733,5875,6032,6284,6395,6536,6631,5906,6900,6158,6960,7125],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5198,5355,5497,5654,5780,5954,6080,6221,6410,6615,6773,6899,6032,7095,6284,7335,7500],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6804,6820,7025,7166,6158,7320,6410,7560,7770],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6615,7040,7261,7434,6237,7605,6536,7570,8085],
                    [4316,4489,4646,4820,4961,5135,5261,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7198,7245,7466,7655,6395,7860,6678,7950,8340],
                    [4473,4646,4820,4961,5135,5324,5418,5560,5765,5954,6111,6269,6426,6615,6757,6930,7103,7135,7434,7670,7938,6505,8130,6773,8160,8655],
                    [4631,4804,4961,5135,5324,5465,5560,5812,5985,6174,6300,6473,6647,6788,6962,7135,7308,7513,7623,7891,8174,6631,8370,6914,8505,8925],
                    [4788,4946,5119,5292,5465,5639,5717,6032,6158,6300,6505,6678,6820,6993,7166,7340,7513,7466,7970,8159,8442,6725,8610,7025,8730,9165],
                    [4914,5119,5261,5465,5639,5780,5875,6237,6347,6442,6694,6851,7040,7214,7387,7576,7749,7639,8127,8363,8694,6867,8820,7151,8985,9360],
                    [5072,5261,5418,5591,5780,5985,6032,6473,6552,6615,6867,7056,7245,7418,7592,7781,7954,7985,8363,8615,8930,6962,9090,7277,9195,9630],
                    [5213,5418,5560,5765,5985,6080,6190,6678,6773,6851,7088,7261,7434,7607,7796,7985,8159,8143,8552,8789,9214,7119,9300,7403,9435,9855],
                    [5371,5528,5717,5891,6111,6206,6347,6883,7088,7103,7261,7466,7623,7812,7970,8190,8379,8285,8726,8993,9419,7198,9615,7481,9675,10215],
                    [5670,5749,5875,6095,6347,6395,6552,7119,7324,7340,7434,7718,7954,8143,8280,8521,8804,8442,8930,9245,9734,7340,9840,7639,9990,10455],
                    [5513,5891,6001,6284,6615,6631,6757,7340,7607,7592,7655,7922,8143,8332,8505,8775,9090,8694,9119,9465,9938,7434,10065,7749,10260,10680],
                    [6032,6158,6237,6568,6867,6977,7056,7718,7938,7985,8143,8316,8489,8640,8867,9090,9345,8930,9371,9671,10206,7592,10365,7922,10500,11025],
                    [6190,6300,6379,6741,7088,7245,7214,7907,8111,8237,8363,8584,8852,9056,9277,9540,9840,9151,9655,9860,10395,7655,10545,7985,10830,11145],
                    [6345,6473,6615,6962,7277,7481,7544,8190,8348,8474,8615,8867,9135,9345,9576,9828,10155,9293,9891,10238,10631,7985,11070,8411,11265,11730],
                    [6505,6678,6788,7135,7403,7639,7749,8316,8489,8647,8789,9041,9324,9513,9749,10112,10379,9560,10017,10537,10899,8111,11295,8474,11520,11970],
                    [6694,6883,7040,7308,7481,7749,7985,8537,8773,8978,9167,9371,9623,9907,10206,10505,10789,9828,10206,10868,11135,8363,11610,8647,11745,12330]
                ]
            },
            "RS Universal 125": { // Same matrix as 120
                 w: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                h: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4678,4772,4851,5072,5235,5324,5355,5475],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,4993,5119,5182,5370,5418,5355,5460],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5119,5166,5292,5371,5324,5610,5544,5550,5685],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5324,5418,5513,5607,5434,5865,5670,5855,6075],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5576,5670,5765,5891,5544,6135,5780,6165,6300],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5780,5906,6001,6127,5670,6390,5906,6570,6705],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4835,4961,5119,5245,5387,5528,5670,5780,6048,6158,6237,6379,5765,6615,6048,6750,6870],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,5024,5150,5324,5465,5576,5733,5875,6032,6284,6395,6536,6631,5906,6900,6158,6960,7125],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5198,5355,5497,5654,5780,5954,6080,6221,6410,6615,6773,6899,6032,7095,6284,7335,7500],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6804,6820,7025,7166,6158,7320,6410,7560,7770],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6615,7040,7261,7434,6237,7605,6536,7570,8085],
                    [4316,4489,4646,4820,4961,5135,5261,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7198,7245,7466,7655,6395,7860,6678,7950,8340],
                    [4473,4646,4820,4961,5135,5324,5418,5560,5765,5954,6111,6269,6426,6615,6757,6930,7103,7135,7434,7670,7938,6505,8130,6773,8160,8655],
                    [4631,4804,4961,5135,5324,5465,5560,5812,5985,6174,6300,6473,6647,6788,6962,7135,7308,7513,7623,7891,8174,6631,8370,6914,8505,8925],
                    [4788,4946,5119,5292,5465,5639,5717,6032,6158,6300,6505,6678,6820,6993,7166,7340,7513,7466,7970,8159,8442,6725,8610,7025,8730,9165],
                    [4914,5119,5261,5465,5639,5780,5875,6237,6347,6442,6694,6851,7040,7214,7387,7576,7749,7639,8127,8363,8694,6867,8820,7151,8985,9360],
                    [5072,5261,5418,5591,5780,5985,6032,6473,6552,6615,6867,7056,7245,7418,7592,7781,7954,7985,8363,8615,8930,6962,9090,7277,9195,9630],
                    [5213,5418,5560,5765,5985,6080,6190,6678,6773,6851,7088,7261,7434,7607,7796,7985,8159,8143,8552,8789,9214,7119,9300,7403,9435,9855],
                    [5371,5528,5717,5891,6111,6206,6347,6883,7088,7103,7261,7466,7623,7812,7970,8190,8379,8285,8726,8993,9419,7198,9615,7481,9675,10215],
                    [5670,5749,5875,6095,6347,6395,6552,7119,7324,7340,7434,7718,7954,8143,8280,8521,8804,8442,8930,9245,9734,7340,9840,7639,9990,10455],
                    [5513,5891,6001,6284,6615,6631,6757,7340,7607,7592,7655,7922,8143,8332,8505,8775,9090,8694,9119,9465,9938,7434,10065,7749,10260,10680],
                    [6032,6158,6237,6568,6867,6977,7056,7718,7938,7985,8143,8316,8489,8640,8867,9090,9345,8930,9371,9671,10206,7592,10365,7922,10500,11025],
                    [6190,6300,6379,6741,7088,7245,7214,7907,8111,8237,8363,8584,8852,9056,9277,9540,9840,9151,9655,9860,10395,7655,10545,7985,10830,11145],
                    [6345,6473,6615,6962,7277,7481,7544,8190,8348,8474,8615,8867,9135,9345,9576,9828,10155,9293,9891,10238,10631,7985,11070,8411,11265,11730],
                    [6505,6678,6788,7135,7403,7639,7749,8316,8489,8647,8789,9041,9324,9513,9749,10112,10379,9560,10017,10537,10899,8111,11295,8474,11520,11970],
                    [6694,6883,7040,7308,7481,7749,7985,8537,8773,8978,9167,9371,9623,9907,10206,10505,10789,9828,10206,10868,11135,8363,11610,8647,11745,12330]
                ]
            },
            "RS Smart 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [2715, 2820, 2985, 3090, 3180, 3330, 3465, 3570, 3705, 3825, 3945, 4080, 4185, 4320, 4440, 4575, 4695, 4815, 4950, 5055, 5175],
                    [2850, 3000, 3090, 3240, 3345, 3495, 3570, 3645, 3870, 4020, 4125, 4245, 4380, 4500, 4635, 4770, 4860, 4995, 5130, 5280, 5430],
                    [3000, 3150, 3120, 3285, 3525, 3675, 3645, 3750, 4065, 4185, 4320, 4320, 4545, 4695, 4635, 4950, 5055, 5145, 5325, 5460, 5610],
                    [3150, 3300, 3240, 3405, 3705, 3825, 3750, 3810, 4230, 4380, 4500, 4440, 4740, 4860, 4800, 5130, 5250, 5325, 5475, 5640, 5790],
                    [3300, 3450, 3285, 3435, 3855, 4020, 3810, 3900, 4425, 4545, 4695, 4455, 4905, 5055, 4800, 5325, 5430, 5475, 5670, 5820, 6015],
                    [3450, 3570, 3405, 3540, 4035, 4170, 3900, 3975, 4575, 4740, 4860, 4635, 5100, 5250, 4995, 5475, 5610, 5640, 5850, 6015, 6165],
                    [3630, 3750, 3435, 3570, 4185, 4350, 3975, 4080, 4770, 4905, 5055, 4635, 5280, 5430, 5145, 5670, 5790, 5820, 6030, 6195, 6375],
                    [3750, 3885, 3540, 3720, 4365, 4485, 4080, 4125, 4950, 5100, 5250, 4800, 5460, 5610, 5325, 5850, 6015, 6015, 6195, 6390, 6540],
                    [3885, 4050, 3570, 3720, 4500, 4650, 4125, 4245, 5130, 5280, 5430, 4980, 5640, 5790, 5475, 6030, 6195, 6165, 6390, 6570, 6750],
                    [4050, 4185, 3720, 3870, 4580, 4800, 4245, 4320, 5325, 5460, 5610, 4995, 5820, 6015, 5640, 6195, 6390, 6375, 6540, 6750, 6930],
                    [4185, 4365, 3720, 3885, 4815, 4995, 4320, 4440, 5475, 5640, 5790, 5145, 6015, 6165, 5790, 6390, 6570, 6540, 6820, 6930, 7125]
                ]
            },
            "RS Smart 130 XL": {
                w: [610, 620, 630, 640, 650, 660, 670, 680, 690, 700],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                prices: [
                    [14448, 14592, 14768, 14912, 15040, 15200, 15344, 15520, 15632, 15792],
                    [14768, 14928, 15104, 15256, 15424, 15600, 15776, 15952, 16128, 16304],
                    [15744, 15936, 16128, 16320, 16512, 16704, 16896, 17088, 17280, 17488],
                    [16016, 16272, 16480, 16688, 16896, 17104, 17312, 17536, 17744, 17952],
                    [16288, 16480, 16672, 16864, 17040, 17248, 17456, 17648, 17792, 17984],
                    [16544, 16752, 16944, 17136, 17312, 17520, 17712, 17904, 18096, 18288],
                    [16784, 16960, 17136, 17296, 17488, 17664, 17792, 17968, 18160, 18320],
                    [17088, 17280, 17488, 17680, 17872, 18064, 18256, 18448, 18640, 18832],
                    [18080, 18288, 18496, 18720, 18928, 19120, 19360, 19552, 19808, 20032],
                    [19352, 18400, 18768, 18992, 19216, 19440, 19648, 19856, 20080, 20272],
                    [19328, 19552, 19824, 20064, 20272, 20512, 20768, 20992, 21232, 21472],
                    [19648, 19888, 20160, 20416, 20688, 20912, 21184, 21456, 21680, 21984],
                    [20032, 20256, 20512, 20800, 21024, 21280, 21552, 21632, 22080, 22160],
                    [20160, 20400, 20640, 20864, 21088, 21360, 21584, 21792, 22064, 22320],
                    [20432, 20688, 20896, 21136, 21408, 21616, 21680, 22112, 22320, 22528],
                    [20688, 20880, 21088, 21344, 21536, 21728, 21984, 22352, 22384, 22592],
                    [21680, 21984, 22224, 22448, 22768, 22992, 23216, 23520, 23760, 24000],
                    [21984, 22224, 22448, 22768, 22992, 23216, 23520, 23760, 24000, 24288],
                    [22384, 22640, 22928, 23168, 23472, 23712, 23968, 24256, 24480, 24752],
                    [22695, 23010, 23340, 23505, 23835, 24135, 24420, 24750, 25024, 25552],
                    [23152, 23472, 23808, 24144, 24480, 24816, 25152, 25488, 25824, 26160]
                ]
            }
        };

        // State
        let currentVendor = "screen_2025";
        let currentCalculation = null; // Sparar senaste uträkningen
        let quoteItems = [];
        
        // DOM Elements
        const el = {
            vendorRadios: document.querySelectorAll('input[name="vendor"]'),
            catSelect: document.getElementById('category'),
            prodSelect: document.getElementById('product'),
            wInput: document.getElementById('width'),
            hInput: document.getElementById('height'),
            calcBtn: document.getElementById('calculate-btn'),
            addPanel: document.getElementById('add-panel'),
            displayPrice: document.getElementById('display-price'),
            displayDims: document.getElementById('display-dims'),
            qtyInput: document.getElementById('quantity'),
            addToQuoteBtn: document.getElementById('add-to-quote-btn'),
            quoteContainer: document.getElementById('quote-items'),
            emptyState: document.getElementById('empty-state'),
            totalPrice: document.getElementById('total-price'),
            quoteCount: document.getElementById('quote-count'),
            errorMsg: document.getElementById('error-msg'),
            errorText: document.getElementById('error-text'),
            dimLimits: document.getElementById('dim-limits')
        };

        // --- SETUP ---
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('sv-SE');
        document.getElementById('ref-id').innerText = 'REF-' + Math.floor(1000 + Math.random() * 9000);
        updateCategories();

        // Event Listeners
        el.vendorRadios.forEach(r => r.addEventListener('change', (e) => {
            currentVendor = e.target.value;
            updateCategories();
            resetCalculation();
        }));

        el.catSelect.addEventListener('change', updateProducts);
        
        el.prodSelect.addEventListener('change', () => {
            updateDimLimits();
            resetCalculation();
        });

        el.calcBtn.addEventListener('click', calculatePrice);
        el.addToQuoteBtn.addEventListener('click', addItemToQuote);

        // --- LOGIC ---

        function updateCategories() {
            el.catSelect.innerHTML = '<option value="">-- Välj --</option>';
            el.prodSelect.innerHTML = '<option value="">-- Välj --</option>';
            el.prodSelect.disabled = true;
            el.dimLimits.classList.add('hidden');
            
            const cats = database[currentVendor].categories;
            for(const cat in cats) {
                const opt = document.createElement('option');
                opt.value = cat;
                opt.textContent = cat;
                el.catSelect.appendChild(opt);
            }
        }

        function updateProducts() {
            const cat = el.catSelect.value;
            el.prodSelect.innerHTML = '<option value="">-- Välj --</option>';
            el.dimLimits.classList.add('hidden');
            
            if(cat) {
                el.prodSelect.disabled = false;
                const products = database[currentVendor].categories[cat];
                for(const prod in products) {
                    const opt = document.createElement('option');
                    opt.value = prod;
                    opt.textContent = prod;
                    el.prodSelect.appendChild(opt);
                }
            } else {
                el.prodSelect.disabled = true;
            }
            resetCalculation();
        }

        function updateDimLimits() {
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;
            if(cat && prod) {
                const data = database[currentVendor].categories[cat][prod];
                el.dimLimits.innerText = `Bredd: ${data.range.minW}-${data.range.maxW} cm | Höjd: ${data.range.minH}-${data.range.maxH} cm`;
                el.dimLimits.classList.remove('hidden');
            }
        }

        function resetCalculation() {
            el.addPanel.classList.add('hidden', 'opacity-0', 'translate-y-4');
            el.addPanel.classList.remove('block', 'opacity-100', 'translate-y-0');
            currentCalculation = null;
            el.errorMsg.classList.add('hidden');
        }

        function calculatePrice() {
            resetCalculation();
            const w = parseFloat(el.wInput.value);
            const h = parseFloat(el.hInput.value);
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;

            // Validering
            if (!w || !h || !cat || !prod) {
                showError("Fyll i alla fält.");
                return;
            }

            // Hämta produktdata säkert
            const prodData = database[currentVendor]?.categories?.[cat]?.[prod];
            
            if (!prodData) {
                showError("Kunde inte hitta produktdata.");
                return;
            }

            // Kontrollera måttgränser
            if (w < prodData.range.minW || w > prodData.range.maxW) {
                showError(`Ogiltig bredd. Tillåtet: ${prodData.range.minW} - ${prodData.range.maxW} cm`);
                return;
            }
            if (h < prodData.range.minH || h > prodData.range.maxH) {
                showError(`Ogiltig höjd. Tillåtet: ${prodData.range.minH} - ${prodData.range.maxH} cm`);
                return;
            }

            // BERÄKNING
            let unitPrice = 0;
            let unit = database[currentVendor].unit; // "cm" eller "mm"
            let tableW, tableH;

            // Sjekk om vi har en faktisk matrise for dette produktet
            const matrix = priceMatrices[prod];

            if (matrix) {
                // --- MATRISEOPPSLAG (Alternativ A) ---
                
                // 1. Finn nærmeste bredde (oppover)
                // Matrisen bruker samma enhet som unit (cm/mm)
                let wIndex = -1;
                // Om enheten är mm men matrisen är i mm, måste vi matcha inmatat cm mot mm-matrisen
                // C80/F80: unit="mm", matrix="mm". Input w=100 (cm).
                // Om unit="mm", då w*10 för att matcha matrisen
                // Om unit="cm", då w för att matcha matrisen

                let searchW = (unit === "mm") ? w * 10 : w;
                let searchH = (unit === "mm") ? h * 10 : h;

                for (let i = 0; i < matrix.w.length; i++) {
                    if (matrix.w[i] >= searchW) {
                        wIndex = i;
                        tableW = matrix.w[i];
                        break;
                    }
                }

                // 2. Finn nærmeste høyde (oppover)
                let hIndex = -1;
                for (let i = 0; i < matrix.h.length; i++) {
                    if (matrix.h[i] >= searchH) {
                        hIndex = i;
                        tableH = matrix.h[i];
                        break;
                    }
                }

                if (wIndex === -1 || hIndex === -1) {
                    // Om vi är utanför tabellen men inom max-gränserna, använd sista raden/kolumnen (vanligt i prislistor "eller större")
                    // Men för säkerhets skull visar vi felmeddelande om exakt matchning saknas i logiken.
                    // Här tillåter vi sista steget om det är "nästa storlek upp".
                     if (searchW > matrix.w[matrix.w.length-1] || searchH > matrix.h[matrix.h.length-1]) {
                        showError("Dimensjonen er utenfor standardtabellen. Kontakt salg.");
                        return;
                     }
                }

                // 3. Hent pris
                // Sjekk at raden och kolonnen finnes
                if (matrix.prices[hIndex] && matrix.prices[hIndex][wIndex] !== undefined) {
                    unitPrice = matrix.prices[hIndex][wIndex];
                } else {
                    showError("Prisdata mangler for denne kombinasjonen.");
                    return;
                }

            } else {
                // --- FALLBACK FORMEL (Alternativ B) ---
                // Brukes for produkter vi inte har lagt inn matrise for enda
                
                let stepsW, stepsH;
                if (unit === "mm") {
                    const startW = (prod.includes("C80")) ? 1000 : 700;
                    const wMM = w * 10; 
                    const hMM = h * 10;

                    tableW = Math.max(startW, Math.ceil(wMM / 100) * 100);
                    tableH = Math.max(1000, Math.ceil(hMM / 100) * 100);
                    stepsW = (tableW - startW) / 100;
                    stepsH = (tableH - 1000) / 100;
                } else {
                    const isXL = prod.includes("XL");
                    const startW = isXL ? 610 : 100;
                    const startH = 100;
                    tableW = Math.max(startW, Math.ceil(w / 10) * 10);
                    tableH = Math.max(startH, Math.ceil(h / 10) * 10);
                    stepsW = (tableW - startW) / 10;
                    stepsH = (tableH - startH) / 10;
                }

                if (prod.includes("XL")) {
                     unitPrice = prodData.base + (stepsW * 150) + (stepsH * 100);
                } else {
                    const factor = prodData.factor - 1;
                    unitPrice = prodData.base * (1 + (stepsW * factor) + (stepsH * factor));
                }
            }
            
            unitPrice = Math.round(unitPrice);

            // Spara resultatet i minnet
            currentCalculation = {
                product: prod,
                category: cat,
                vendor: database[currentVendor].name,
                width: w,
                height: h,
                tableW: tableW,
                tableH: tableH,
                unit: unit,
                price: unitPrice
            };

            // Visa i UI
            el.displayPrice.innerText = unitPrice.toLocaleString('no-NO');
            el.displayDims.innerText = `${tableW} x ${tableH} ${unit}`;
            
            // Animera fram panelen
            el.addPanel.classList.remove('hidden');
            setTimeout(() => {
                el.addPanel.classList.remove('opacity-0', 'translate-y-4');
                el.addPanel.classList.add('opacity-100', 'translate-y-0');
            }, 10);
        }

        function addItemToQuote() {
            if (!currentCalculation) return;

            const qty = parseInt(el.qtyInput.value) || 1;
            const totalPrice = currentCalculation.price * qty;

            const item = {
                id: Date.now(), // Unikt ID
                ...currentCalculation,
                qty: qty,
                total: totalPrice
            };

            quoteItems.push(item);
            renderQuote();
            
            // Återställ för nästa inmatning
            resetCalculation();
            el.wInput.value = '';
            el.hInput.value = '';
            el.qtyInput.value = '1';
        }

        function renderQuote() {
            el.quoteContainer.innerHTML = '';
            let grandTotal = 0;

            if (quoteItems.length === 0) {
                el.emptyState.style.display = 'flex';
            } else {
                el.emptyState.style.display = 'none';
                
                quoteItems.forEach(item => {
                    grandTotal += item.total;
                    
                    const row = document.createElement('div');
                    row.className = "grid grid-cols-12 gap-2 px-6 py-3 border-b border-slate-100 items-center hover:bg-slate-50 transition text-sm fade-in";
                    row.innerHTML = `
                        <div class="col-span-5">
                            <p class="font-bold text-slate-800">${item.product}</p>
                            <p class="text-[10px] text-slate-500 uppercase tracking-wide">${item.vendor} • ${item.category}</p>
                        </div>
                        <div class="col-span-2 text-center font-mono text-slate-600">
                            ${item.width} x ${item.height}
                        </div>
                        <div class="col-span-2 text-center">
                            <span class="bg-slate-100 text-slate-700 px-2 py-0.5 rounded text-xs font-bold border border-slate-200">${item.qty}</span>
                        </div>
                        <div class="col-span-2 text-right font-bold text-slate-800">
                            ${item.total.toLocaleString('no-NO')}
                        </div>
                        <div class="col-span-1 text-right no-print">
                            <button onclick="removeItem(${item.id})" class="text-slate-300 hover:text-red-500 transition p-1">
                                <i class="fa-solid fa-xmark"></i>
                            </button>
                        </div>
                    `;
                    el.quoteContainer.appendChild(row);
                });
            }

            el.totalPrice.innerText = grandTotal.toLocaleString('no-NO') + " NOK";
            el.quoteCount.innerText = `${quoteItems.length} artiklar`;
        }

        function removeItem(id) {
            quoteItems = quoteItems.filter(item => item.id !== id);
            renderQuote();
        }

        function clearQuote() {
            if(quoteItems.length > 0 && confirm("Rensa hela offerten?")) {
                quoteItems = [];
                renderQuote();
            }
        }

        function changeQty(delta) {
            let val = parseInt(el.qtyInput.value) || 1;
            val += delta;
            if(val < 1) val = 1;
            el.qtyInput.value = val;
        }

        function showError(msg) {
            el.errorText.textContent = msg;
            el.errorMsg.classList.remove('hidden');
            setTimeout(() => el.errorMsg.classList.add('hidden'), 4000);
        }

        // --- AI Logic ---
        const aiInput = document.getElementById('ai-input');
        const aiResponse = document.getElementById('ai-response');

        window.fillPrompt = (txt) => {
            aiInput.value = txt;
        };

        async function handleChat() {
            const txt = aiInput.value.trim().toLowerCase();
            if (!txt) return;

            aiResponse.innerHTML = '<i class="fa-solid fa-spinner fa-spin text-indigo-500"></i> Tänker...';
            aiResponse.classList.remove('hidden');

            setTimeout(() => {
                let ans = "Jag är inte säker. Försök fråga om en specifik modell.";
                
                if(txt.includes("xl")) ans = "<strong>RS Smart 130 XL</strong> är för stora bredder (upp till 600 cm). Den kräver oftast motorstyrning på minst 20 Nm pga vikten.";
                else if(txt.includes("zip")) ans = "<strong>Mini ZIP</strong> är mycket vindtålig tack vare låsning i sidoskenorna. Kassetten är endast 75mm hög.";
                else if(txt.includes("c80")) ans = "<strong>C80</strong> (Neva) är en robust utv. persienn med falsade lameller för extra stabilitet i vind.";
                else if(txt.includes("universal")) ans = "<strong>RS Universal</strong> har unika tvådelade styrskenor (UTG) som döljer infästningen, perfekt för nischer.";
                
                aiResponse.innerHTML = ans;
            }, 600);
        }
    </script>
</body>
</html>
