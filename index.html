<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prima Sol - Offertverktyg</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Animationer */
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }

        /* Utskriftsanpassning */
        @media print {
            body { background: white; }
            #main-layout { display: block; }
            #config-panel, #ai-panel, #header-controls, .no-print { display: none !important; }
            #quote-section { width: 100%; border: none; shadow: none; }
            #quote-items { overflow: visible; height: auto; }
            header { border-bottom: 2px solid #000; margin-bottom: 20px; }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col text-slate-800">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm">
        <div class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <div class="flex items-center gap-6">
                <!-- KUNDLOGGA -->
                <div class="h-12 w-auto">
                    <img src="https://raw.githubusercontent.com/GusHem/Primasol/refs/heads/main/Prima%20Sol%20As%20Logga%202.svg" alt="Prima Sol As" class="h-full object-contain">
                </div>
                <div class="h-8 w-px bg-slate-200 hidden md:block"></div>
                <div>
                    <h1 class="text-sm font-bold text-slate-900 uppercase tracking-wider">Offertverktyg</h1>
                    <p class="text-xs text-slate-500">Neva & Screen Prislistor</p>
                </div>
            </div>
            
            <div id="header-controls" class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-xs text-slate-400">Inloggad</p>
                    <p class="text-sm font-medium text-slate-700">Säljare</p>
                </div>
                <div class="bg-slate-100 p-2 rounded-full text-slate-500 border border-slate-200">
                    <i class="fa-solid fa-user"></i>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-6 flex-grow w-full">
        <div id="main-layout" class="grid grid-cols-1 lg:grid-cols-12 gap-8 h-[calc(100vh-8rem)]">

            <!-- VÄNSTER: Konfigurator (5 kolumner) -->
            <div id="config-panel" class="lg:col-span-5 flex flex-col gap-6 overflow-y-auto custom-scroll pr-2 pb-10">
                
                <!-- 1. Produktval -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="bg-slate-800 px-5 py-3 flex justify-between items-center">
                        <h2 class="text-white font-semibold text-sm flex items-center gap-2">
                            <i class="fa-solid fa-gear"></i> 1. Konfigurera Produkt
                        </h2>
                    </div>
                    
                    <div class="p-5 space-y-5">
                        
                        <!-- Katalog -->
                        <div>
                            <label class="text-xs font-bold text-slate-500 uppercase mb-2 block">Katalog</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="vendor" value="screen_2025" class="peer sr-only" checked>
                                    <div class="py-2.5 px-3 text-center rounded-lg border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 peer-checked:bg-blue-50 peer-checked:border-blue-600 peer-checked:text-blue-700 peer-checked:shadow-sm transition-all">
                                        Hansen Screen
                                    </div>
                                </label>
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="vendor" value="neva_2023" class="peer sr-only">
                                    <div class="py-2.5 px-3 text-center rounded-lg border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 peer-checked:bg-orange-50 peer-checked:border-orange-600 peer-checked:text-orange-700 peer-checked:shadow-sm transition-all">
                                        Neva Persienner
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Dropdowns -->
                        <div class="grid grid-cols-1 gap-4">
                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Produktfamilj</label>
                                <div class="relative">
                                    <select id="category" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer appearance-none">
                                        <!-- JS fyller -->
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-chevron-down text-xs"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Modell</label>
                                <div class="relative">
                                    <select id="product" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer disabled:opacity-50 disabled:bg-slate-100" disabled>
                                        <option>-- Välj familj --</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-chevron-down text-xs"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mått -->
                        <div class="bg-blue-50 rounded-lg border border-blue-100 p-4">
                            <div class="flex justify-between mb-2">
                                <label class="text-xs font-bold text-blue-800 uppercase">Dimensioner (cm)</label>
                                <span id="dim-limits" class="text-[10px] text-blue-600 bg-white px-2 rounded-full border border-blue-200 hidden"></span>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="relative">
                                    <span class="absolute left-3 top-2.5 text-blue-400 text-xs font-bold">B</span>
                                    <input type="number" id="width" class="w-full pl-8 p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-500 outline-none font-mono font-bold text-slate-700" placeholder="Bredd">
                                </div>
                                <div class="relative">
                                    <span class="absolute left-3 top-2.5 text-blue-400 text-xs font-bold">H</span>
                                    <input type="number" id="height" class="w-full pl-8 p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-500 outline-none font-mono font-bold text-slate-700" placeholder="Höjd">
                                </div>
                            </div>
                        </div>

                        <!-- BERÄKNA KNAPP -->
                        <button id="calculate-btn" class="w-full bg-white border-2 border-slate-800 text-slate-800 hover:bg-slate-50 font-bold py-3 px-4 rounded-lg shadow-sm transition flex items-center justify-center gap-2">
                            <i class="fa-solid fa-calculator"></i> Beräkna Styckpris
                        </button>
                        
                        <div id="error-msg" class="hidden text-xs text-red-600 font-medium bg-red-50 p-3 rounded-lg border border-red-100 flex items-center gap-2">
                            <i class="fa-solid fa-triangle-exclamation"></i> <span id="error-text"></span>
                        </div>

                    </div>
                </div>

                <!-- 2. RESULTAT & LÄGG TILL (Visas efter beräkning) -->
                <div id="add-panel" class="bg-white rounded-xl shadow-md border border-green-200 overflow-hidden hidden transition-all duration-500 transform translate-y-4 opacity-0">
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-5 border-b border-green-100">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-xs text-green-700 font-bold uppercase tracking-wide">Beräknat Styckpris</p>
                                <div class="flex items-baseline gap-1">
                                    <span id="display-price" class="text-3xl font-black text-slate-900">0</span>
                                    <span class="text-sm font-bold text-slate-500">NOK</span>
                                </div>
                            </div>
                            <div class="text-right text-xs text-slate-500">
                                <p>Tabellmatchning:</p>
                                <p id="display-dims" class="font-mono font-bold">--</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-5 bg-white">
                        <div class="flex items-end gap-4">
                            <div class="flex-1">
                                <label class="text-xs font-bold text-slate-500 uppercase mb-1 block">Antal</label>
                                <div class="flex items-center h-10">
                                    <button onclick="changeQty(-1)" class="h-full px-3 bg-slate-100 border border-r-0 border-slate-300 rounded-l hover:bg-slate-200 text-slate-600 font-bold">-</button>
                                    <input type="number" id="quantity" value="1" min="1" class="h-full w-full border-y border-slate-300 outline-none text-center font-bold text-slate-800">
                                    <button onclick="changeQty(1)" class="h-full px-3 bg-slate-100 border border-l-0 border-slate-300 rounded-r hover:bg-slate-200 text-slate-600 font-bold">+</button>
                                </div>
                            </div>
                            <button id="add-to-quote-btn" class="flex-[2] h-10 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md shadow-green-200 transition flex items-center justify-center gap-2">
                                <i class="fa-solid fa-cart-plus"></i> Lägg till i Offert
                            </button>
                        </div>
                    </div>
                </div>

                <!-- AI (Kompakt) -->
                <div class="bg-indigo-50 rounded-xl border border-indigo-100 p-4 flex items-start gap-3">
                    <div class="bg-white p-2 rounded-full text-indigo-600 shadow-sm flex-shrink-0">
                        <i class="fa-solid fa-robot"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <h3 class="text-sm font-bold text-indigo-900">Produktassistent</h3>
                        <div class="flex gap-2 mt-2">
                            <input type="text" id="ai-input" class="w-full text-xs p-2 rounded border border-indigo-200 focus:ring-1 focus:ring-indigo-500 outline-none" placeholder="Fråga om tex RS Smart XL...">
                            <button onclick="handleChat()" class="bg-indigo-600 text-white px-3 py-1 rounded text-xs hover:bg-indigo-700 transition">Fråga</button>
                        </div>
                        <div id="ai-response" class="hidden mt-2 text-xs text-slate-700 bg-white p-2 rounded border border-indigo-100 shadow-sm leading-relaxed"></div>
                    </div>
                </div>

            </div>

            <!-- HÖGER: Offertöversikt / Varukorg (7 kolumner) -->
            <div id="quote-section" class="lg:col-span-7 bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col h-full min-h-[600px]">
                
                <!-- Quote Header -->
                <div class="px-6 py-4 border-b border-slate-200 bg-slate-50/80 rounded-t-2xl flex justify-between items-center">
                    <div>
                        <h2 class="font-bold text-slate-800 text-lg flex items-center gap-2">
                            <i class="fa-solid fa-file-invoice text-slate-400"></i> Aktuell Offert
                        </h2>
                        <div class="text-[10px] text-slate-500 mt-1 flex gap-3">
                            <span>Datum: <span id="current-date" class="font-medium text-slate-700"></span></span>
                            <span class="w-px h-3 bg-slate-300"></span>
                            <span>Ref: <span id="ref-id" class="font-medium text-slate-700"></span></span>
                        </div>
                    </div>
                    <span id="quote-count" class="bg-slate-200 text-slate-600 text-xs font-bold px-2 py-1 rounded-full">0 artiklar</span>
                </div>

                <!-- Table Header -->
                <div class="grid grid-cols-12 gap-2 px-6 py-2 bg-slate-100 text-[10px] font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200">
                    <div class="col-span-5">Produktbeskrivning</div>
                    <div class="col-span-2 text-center">Mått (cm)</div>
                    <div class="col-span-2 text-center">Antal</div>
                    <div class="col-span-2 text-right">Belopp</div>
                    <div class="col-span-1"></div>
                </div>

                <!-- Quote Items -->
                <div id="quote-items" class="flex-1 overflow-y-auto custom-scroll p-2 space-y-1 bg-white">
                    <!-- Empty State -->
                    <div id="empty-state" class="flex flex-col items-center justify-center h-full text-slate-300">
                        <i class="fa-solid fa-cart-arrow-down text-5xl mb-3 opacity-20"></i>
                        <p class="text-sm font-medium">Listan är tom</p>
                        <p class="text-xs">Gör en beräkning till vänster för att börja</p>
                    </div>
                </div>

                <!-- Quote Footer -->
                <div class="p-6 bg-slate-50 border-t border-slate-200 rounded-b-2xl">
                    <div class="flex flex-col items-end gap-1 mb-6">
                        <div class="text-sm text-slate-500 font-medium">Totalt Netto (exkl. motor)</div>
                        <div class="text-4xl font-black text-slate-900 tracking-tight" id="total-price">0 NOK</div>
                    </div>
                    
                    <div class="flex gap-3 justify-end no-print">
                        <button onclick="clearQuote()" class="px-4 py-2.5 text-sm text-red-600 font-semibold hover:bg-red-50 rounded-lg transition">
                            Rensa
                        </button>
                        <button onclick="window.print()" class="px-6 py-2.5 bg-slate-900 text-white text-sm font-bold rounded-lg hover:bg-slate-800 transition shadow-lg flex items-center gap-2">
                            <i class="fa-solid fa-print"></i> Exportera PDF / Skriv ut
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        // --- DATABAS ---
        const database = {
            "screen_2025": {
                "name": "Hansen Screen",
                "unit": "cm",
                "currency": "NOK",
                "categories": {
                    "RS Classic": {
                        "RS Classic 75": { base: 2154, stepW: 100, stepH: 100, factor: 1.04, range: {minW: 60, maxW: 230, minH: 60, maxH: 170} },
                        "RS Classic 85": { base: 2213, stepW: 100, stepH: 100, factor: 1.04, range: {minW: 60, maxW: 300, minH: 60, maxH: 320} },
                        "RS Classic 95": { base: 2301, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 350, minH: 60, maxH: 350} },
                        "RS Classic 105": { base: 2550, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 70, maxW: 400, minH: 60, maxH: 350} },
                        "RS Classic 120": { base: 2693, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} },
                        "RS Classic 125": { base: 2693, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} }
                    },
                    "Mini ZIP": {
                        "Mini ZIP": { base: 2482, stepW: 100, stepH: 100, factor: 1.035, range: {minW: 60, maxW: 340, minH: 60, maxH: 170} }
                    },
                    "RS Universal": {
                        "RS Universal 85": { base: 2475, stepW: 100, stepH: 100, factor: 1.045, range: {minW: 60, maxW: 200, minH: 60, maxH: 200} },
                        "RS Universal 95": { base: 2535, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 350, minH: 60, maxH: 350} },
                        "RS Universal 105": { base: 2715, stepW: 100, stepH: 100, factor: 1.055, range: {minW: 70, maxW: 400, minH: 60, maxH: 350} },
                        "RS Universal 120": { base: 2790, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} },
                        "RS Universal 125": { base: 2790, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} }
                    },
                    "RS Smart": {
                        "RS Smart 85": { base: 2715, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 300, minH: 60, maxH: 200} },
                        "RS Smart 100": { base: 3030, stepW: 100, stepH: 100, factor: 1.055, range: {minW: 70, maxW: 400, minH: 60, maxH: 350} },
                        "RS Smart 130": { base: 3480, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 500} },
                        "RS Smart 130 XL": { base: 14448, stepW: 610, stepH: 100, factor: 1.015, range: {minW: 610, maxW: 700, minH: 100, maxH: 300} }
                    }
                }
            },
            "neva_2023": {
                "name": "Neva Utvendig",
                "unit": "mm", 
                "currency": "NOK",
                "categories": {
                    "Utvendige Persienner": {
                        "C80 / F80": { base: 2410, stepW: 700, stepH: 700, factor: 1.04, range: {minW: 60, maxW: 500, minH: 60, maxH: 500} },
                    }
                }
            }
        };

        // --- ALLA MATRISER ---
        // Fyllda med data från PDF-filerna
        const priceMatrices = {
            // --- RS Smart ---
            "RS Smart 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [2715, 2820, 2985, 3090, 3180, 3330, 3465, 3570, 3705, 3825, 3945, 4080, 4185, 4320, 4440, 4575, 4695, 4815, 4950, 5055, 5175],
                    [2850, 3000, 3090, 3240, 3345, 3495, 3570, 3645, 3870, 4020, 4125, 4245, 4380, 4500, 4635, 4770, 4860, 4995, 5130, 5280, 5430],
                    [3000, 3150, 3120, 3285, 3525, 3675, 3645, 3750, 4065, 4185, 4320, 4320, 4545, 4695, 4635, 4950, 5055, 5145, 5325, 5460, 5610],
                    [3150, 3300, 3240, 3405, 3705, 3825, 3750, 3810, 4230, 4380, 4500, 4440, 4740, 4860, 4800, 5130, 5250, 5325, 5475, 5640, 5790],
                    [3300, 3450, 3285, 3435, 3855, 4020, 3810, 3900, 4425, 4545, 4695, 4455, 4905, 5055, 4800, 5325, 5430, 5475, 5670, 5820, 6015],
                    [3450, 3570, 3405, 3540, 4035, 4170, 3900, 3975, 4575, 4740, 4860, 4635, 5100, 5250, 4995, 5475, 5610, 5640, 5850, 6015, 6165],
                    [3630, 3750, 3435, 3570, 4185, 4350, 3975, 4080, 4770, 4905, 5055, 4635, 5280, 5430, 5145, 5670, 5790, 5820, 6030, 6195, 6375],
                    [3750, 3885, 3540, 3720, 4365, 4485, 4080, 4125, 4950, 5100, 5250, 4800, 5460, 5610, 5325, 5850, 6015, 6015, 6195, 6390, 6540],
                    [3885, 4050, 3570, 3720, 4500, 4650, 4125, 4245, 5130, 5280, 5430, 4980, 5640, 5790, 5475, 6030, 6195, 6165, 6390, 6570, 6750],
                    [4050, 4185, 3720, 3870, 4580, 4800, 4245, 4320, 5325, 5460, 5610, 4995, 5820, 6015, 5640, 6195, 6390, 6375, 6540, 6750, 6930],
                    [4185, 4365, 3720, 3885, 4815, 4995, 4320, 4440, 5475, 5640, 5790, 5145, 6015, 6165, 5790, 6390, 6570, 6540, 6820, 6930, 7125]
                ]
            },
            "RS Smart 100": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [3030,3165,3330,3495,3675,3825,4020,4170,4350,4485,4650,4800,4980,5130,5295,5460,5610,5775,5925,6090,6255,6420,6585,6750,6930,7095,7245,7410,7560,7740,7890],
                    [3150,3315,3495,3675,3825,4005,4170,4350,4485,4650,4815,4995,5145,5340,5490,5670,5820,6015,6150,6315,6495,6645,6810,6975,7170,7320,7485,7635,7830,7980,8145],
                    [3300,3465,3660,3810,4005,4140,4350,4485,4680,4815,5025,5160,5355,5505,5700,5865,6045,6195,6390,6540,6720,6870,7080,7230,7410,7560,7770,7905,8111,8250,8445],
                    [3435,3630,3795,3975,4125,4320,4485,4650,4815,5025,5175,5355,5520,5715,5895,6060,6240,6420,6585,6765,6945,7140,7310,7455,7635,7815,7980,8160,8355,8520,8685],
                    [3540,3750,3900,4095,4305,4455,4650,4815,5025,5175,5370,5535,5715,5895,6075,6255,6435,6615,6795,6975,7170,7335,7515,7725,7890,8070,8250,8445,8595,8775,8970],
                    [3705,3870,4065,4230,4440,4635,4800,4995,5160,5355,5535,5730,5910,6090,6270,6465,6630,6825,7035,7200,7380,7560,7770,7950,8130,8325,8505,8655,8865,9060,9240],
                    [3840,4035,4215,4410,4575,4785,4980,5145,5355,5520,5730,5910,6090,6300,6495,6645,6855,7050,7245,7425,7605,7815,7980,8160,8370,8550,8745,8940,9120,9300,9510],
                    [4005,4170,4380,4545,4755,4950,5130,5340,5505,5715,5895,6090,6300,6495,6690,6855,7080,7260,7440,7635,7830,8010,8235,8430,8610,8790,9000,9195,9360,9600,9780],
                    [4095,4320,4500,4725,4905,5100,5290,5490,5700,5895,6075,6270,6495,6690,6870,7095,7260,7455,7665,7875,8070,8250,8460,8640,8865,9060,9255,9435,9645,9840,10020],
                    [4230,4440,4650,4830,5055,5250,5460,5670,5865,6060,6255,6465,6645,6870,7095,7275,7485,7695,7890,8145,8340,8505,8685,8895,9105,9285,9510,9705,9900,10095,10305],
                    [4395,4575,4785,5025,5205,5415,5610,5850,6045,6240,6435,6645,6855,7080,7260,7485,7695,7890,8130,8325,8520,8700,8925,9150,9330,9555,9735,9960,10185,10365,10575],
                    [4530,4740,4935,5145,5355,5550,5775,6015,6195,6420,6615,6825,7050,7260,7455,7695,7890,8100,8325,8535,8730,8970,9165,9360,9600,9795,9990,10215,10410,10620,10875],
                    [4650,4860,5100,5295,5505,5730,5925,6150,6390,6600,6795,7035,7245,7440,7665,7890,8100,8325,8535,8745,8970,9180,9375,9615,9825,10020,10260,10470,10680,10920,11100],
                    [4785,5025,5235,5460,5685,5895,6105,6315,6540,6765,6975,7200,7425,7635,7875,8120,8325,8535,8745,8985,9180,9375,9630,9840,10035,10290,10515,10710,10950,11130,11385],
                    [4935,5145,5370,5595,5820,6060,6270,6510,6720,6945,7170,7380,7605,7860,8070,8280,8520,8730,8970,9180,9420,9645,9855,10065,10305,10530,10725,10995,11205,11430,11655],
                    [5085,5295,5505,5760,5970,6195,6435,6645,6870,7140,7335,7590,7815,8010,8265,8505,8700,8970,9180,9375,9645,9855,10065,10335,10545,10785,11010,11235,11490,11685,11910],
                    [5175,5430,5670,5895,6135,6375,6600,6810,7080,7305,7515,7785,7980,8235,8460,8685,8940,9165,9375,9630,9855,10095,10335,10560,10785,11025,11250,11505,11730,11955,12210],
                    [5340,5550,5820,6045,6270,6525,6765,6690,7230,7455,7725,7950,8175,8430,8640,8895,9150,9360,9615,9840,10065,10335,10560,10785,11025,11265,11520,11745,11970,12225,12435],
                    [5475,5715,5955,6195,6435,6690,6930,7170,7410,7635,7890,8130,8370,8610,8865,9105,9330,9600,9825,10035,10305,10545,10785,11025,11265,11520,11745,12000,12240,12465,12720],
                    [5610,5865,6090,6345,6600,6825,7095,7320,7590,7830,8070,8325,8550,8805,9060,9285,9555,9810,10020,10290,10530,10785,11025,11265,11520,11760,12015,12255,12510,12750,12975],
                    [5730,6015,6240,6510,6750,6690,7245,7500,7770,7980,8250,8505,8745,9000,9255,9510,9780,9990,10275,10515,10740,11010,11265,11520,11745,12015,12255,12525,12750,13020,13275],
                    [6645,6960,7245,7545,7815,8100,8415,8685,8985,9255,9555,9825,10110,10395,10695,10995,11280,11565,11850,12150,12420,12720,13020,13305,13575,13875,14160,14430,14730,15015,15315],
                    [6720,7035,7305,7605,7890,8160,8460,8745,9030,9300,9615,9885,10200,10470,10740,11025,11310,11625,11910,12210,12510,12765,13065,13335,13635,13920,14190,14460,14775,15015,15420],
                    [6855,7170,7440,7770,8010,8340,8610,8925,9195,9465,9795,10035,10365,10635,10950,11235,11550,11820,12150,12405,12720,12990,13305,13605,13875,14175,14430,14760,15015,15330,15630],
                    [6990,7305,7590,7890,8160,8505,8775,9090,9345,9660,9960,10260,10545,10875,11145,11430,11730,12030,12345,12615,12945,13230,13530,13800,14100,14400,14700,15000,15300,15615,15870],
                    [7140,7440,7740,8055,8340,8625,8940,9140,9555,9825,10155,10410,10725,11025,11325,11640,11955,12240,12555,12855,13140,13455,13755,14040,14340,14640,14940,15270,15540,15855,16170]
                ]
            },
            "RS Smart 130": {
                w: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350],
                h: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400],
                prices: [
                    [3166,3260,3323,3418,3512,3591,3654,3733,3812,3875,3953,4048,4142,4190,4284,4394,4505,4631,4678,4772,4851,5072,5235,5324,5355,5475],
                    [3308,3402,3465,3591,3654,3733,3812,3875,3969,4079,4158,4221,4331,4394,4489,4599,4725,4851,4914,4993,5119,5182,5370,5418,5355,5460],
                    [3434,3528,3638,3686,3812,3875,3969,4079,4174,4253,4331,4426,4489,4631,4709,4820,4946,5119,5166,5292,5371,5324,5610,5544,5550,5685],
                    [3591,3670,3764,3843,3953,4048,4158,4253,4331,4426,4536,4631,4709,4835,4898,5024,5150,5324,5418,5513,5607,5434,5865,5670,5855,6075],
                    [3686,3812,3906,4016,4095,4190,4316,4394,4489,4631,4709,4835,4914,5009,5119,5245,5387,5576,5670,5765,5891,5544,6135,5780,6165,6300],
                    [3827,3922,4048,4158,4253,4347,4473,4568,4678,4820,4898,4993,5119,5166,5339,5465,5576,5780,5906,6001,6127,5670,6390,5906,6570,6705],
                    [3953,4079,4190,4316,4394,4536,4646,4725,4883,4977,5072,5198,5324,5355,5528,5670,5780,6048,6158,6237,6379,5765,6615,6048,6750,6870],
                    [4095,4190,4331,4457,4552,4678,4820,4914,5009,5150,5292,5402,5513,5513,5733,5875,6032,6284,6395,6536,6631,5906,6900,6158,6960,7125],
                    [4221,4347,4457,4568,4709,4851,4977,5072,5198,5339,5481,5607,5702,5670,5954,6080,6221,6410,6615,6773,6899,6032,7095,6284,7335,7500],
                    [4347,4473,4631,4725,4883,4993,5135,5245,5402,5513,5654,5765,5906,5812,6158,6300,6442,6804,6820,7025,7166,6158,7320,6410,7560,7770],
                    [4473,4631,4725,4898,5009,5150,5292,5465,5576,5702,5828,5954,6127,6001,6347,6521,6678,6615,7040,7261,7434,6237,7605,6536,7570,8085],
                    [4631,4725,4898,5009,5166,5324,5481,5607,5733,5891,6001,6174,6284,6158,6552,6725,6867,7198,7245,7466,7655,6395,7860,6678,7950,8340],
                    [4725,4898,5009,5166,5339,5481,5639,5765,5906,6064,6221,6363,6521,6300,6757,6930,7103,7135,7434,7670,7938,6505,8130,6773,8160,8655],
                    [4883,5009,5166,5339,5497,5639,5765,5938,6111,6237,6395,6552,6725,6647,6962,7135,7308,7513,7623,7891,8174,6631,8370,6914,8505,8925],
                    [4993,5292,5481,5481,5639,5954,5954,6127,6442,6426,6568,6946,7103,6473,7166,7340,7513,7466,7970,8159,8442,6725,8610,7025,8730,9165],
                    [5135,5150,5324,5639,5765,5780,6127,6269,6269,6615,6773,6741,6899,6804,7387,7576,7749,7639,8127,8363,8694,6867,8820,7151,8985,9360],
                    [5245,5575,5607,5765,6111,6269,6269,6615,6615,6962,7166,7340,7308,6962,7592,7781,7954,7985,8363,8615,8930,6962,9090,7277,9195,9630],
                    [5402,5455,5733,5905,5938,6127,6442,6442,6788,6788,6962,7135,7497,7135,7796,7985,8159,8143,8552,8789,9214,7119,9300,7403,9435,9855],
                    [5513,5702,5891,6064,6237,6426,6615,6788,6962,7166,7340,7513,7718,7324,7970,8190,8379,8285,8726,8993,9419,7198,9615,7481,9675,10215],
                    [5654,5828,6001,6221,6395,6568,6773,6962,7166,7340,7513,7733,7938,7466,8143,8415,8804,8442,8930,9245,9734,7340,9840,7639,9990,10455],
                    [6048,6694,7308,6788,7733,6741,8054,8001,7844,8993,9419,9655,10379,7607,10206,10631,10442,8442,9104,9482,9938,7434,10065,7749,10260,10680],
                    [6552,7607,7450,7560,6552,6899,7103,7655,7497,9655,9623,9860,9923,7844,10663,10785,10600,8600,9371,9671,10206,7592,10365,7922,10500,11025],
                    [7387,5954,7166,6946,8017,7056,7261,8332,8206,9340,9923,10175,10159,8096,10899,11010,10789,8710,9655,9860,10395,7655,10545,7985,10830,11145],
                    [6710,6521,7922,7103,8379,7229,7450,8489,8379,9151,9245,9482,9734,8379,11135,11235,10710,8867,9702,9907,10584,7828,10845,8237,10950,11505],
                    [6426,7372,7025,7261,7592,7403,7592,7466,8600,8789,9072,9277,9513,8631,11403,11490,10915,9025,9891,10238,10631,7985,11070,8411,11265,11730],
                    [6284,6788,6883,7434,7450,7544,7765,7308,8773,8515,8852,9072,9324,8946,10206,11685,11135,9167,10017,10537,10899,8111,11295,8474,11520,11970],
                    [6174,6127,6741,6694,7308,7718,7938,7135,8962,8442,8694,8852,9104,9167,9182,11910,11088,9308,10206,10868,11135,8363,11610,8647,11745,12330],
                    [5906,6237,6568,6521,7166,7844,6946,8663,9119,8253,8489,8694,8867,9308,9403,11576,11009,9450,10505,11151,11403,8631,11835,8710,12060,12555],
                    [5765,6379,6442,6363,7025,8017,8206,8820,9371,8064,8285,8505,8694,9308,9655,11277,11198,9576,10521,11482,11624,8867,12060,8883,12405,12795],
                    [6946,6946,6284,8127,6883,8174,8363,9135,7340,7859,8096,8285,8505,9450,9749,11482,11356,9828,10726,11781,11891,9025,12360,8978,12585,13065],
                    [7056,7056,6174,7859,6725,8332,8521,7796,7670,7718,7938,8096,8285,9623,9875,11850,11293,10064,10789,12112,12128,9167,12735,9135,12945,13335],
                    [6206,6505,6757,7040,7324,7607,7891,8143,8442,8694,8993,9277,9560,9828,10080,10379,10631,10931,11214,11765,11482,9576,13010,9375,13425,13650],
                    [6332,6615,6883,7166,7450,7749,8017,8316,8584,8852,9135,9403,9702,9986,10269,10553,10852,11120,11419,11671,11954,10112,13290,9860,13650,13980],
                    [6426,6552,6678,6725,6820,6962,6993,7135,7261,7308,7418,7560,7592,7733,7828,7891,8001,8127,8143,8285,8442,8442,8600,8710,14070,14400],
                    [6773,7088,7387,7670,7970,8269,8584,8867,9182,9450,9749,10049,10364,10663,10946,11246,11561,11844,12159,12443,12758,10395,13800,10112,14220,14640],
                    [6883,7198,7481,7796,8096,8411,8694,9009,9308,9623,9907,10222,10521,10836,11135,11450,11750,12065,12332,12947,12647,10663,13995,10350,14430,14880],
                    [6993,7308,7623,7938,8237,8537,8852,9167,9450,9749,10064,10379,10679,10978,11293,11608,11907,12222,12521,13136,12836,10946,14190,10590,14640,15195],
                    [7119,7434,7749,8064,8363,8663,8993,9293,9623,9907,10238,10537,10868,11151,11482,11781,12112,12411,12742,13025,13340,11205,14415,10830,14865,15375],
                    [7245,7560,7891,8159,8489,8804,9119,9419,9749,10049,10379,10694,11009,11309,11639,11939,12269,12584,12915,13199,13529,11490,14640,11070,15090,15570]
                ]
            },
            "RS Smart 130 XL": {
                w: [610,620,630,640,650,660,670,680,690,700],
                h: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],
                prices: [
                    [14448,14592,14768,14912,15040,15200,15344,15520,15632,15792],
                    [14768,14928,15104,15256,15424,15600,15776,15952,16128,16304],
                    [15744,15936,16128,16320,16512,16704,16896,17088,17280,17488],
                    [16016,16272,16480,16688,16896,17104,17312,17536,17744,17952],
                    [16288,16480,16672,16864,17040,17248,17456,17648,17792,17984],
                    [16544,16752,16944,17136,17312,17520,17712,17904,18096,18288],
                    [16784,16960,17136,17296,17488,17664,17792,17968,18160,18320],
                    [17088,17280,17488,17680,17872,18064,18256,18448,18640,18832],
                    [18080,18288,18496,18720,18928,19120,19360,19552,19808,20032],
                    [19352,18400,18768,18992,19216,19440,19648,19856,20080,20272],
                    [19328,19552,19824,20064,20272,20512,20768,20992,21232,21472],
                    [19648,19888,20160,20416,20688,20912,21184,21456,21680,21984],
                    [20032,20256,20512,20800,21024,21280,21552,21632,22080,22160],
                    [20160,20400,20640,20864,21088,21360,21584,21792,22064,22320],
                    [20432,20688,20896,21136,21408,21616,21680,22112,22320,22528],
                    [20688,20880,21088,21344,21536,21728,21984,22352,22384,22592],
                    [21680,21984,22224,22448,22768,22992,23216,23520,23760,24000],
                    [21984,22224,22448,22768,22992,23216,23520,23760,24000,24288],
                    [22384,22640,22928,23168,23472,23712,23968,24256,24480,24752],
                    [22695,23010,23340,23505,23835,24135,24420,24750,25024,25552],
                    [23152,23472,23808,24144,24480,24816,25152,25488,25824,26160]
                ]
            },
            // --- RS Classic ---
            "RS Classic 75": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230],
                h: [100, 110, 120, 130, 140, 150, 160, 170],
                prices: [
                    [2154, 2286, 2360, 2493, 2567, 2670, 2758, 2876, 3009, 3083, 3186, 3289, 3407, 3466],
                    [2286, 2390, 2493, 2581, 2685, 2773, 2921, 3024, 3112, 3245, 3348, 3452, 3570, 3658],
                    [2360, 2493, 2581, 2699, 2803, 2935, 3053, 3127, 3260, 3393, 3466, 3614, 3732, 3820],
                    [2493, 2581, 2699, 2803, 2935, 3053, 3157, 3275, 3422, 3511, 3643, 3761, 3897, 3997],
                    [2567, 2685, 2803, 2935, 3068, 3186, 3289, 3437, 3570, 3658, 3791, 3938, 4027, 4160],
                    [2670, 2773, 2935, 3053, 3186, 3289, 3437, 3584, 3688, 3776, 3806, 4071, 4233, 4322],
                    [2758, 2921, 3053, 3157, 3289, 3437, 3584, 3702, 3820, 3968, 4101, 4248, 4351, 4484],
                    [2876, 3024, 3127, 3275, 3437, 3584, 3702, 3820, 3983, 4115, 4278, 4366, 4499, 4661]
                ]
            },
            "RS Classic 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320],
                prices: [
                    [2213, 2331, 2404, 2537, 2640, 2729, 2847, 2950, 3068, 3157, 3260, 3393, 3466, 3599, 3702, 3806, 3938, 4027, 4145, 4292, 4381],
                    [2331, 2434, 2537, 2655, 2744, 2876, 3009, 3083, 3216, 3304, 3422, 3570, 3643, 3761, 3879, 3983, 4101, 4233, 4337, 4455, 4573],
                    [2404, 2537, 2655, 2758, 2891, 3024, 3112, 3230, 3348, 3466, 3599, 3702, 3806, 3953, 4027, 4145, 4307, 4425, 4573, 4705, 4853],
                    [2537, 2655, 2758, 2891, 3024, 3112, 3245, 3378, 3481, 3629, 3747, 3835, 3983, 4101, 4233, 4337, 4469, 4617, 4735, 4897, 5030],
                    [2640, 2744, 2891, 3024, 3127, 3260, 3393, 3511, 3643, 3761, 3909, 4012, 4130, 4292, 4381, 4499, 4661, 4779, 4941, 5059, 5207],
                    [2729, 2876, 3024, 3112, 3260, 3393, 3511, 3658, 3776, 3938, 4027, 4160, 4322, 4425, 4573, 4691, 4823, 4971, 5089, 5251, 5384],
                    [2847, 3009, 3112, 3245, 3393, 3511, 3658, 3806, 3953, 4056, 4174, 4337, 4469, 4617, 4735, 4897, 5045, 5207, 5369, 5517, 5679],
                    [2950, 3083, 3230, 3378, 3511, 3658, 3806, 3953, 4071, 4233, 4351, 4484, 4617, 4750, 4912, 5059, 5236, 5384, 5546, 5694, 5856],
                    [3068, 3186, 3304, 3466, 3658, 3806, 3953, 4071, 4233, 4296, 4499, 4661, 4779, 4941, 5059, 5251, 5399, 5576, 5723, 5871, 6033],
                    [3157, 3275, 3422, 3614, 3806, 3953, 4071, 4233, 4351, 4514, 4676, 4794, 4956, 5074, 5236, 5413, 5590, 5753, 5915, 6048, 6210],
                    [3260, 3393, 3511, 3732, 3953, 4071, 4233, 4351, 4484, 4691, 4823, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402],
                    [3393, 3466, 3599, 3843, 4056, 4174, 4351, 4484, 4691, 4823, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579],
                    [3466, 3599, 3702, 3969, 4174, 4337, 4484, 4617, 4823, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726],
                    [3599, 3702, 3806, 4027, 4337, 4469, 4691, 4750, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918],
                    [3702, 3806, 3953, 4145, 4469, 4617, 4823, 4912, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094],
                    [3806, 3953, 4027, 4233, 4573, 4735, 4971, 5059, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271],
                    [3938, 4027, 4145, 4337, 4691, 4897, 5089, 5236, 5399, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448],
                    [4027, 4145, 4307, 4469, 4823, 5045, 5251, 5384, 5576, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610],
                    [4145, 4233, 4425, 4617, 4971, 5207, 5384, 5546, 5723, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801],
                    [4292, 4337, 4573, 4735, 5089, 5369, 5605, 5694, 5871, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978],
                    [4381, 4455, 4705, 4897, 5251, 5517, 5767, 5856, 6033, 6210, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978, 8184],
                    [4469, 4573, 4853, 5045, 5384, 5679, 5930, 6033, 6210, 6372, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978, 8184, 8346],
                    [4617, 4691, 5030, 5207, 5605, 5856, 6062, 6210, 6402, 6548, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978, 8184, 8346, 8522]
                ]
            },
            "RS Classic 95": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2301,2375,2493,2581,2699,2803,2935,3039,3127,3452,3378,3245,3688,3599,3791,3909,4012,4115,4248,4337,4455,4573,4676,4897,4779,5015],
                    [2375,2493,2581,2699,2832,2950,3053,3157,3275,3407,3481,3629,3835,3747,3983,4174,4071,4322,4425,4514,4661,4750,4897,5118,5015,5251],
                    [2478,2581,2699,2832,3068,3186,2950,3289,3422,3776,3658,3570,4012,3909,4130,4366,4278,4484,4617,4720,4853,4971,5074,5207,5325,5428],
                    [2581,2699,2832,2950,3216,3304,3083,3437,3599,3953,3806,3702,4174,4071,4322,4573,4425,4691,4794,4941,5059,5192,5325,5428,5590,5694],
                    [2685,2832,2950,3068,3304,3452,3216,3599,3732,4101,3983,3820,4351,4248,4484,4735,4617,4868,5015,5118,5266,5384,5517,5635,5782,5915],
                    [2773,2935,3068,3216,3452,3614,3304,3747,3835,3997,4130,4307,4381,4514,4676,4794,4941,5059,5207,5325,5443,5590,5723,5974,5826,6092],
                    [2921,3053,3186,3304,3452,3614,3747,3879,4012,4145,4307,4425,4573,4705,4853,5000,5118,5266,5399,5546,5679,5812,5959,6239,6092,6387],
                    [3024,3127,3289,3437,3732,3879,3599,4012,4145,4602,4425,4307,4868,4720,5015,5310,5163,5428,5590,5753,5871,6003,6151,6431,6298,6579],
                    [3098,3260,3407,3584,3702,3835,3997,4145,4307,4455,4602,4735,4897,5045,5192,5340,5458,5635,5782,5944,6062,6210,6357,6490,6638,6756],
                    [3230,3393,3511,3688,3820,3983,4130,4307,4405,4912,4602,4735,5207,5059,5369,5664,5517,5812,5974,6136,6284,6431,6579,6844,6697,7006],
                    [3304,3481,3629,3791,4115,4278,3968,4425,4602,4912,4735,5059,5369,5207,5517,5812,5664,5974,6136,6284,6431,6579,6697,7006,6844,7124],
                    [3437,3629,3747,3938,4248,4381,4101,4573,4735,5207,4897,5059,5517,5369,5664,5974,5812,6136,6284,6431,6579,6697,6844,7006,7124,7331],
                    [3570,3747,3820,4027,4366,4233,4499,4705,4897,5384,5236,5045,5679,5546,5826,5989,6151,6298,6451,6593,6711,6859,7021,7360,7139,7567],
                    [3643,3835,3997,282,4705,4469,4337,4897,5045,5576,5384,5236,5826,5679,5989,6298,6151,6451,6593,6711,6859,7021,7139,7360,7567,7695],
                    [3820,3983,4145,4337,4469,4705,4897,5059,5251,5399,5576,5694,5856,6003,6166,6475,6313,6608,8068,6874,7036,7154,7375,7596,7801,7954],
                    [4056,4278,4425,4573,4853,5015,5207,5384,5576,5871,5753,6003,6357,6166,6520,6815,6667,6977,7124,7287,7390,7596,7781,7954,8111,8285],
                    [4307,4425,4573,4853,5207,5015,5399,5576,5767,5915,6033,6195,6387,6534,6682,6829,7006,7139,7301,7419,7655,7844,7985,8159,8363,8489],
                    [4484,4617,4705,5118,5399,5163,5605,5753,5974,6195,6048,6387,6579,6844,6863,7006,7154,7316,7478,7670,7891,7970,8190,8363,8521,8710],
                    [4705,4779,4853,5399,5605,5325,5790,5930,6195,6534,6357,6210,6756,6962,7021,7331,7139,7493,7670,7828,8017,8143,8316,8552,8726,8930],
                    [4897,5118,5207,5428,5635,5974,6239,6431,6490,6844,7006,7006,7360,7360,7596,7124,7308,7478,7670,7331,7596,7567,7567,9214,10395,10663],
                    [5015,5251,5428,5694,5915,6092,6387,6579,6756,7006,7124,7331,7567,7360,7596,7390,7844,7478,7670,7331,7596,7567,7567,9450,10663,10845]
                ]
            },
            "RS Classic 105": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2550,2685,2775,2880,3000,3105,3180,3315,3435,3510,3660,3750,3855,3975,4065,4245,4395,4500,4635,4755,4860,4995,5115,5235,5355,5475,5595,5700,5895,6030,6105],
                    [2685,2790,2895,3030,3135,3240,3345,3465,3570,3705,3825,3945,4050,4140,4245,4440,4545,4650,4755,4830,4950,5055,5145,5250,5355,5460,5580,5790,5955,6165,6300],
                    [2805,2925,3060,3150,3285,3408,3510,3660,3750,3855,3975,4080,4200,4365,4455,4680,4770,4860,4980,5085,5160,5280,5370,5475,5550,5685,5800,5955,6060,6240,6405],
                    [2925,3060,3150,3300,3435,3525,3675,3795,3885,4035,4140,4245,4395,4530,4650,4860,4995,5115,5235,5355,5475,5595,5715,5850,5855,6075,6240,6495,6585,6705,6810],
                    [3075,3165,3300,3450,3540,3690,3825,3945,4065,4200,4350,4455,4575,4725,4830,5100,5205,5340,5460,5550,5700,5820,5925,6060,6165,6300,6510,6615,6750,6855,6975],
                    [3165,3300,3450,3540,3705,3840,3975,4095,4215,4380,4500,4635,4770,4875,5040,5295,5430,5550,5715,5865,6015,6135,6270,6420,6570,6705,6780,6900,7050,7170,7275],
                    [3300,3435,3540,3705,3840,4005,4125,4245,4395,4530,4680,4800,4935,5100,5205,5475,5610,5760,5895,6045,6165,6390,6525,6630,6750,6870,7050,7185,7305,7440,7560],
                    [3435,3540,3705,3840,4005,4125,4245,4425,4560,4725,4830,4995,5130,5280,5415,5700,5850,5970,6105,6255,6405,6615,6765,6900,7035,7125,7305,7440,7590,7740,7875],
                    [3525,3690,3825,4005,4125,4245,4425,4560,4725,4860,5025,5160,5325,5460,5595,5895,6060,6210,6390,6540,6750,6870,7035,7170,7305,7500,7590,7740,7875,8010,8160],
                    [3675,3825,3975,4125,4245,4425,4575,4740,4875,5040,5175,5340,5490,5670,5790,6105,6270,6435,6600,6765,6960,7140,7260,7410,7560,7740,7860,7995,8145,8280,8460],
                    [3795,3945,4095,4230,4410,4560,4740,4875,5055,5175,5355,5505,5685,5850,6015,6300,6435,6585,6720,6855,7230,7365,7515,7695,7830,8010,8130,8280,8460,8595,8745],
                    [3885,4065,4215,4395,4545,4740,4875,5055,5205,5370,5520,5700,5865,6030,6165,6510,6645,6810,6975,7155,7455,7605,7785,7920,8085,8265,8415,8550,8700,8880,9030],
                    [4035,4200,4380,4530,4725,4860,5040,5205,5370,5520,5700,5880,6045,6195,6390,6720,6870,7050,7200,7365,7695,7860,7995,8160,8340,8505,8655,8820,9000,9165,9300],
                    [4140,4350,4485,4680,4815,5025,5175,5355,5520,5700,5880,6045,6210,6405,6570,6930,7125,7275,7455,7635,7950,8100,8265,8460,8610,8775,8970,9120,9270,9450,9630],
                    [4305,4440,4635,4800,4995,5160,5340,5505,5700,5880,6060,6240,6405,6585,6765,7155,7320,7500,7695,7875,8160,8355,8520,8685,8880,9030,9225,9360,9570,9720,9900],
                    [4395,4560,4755,4935,5130,5325,5490,5685,5865,6045,6210,6435,6585,6765,6945,7320,7500,7695,7875,8055,8445,8610,8790,8970,9150,9300,9510,9675,9840,10005,10215],
                    [4530,4725,4875,5100,5280,5475,5670,5850,6030,6195,6405,6630,6765,6960,7155,7515,7725,7890,8070,8250,8655,8865,9030,9225,9375,9600,9780,9930,10100,10305,10500],
                    [4650,4815,5040,5205,5415,5610,5790,5970,6165,6390,6570,6810,6990,7155,7320,7770,7950,8100,8280,8475,8895,9090,9270,9450,9645,9840,10005,10215,10395,10575,10740],
                    [4770,4980,5145,5355,5595,5775,5955,6132,6345,6540,6750,6990,7200,7320,7515,7950,8145,8340,8520,8700,9165,9330,9555,9720,9915,10095,10305,10515,10680,10905,11070],
                    [4875,5100,5295,5490,5730,5925,6090,6300,6510,6705,6900,7200,7380,7515,7740,8160,8370,8565,8775,8970,9360,9600,9795,9975,10200,10365,10560,10740,10965,11175,11325],
                    [5025,5205,5415,5640,5895,6075,6255,6465,6645,6855,7095,7380,7590,7695,7905,8355,8550,8775,8985,9180,9645,9840,10020,10260,10455,10635,10875,11055,11250,11445,11655]
                ]
            },
            // RS Classic 120 / 125 (Delar samma matris 100-350cm)
            "RS Classic 120": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4741,4851,4961,5072,5182,5324,5418,5528],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,5119,5182,5324,5418,5544,5670,5765],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5056,5166,5371,5434,5544,5670,5780,5906,6048],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5292,5418,5607,5670,5780,5906,6048,6158,6284],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5513,5670,5891,5985,6095,6237,6379,6495,6615],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5749,5906,6127,6206,6347,6495,6631,6773,6900],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4820,4961,5119,5245,5387,5528,5670,5780,6001,6158,6379,6473,6615,6757,6900,7050,7170],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,4946,5150,5324,5465,5576,5733,5875,6032,6174,6395,6631,6725,6883,7025,7170,7305,7440],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5213,5355,5497,5654,5780,5954,6080,6221,6410,6600,6899,6993,7135,7287,7425,7590,7725],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6647,6810,7166,7261,7410,7560,7718,7860,7980],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6851,7080,7434,7513,7670,7815,7970,8130,8250],
                    [4316,4489,4646,4820,4961,5135,5292,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7056,7230,7655,7785,7920,8085,8235,8415,8505],
                    [4473,4646,4820,4961,5135,5324,5465,5639,5765,5954,6111,6269,6426,6615,6757,6930,7103,7277,7455,7938,8017,8175,8340,8489,8655,8745],
                    [4631,4804,4946,5119,5324,5465,5639,5780,5985,6127,6300,6473,6647,6788,6962,7135,7308,7466,7695,8174,8280,8442,8610,8775,8940,9000],
                    [4725,4946,5135,5261,5465,5639,5812,6001,6158,6332,6505,6678,6820,6993,7166,7340,7513,7733,7920,8442,8537,8694,8865,9025,9195,9255],
                    [4883,5119,5324,5418,5639,5780,5985,6127,6300,6473,6694,6851,7040,7214,7387,7576,7749,7954,8160,8694,8789,8970,9135,9300,9465,9510],
                    [4993,5261,5481,5560,5780,5922,6111,6269,6426,6631,6867,7056,7245,7418,7592,7781,7954,8159,8363,8930,9030,9195,9360,9540,9675,9780],
                    [5135,5402,5654,5717,5985,6158,6347,6495,6647,6851,7088,7261,7434,7607,7796,7985,8159,8363,8615,9214,9308,9482,9645,9825,9990,9990],
                    [5245,5481,5812,5891,6080,6284,6473,6631,6788,7025,7261,7434,7623,7812,8001,8190,8379,8552,8726,9419,9513,9702,9860,10035,10215,10275],
                    [5402,5670,6001,6017,6284,6505,6615,6788,6962,7214,7434,7639,7828,8064,8206,8411,8615,8789,8993,9734,9825,10020,10185,10365,10530,10515],
                    [5513,5859,6111,6206,6395,6694,6851,6993,7135,7387,7592,7796,8017,8237,8426,8615,8789,8993,9180,9938,10049,10238,10411,10584,10785,10740],
                    [5654,6017,6347,6395,6631,6820,7103,7214,7340,7560,7812,7985,8174,8348,8584,8789,8978,9182,9371,10206,10285,10490,10663,10836,11010,11010],
                    [6048,6206,6615,6631,6851,7056,7340,7403,7592,7733,8064,8237,8442,8610,8773,8993,9182,9387,9570,10395,10505,10710,10899,11057,11235,11265],
                    [6552,6395,6851,6820,7025,7308,7592,7623,7844,7970,8316,8489,8694,8867,9056,9277,9450,9655,9840,10584,10679,10931,11088,11261,11450,11520],
                    [7387,6631,7103,6993,7261,7513,7844,7954,8096,8206,8584,8726,8970,9135,9324,9540,9749,9907,10112,10631,10805,11025,11198,11324,11561,11745],
                    [6710,6820,7340,7214,7403,7781,8096,8253,8363,8442,8852,8993,9214,9371,9576,9735,9923,10206,10379,10899,10931,11151,11356,11592,11750,12015]
                ]
            },
            "RS Classic 125": {
                // Samma matris som 120
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4741,4851,4961,5072,5182,5324,5418,5528],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,5119,5182,5324,5418,5544,5670,5765],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5056,5166,5371,5434,5544,5670,5780,5906,6048],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5292,5418,5607,5670,5780,5906,6048,6158,6284],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5513,5670,5891,5985,6095,6237,6379,6495,6615],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5749,5906,6127,6206,6347,6495,6631,6773,6900],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4820,4961,5119,5245,5387,5528,5670,5780,6001,6158,6379,6473,6615,6757,6900,7050,7170],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,4946,5150,5324,5465,5576,5733,5875,6032,6174,6395,6631,6725,6883,7025,7170,7305,7440],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5213,5355,5497,5654,5780,5954,6080,6221,6410,6600,6899,6993,7135,7287,7425,7590,7725],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6647,6810,7166,7261,7410,7560,7718,7860,7980],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6851,7080,7434,7513,7670,7815,7970,8130,8250],
                    [4316,4489,4646,4820,4961,5135,5292,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7056,7230,7655,7785,7920,8085,8235,8415,8505],
                    [4473,4646,4820,4961,5135,5324,5465,5639,5765,5954,6111,6269,6426,6615,6757,6930,7103,7277,7455,7938,8017,8175,8340,8489,8655,8745],
                    [4631,4804,4946,5119,5324,5465,5639,5780,5985,6127,6300,6473,6647,6788,6962,7135,7308,7466,7695,8174,8280,8442,8610,8775,8940,9000],
                    [4725,4946,5135,5261,5465,5639,5812,6001,6158,6332,6505,6678,6820,6993,7166,7340,7513,7733,7920,8442,8537,8694,8865,9025,9195,9255],
                    [4883,5119,5324,5418,5639,5780,5985,6127,6300,6473,6694,6851,7040,7214,7387,7576,7749,7954,8160,8694,8789,8970,9135,9300,9465,9510],
                    [4993,5261,5481,5560,5780,5922,6111,6269,6426,6631,6867,7056,7245,7418,7592,7781,7954,8159,8363,8930,9030,9195,9360,9540,9675,9780],
                    [5135,5402,5654,5717,5985,6158,6347,6495,6647,6851,7088,7261,7434,7607,7796,7985,8159,8363,8615,9214,9308,9482,9645,9825,9990,9990],
                    [5245,5481,5812,5891,6080,6284,6473,6631,6788,7025,7261,7434,7623,7812,8001,8190,8379,8552,8726,9419,9513,9702,9860,10035,10215,10275],
                    [5402,5670,6001,6017,6284,6505,6615,6788,6962,7214,7434,7639,7828,8064,8206,8411,8615,8789,8993,9734,9825,10020,10185,10365,10530,10515],
                    [5513,5859,6111,6206,6395,6694,6851,6993,7135,7387,7592,7796,8017,8237,8426,8615,8789,8993,9180,9938,10049,10238,10411,10584,10785,10740],
                    [5654,6017,6347,6395,6631,6820,7103,7214,7340,7560,7812,7985,8174,8348,8584,8789,8978,9182,9371,10206,10285,10490,10663,10836,11010,11010],
                    [6048,6206,6615,6631,6851,7056,7340,7403,7592,7733,8064,8237,8442,8610,8773,8993,9182,9387,9570,10395,10505,10710,10899,11057,11235,11265],
                    [6552,6395,6851,6820,7025,7308,7592,7623,7844,7970,8316,8489,8694,8867,9056,9277,9450,9655,9840,10584,10679,10931,11088,11261,11450,11520],
                    [7387,6631,7103,6993,7261,7513,7844,7954,8096,8206,8584,8726,8970,9135,9324,9540,9749,9907,10112,10631,10805,11025,11198,11324,11561,11745],
                    [6710,6820,7340,7214,7403,7781,8096,8253,8363,8442,8852,8993,9214,9371,9576,9735,9923,10206,10379,10899,10931,11151,11356,11592,11750,12015]
                ]
            },
            // --- RS Universal ---
            "RS Universal 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [2475, 2610, 2730, 2850, 2985, 3105, 3210, 3330, 3465, 3570, 3705],
                    [2610, 2730, 2880, 3000, 3120, 3240, 3360, 3495, 3645, 3750, 3870],
                    [2745, 2880, 3030, 3135, 3285, 3405, 3525, 3675, 3810, 3900, 4065],
                    [2895, 3030, 3150, 3300, 3435, 3540, 3705, 3825, 3975, 4095, 4230],
                    [3060, 3150, 3300, 3450, 3570, 3720, 3855, 4020, 4140, 4305, 4410],
                    [3150, 3300, 3465, 3630, 3750, 3870, 4035, 4170, 4320, 4440, 4575],
                    [3300, 3450, 3630, 3750, 3870, 4050, 4185, 4350, 4485, 4635, 4770],
                    [3450, 3570, 3750, 3885, 4050, 4200, 4365, 4500, 4650, 4800, 4950],
                    [3570, 3720, 3870, 4050, 4200, 4365, 4500, 4680, 4815, 4995, 5130],
                    [3705, 3855, 4035, 4185, 4365, 4500, 4680, 4815, 4995, 5145, 5325],
                    [3840, 4020, 4185, 4365, 4500, 4680, 4815, 5025, 5160, 5340, 5490]
                ]
            },
            "RS Universal 95": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2535,2655,2775,2895,3030,3135,3270,3360,3495,3645,3750,3855,4185,4095,4215,4365,4455,4575,4725,4830,4950,4995,5145,5250,5355,5460],
                    [2685,2805,2940,3075,3165,3300,3450,3540,3690,3810,3945,4065,4455,4320,4440,4560,4695,4800,4935,5085,5160,5055,5370,5490,5355,5685],
                    [2805,2970,3090,3210,3330,3480,3630,3720,3855,4455,4125,4230,4560,4500,4650,4980,4875,5040,5145,5355,5475,5280,5610,5730,5550,5970],
                    [2970,3105,3240,223,3495,3660,3765,3885,4050,4170,4320,4440,4395,4725,4830,4770,5115,5250,5370,5550,5700,5595,5865,5970,5855,6210],
                    [3105,3360,3360,3690,3675,3975,4095,4080,4200,4365,4485,4635,5145,4905,5055,5175,5340,5460,5820,5865,6015,5820,6135,6270,6165,6570],
                    [3240,3240,3510,3510,3825,3810,3945,4230,4395,4530,4860,4800,5355,5115,5250,5400,5520,5685,5595,6045,6100,6135,6390,6525,6645,6795],
                    [3360,3525,3690,3825,4455,4125,4440,4425,4560,4725,5055,5025,5535,5325,5460,5595,5760,8895,6045,6255,6345,6240,6615,6865,6900,7050],
                    [3510,3690,3825,4455,4125,4305,4590,4575,4755,4875,5235,5175,5730,5490,5670,5820,5970,6105,6255,6540,6585,6495,6900,7080,7230,7380],
                    [3675,3825,4455,4140,4305,4440,4245,4770,4860,5085,5790,5400,5925,5700,5865,6030,6165,6315,6495,6765,6795,6750,7095,7230,7365,7500],
                    [3810,3975,4125,4590,4440,4770,5115,4935,9057,5610,5595,5550,6105,8895,6255,6630,6795,6540,6930,6855,7050,6945,7320,7455,7605,7770],
                    [3945,4245,4305,4440,4770,4935,4950,5115,5280,5430,5415,5775,7125,6090,6465,6624,6390,6765,6705,7155,7275,7185,7605,7785,7920,8085],
                    [4080,4095,4425,4305,4590,4590,4770,5280,5460,5250,6900,5970,7275,6300,6060,6420,6600,6975,7155,7365,7515,7440,7860,7995,8160,8340],
                    [4215,4410,4575,4755,4935,5115,5280,5460,5610,6705,6720,6900,6525,6510,6855,6825,7875,8055,8475,7635,7785,7695,8130,8325,8505,8655],
                    [4935,4545,4740,4905,5100,5280,5430,5610,5790,6150,6150,6345,6705,6705,6645,7050,7440,7620,8010,7875,7995,7950,8370,8550,8730,8925],
                    [4380,4695,4860,5085,5250,5430,5610,5790,5970,6345,6345,6525,6900,6870,7725,7260,8070,7860,8250,8055,8250,8175,8610,8790,8985,9165],
                    [4500,4830,5040,5205,5400,5595,5775,5970,6150,6525,6525,6720,6315,7095,7485,7455,7890,8100,8370,8250,8475,8445,8820,9015,9195,9360],
                    [4650,4995,5160,5370,5535,5760,5925,6135,6315,5970,5790,7125,6525,7275,7275,7665,8085,8325,8565,8475,8700,8640,9090,9255,9435,9630],
                    [4785,5130,5340,5505,5715,5910,6105,6300,6510,5790,5970,6135,6705,7485,7095,7890,8280,8415,8805,8700,8970,8895,9300,9510,9675,9855],
                    [5085,5280,5475,5685,5880,6075,6270,6495,6690,6870,7260,7275,6105,7695,7890,8085,8440,8610,9030,8970,9195,9150,9615,9810,9990,10215],
                    [5205,5415,5640,5850,6045,6240,6435,6645,6855,7080,7440,7455,5925,7890,8085,8265,8580,8820,9255,9240,9435,9375,9840,10020,10260,10455],
                    [5355,5550,5775,5970,6810,6900,7140,7335,7560,7800,8175,7665,7875,8085,8505,8505,8730,9060,9510,9465,9675,9645,10065,10290,10500,10680],
                    [5490,5715,5910,6135,6645,7080,7275,7500,7770,7605,7995,7860,7695,8265,8685,8775,8870,9270,9720,9705,9915,9885,10335,10575,10830,11025],
                    [5640,5865,6075,6300,6375,6720,6945,7695,7050,7425,7830,8055,7485,8475,8895,8970,9100,9540,9960,9930,10155,10155,10545,10710,10950,11145],
                    [5775,6015,6624,6435,6525,6405,6615,6810,7200,7245,7635,8235,8070,8655,8280,9375,9250,9735,10350,10185,10380,10350,10785,10950,11265,11505],
                    [5910,6135,6390,6600,6195,6570,6780,6990,7380,7965,8370,8430,7875,8445,8640,9180,9460,9960,10395,10395,10620,10590,11010,11280,11520,11730],
                    [6060,6300,6525,6765,6975,7230,7440,7695,7905,8145,8610,8820,9165,8820,9030,10335,9600,10350,10635,10890,10890,10875,11235,11550,11745,11970]
                ]
            },
            // RS Universal 105
            "RS Universal 105": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2685,2805,2940,3075,3165,3300,3450,3540,3645,3810,3750,4065,4185,4095,4440,4365,4695,4800,4935,5250,5370,5490,5610,5730,5865,5970],
                    [2805,2970,3090,3210,3330,3480,3630,3720,3810,4020,4125,4230,4395,4320,4650,4770,4875,5040,5145,5490,5610,5730,5865,5970,6090,6210],
                    [2940,3105,3240,3360,3495,3660,3765,3885,4065,4185,4320,4440,4560,4500,4830,4980,5115,5250,5370,5715,5865,5970,6090,6210,6345,6570],
                    [3075,3240,3360,3510,3675,3810,3945,4080,4230,4395,4485,4650,4770,4725,5055,5175,5325,5460,5595,5955,6075,6240,6375,6510,6600,6795],
                    [3165,3360,3510,3690,3825,3975,4095,4230,4425,4560,4680,4830,4980,4905,5250,5400,5520,5685,5820,6195,6255,6420,6540,6690,6825,7050],
                    [3300,3525,3690,3825,4455,4125,4245,4425,4590,4770,4860,5025,5145,5115,5460,5610,5760,5895,6060,6420,6495,6615,6780,6930,7095,7380],
                    [3450,3690,3825,4455,4125,4305,4425,4575,4755,4950,5055,5175,5355,5325,5670,5850,5970,6135,6270,6645,6750,6900,7095,7230,7320,7500],
                    [3540,3825,4455,4140,4305,4440,4590,4770,4860,5130,5235,5400,5535,5490,5865,6060,6165,6375,6510,6900,6945,7095,7230,7455,7590,7770],
                    [3645,3975,4125,4305,4440,4590,4770,4935,5100,5340,5490,5550,5775,5700,6015,6255,6420,6585,6750,7140,7185,7320,7605,7785,7890,8085],
                    [3810,4245,4305,4440,4770,4935,4950,5115,5295,5505,5685,5775,6015,6300,6315,6495,6630,6795,6960,7365,7440,7605,7860,7995,8145,8340],
                    [3750,4095,4425,4590,4590,4770,5115,5280,5490,5715,5880,6015,6195,6090,6540,6705,6855,7035,7200,7590,7695,7860,8010,8250,8460,8655],
                    [4065,4410,4575,4755,4935,5115,5280,5460,5685,5895,6075,6240,6405,6300,6750,6930,7095,7260,7425,7830,7950,8130,8370,8475,8730,8925],
                    [4185,4545,4740,4905,5100,5280,5430,5610,5880,6090,6255,6435,6615,6510,6960,7140,7305,7485,7635,8070,8175,8370,8550,8694,8985,9165],
                    [4095,4695,4860,5085,5250,5430,5610,5790,6075,6270,6465,6630,6810,6705,7170,7335,7515,7725,7890,8280,8445,8610,8775,8970,9195,9360],
                    [4440,4830,5040,5205,5400,5595,5775,5970,6255,6465,6645,6825,7035,6870,7380,7560,7770,7920,8100,8535,8640,8820,9090,9255,9435,9630],
                    [4365,4995,5160,5370,5535,5760,5925,6135,6465,6645,6825,7035,7230,7095,7590,7800,7965,8145,8370,8775,8895,9090,9285,9510,9675,9855],
                    [4695,5130,5340,5505,5715,5910,6105,6300,6645,6825,7050,7230,7425,7275,7815,7995,8175,8415,8565,9000,9150,9300,9540,9702,9990,10215],
                    [4800,5325,5475,5685,5880,6075,6270,6495,6855,7050,7230,7425,7620,7485,8010,8220,8430,8610,8805,9240,9375,9615,9735,9923,10260,10455],
                    [4935,5475,5610,5850,6045,6240,6435,6645,7080,7230,7425,7620,7830,7695,8235,8445,8625,8820,9030,9465,9645,9840,10065,10305,10500,10680],
                    [5250,5610,5775,5970,6195,6420,6615,6810,7260,7425,7620,7830,8010,7890,8460,8640,8865,9060,9255,9705,9885,10065,10200,10530,10830,11025],
                    [5370,5775,5925,6135,6255,6495,6795,6990,7440,7605,7815,8010,8235,8085,8640,8880,9090,9270,9510,9930,10155,10350,10411,10725,11085,11310],
                    [5490,5925,6090,6300,6420,6615,6975,7185,7665,7800,7995,8235,8445,8265,8880,9090,9285,9540,9720,10185,10350,10545,10694,10931,11295,11482],
                    [5610,6075,6255,6435,6540,6780,7170,7365,7890,7980,8220,8445,8625,8475,9090,9285,9540,9735,9960,10395,10590,10845,11009,11205,11505,11655],
                    [5730,6135,6390,6600,6690,6930,7320,7545,8100,8160,8415,8610,8865,8655,9285,9540,9735,9960,10350,10635,10875,11070,11309,11505,11745,11939],
                    [5865,6300,6525,6765,6825,7095,7440,7740,8325,8370,8595,8805,9060,9270,9510,9735,9960,10350,10395,10890,11085,11295,11639,11790,12060,12269],
                    [5970,6405,6690,6870,7050,7230,7410,7590,7770,7905,8130,8340,8610,8820,9015,9225,9465,9720,10635,10215,10695,10845,11070,11355,11550,11730]
                ]
            },
            // RS Universal 120 / 125
            "RS Universal 120": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4741,4851,4961,5072,5182,5324,5418,5528],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,5119,5182,5324,5418,5544,5670,5765],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5056,5166,5371,5434,5544,5670,5780,5906,6048],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5292,5418,5607,5670,5780,5906,6048,6158,6284],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5513,5670,5891,5985,6095,6237,6379,6495,6615],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5749,5906,6127,6206,6347,6495,6631,6773,6900],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4820,4961,5119,5245,5387,5528,5670,5780,6001,6158,6379,6473,6615,6757,6900,7050,7170],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,4946,5150,5324,5465,5576,5733,5875,6032,6174,6395,6631,6725,6883,7025,7170,7305,7440],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5213,5355,5497,5654,5780,5954,6080,6221,6410,6600,6899,6993,7135,7287,7425,7590,7725],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6647,6810,7166,7261,7410,7560,7718,7860,7980],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6851,7080,7434,7513,7670,7815,7970,8130,8250],
                    [4316,4489,4646,4820,4961,5135,5292,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7056,7230,7655,7785,7920,8085,8235,8415,8505],
                    [4473,4646,4820,4961,5135,5324,5465,5639,5765,5954,6111,6269,6426,6615,6757,6930,7103,7277,7455,7938,8017,8175,8340,8489,8655,8745],
                    [4631,4804,4946,5119,5324,5465,5639,5780,5985,6127,6300,6473,6647,6788,6962,7135,7308,7466,7695,8174,8280,8442,8610,8775,8940,9000],
                    [4725,4946,5135,5261,5465,5639,5812,6001,6158,6332,6505,6678,6820,6993,7166,7340,7513,7733,7920,8442,8537,8694,8865,9025,9195,9255],
                    [4883,5119,5324,5418,5639,5780,5985,6127,6300,6473,6694,6851,7040,7214,7387,7576,7749,7954,8160,8694,8789,8970,9135,9300,9465,9510],
                    [4993,5261,5481,5560,5780,5922,6111,6269,6426,6631,6867,7056,7245,7418,7592,7781,7954,8159,8363,8930,9030,9195,9360,9540,9675,9780],
                    [5135,5402,5654,5717,5985,6158,6347,6495,6647,6851,7088,7261,7434,7607,7796,7985,8159,8363,8615,9214,9308,9482,9645,9825,9990,9990],
                    [5245,5481,5812,5891,6080,6284,6473,6631,6788,7025,7261,7434,7623,7812,8001,8190,8379,8552,8726,9419,9513,9702,9860,10035,10215,10275],
                    [5402,5670,6001,6017,6284,6505,6615,6788,6962,7214,7434,7639,7828,8064,8206,8411,8615,8789,8993,9734,9825,10020,10185,10365,10530,10515],
                    [5513,5859,6111,6206,6395,6694,6851,6993,7135,7387,7592,7796,8017,8237,8426,8615,8789,8993,9180,9938,10049,10238,10411,10584,10785,10740],
                    [5654,6017,6347,6395,6631,6820,7103,7214,7340,7560,7812,7985,8174,8348,8584,8789,8978,9182,9371,10206,10285,10490,10663,10836,11010,11010],
                    [6048,6206,6615,6631,6851,7056,7340,7403,7592,7733,8064,8237,8442,8610,8773,8993,9182,9387,9570,10395,10505,10710,10899,11057,11235,11265],
                    [6552,6395,6851,6820,7025,7308,7592,7623,7844,7970,8316,8489,8694,8867,9056,9277,9450,9655,9840,10584,10679,10931,11088,11261,11450,11520],
                    [7387,6631,7103,6993,7261,7513,7844,7954,8096,8206,8584,8726,8970,9135,9324,9540,9749,9907,10112,10631,10805,11025,11198,11324,11561,11745],
                    [6710,6820,7340,7214,7403,7781,8096,8253,8363,8442,8852,8993,9214,9371,9576,9735,9923,10206,10379,10899,10931,11151,11356,11592,11750,12015]
                ]
            },
            "RS Universal 125": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4741,4851,4961,5072,5182,5324,5418,5528],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,5119,5182,5324,5418,5544,5670,5765],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5056,5166,5371,5434,5544,5670,5780,5906,6048],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5292,5418,5607,5670,5780,5906,6048,6158,6284],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5513,5670,5891,5985,6095,6237,6379,6495,6615],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5749,5906,6127,6206,6347,6495,6631,6773,6900],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4820,4961,5119,5245,5387,5528,5670,5780,6001,6158,6379,6473,6615,6757,6900,7050,7170],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,4946,5150,5324,5465,5576,5733,5875,6032,6174,6395,6631,6725,6883,7025,7170,7305,7440],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5213,5355,5497,5654,5780,5954,6080,6221,6410,6600,6899,6993,7135,7287,7425,7590,7725],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6647,6810,7166,7261,7410,7560,7718,7860,7980],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6851,7080,7434,7513,7670,7815,7970,8130,8250],
                    [4316,4489,4646,4820,4961,5135,5292,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7056,7230,7655,7785,7920,8085,8235,8415,8505],
                    [4473,4646,4820,4961,5135,5324,5465,5639,5765,5954,6111,6269,6426,6615,6757,6930,7103,7277,7455,7938,8017,8175,8340,8489,8655,8745],
                    [4631,4804,4946,5119,5324,5465,5639,5780,5985,6127,6300,6473,6647,6788,6962,7135,7308,7466,7695,8174,8280,8442,8610,8775,8940,9000],
                    [4725,4946,5135,5261,5465,5639,5812,6001,6158,6332,6505,6678,6820,6993,7166,7340,7513,7733,7920,8442,8537,8694,8865,9025,9195,9255],
                    [4883,5119,5324,5418,5639,5780,5985,6127,6300,6473,6694,6851,7040,7214,7387,7576,7749,7954,8160,8694,8789,8970,9135,9300,9465,9510],
                    [4993,5261,5481,5560,5780,5922,6111,6269,6426,6631,6867,7056,7245,7418,7592,7781,7954,8159,8363,8930,9030,9195,9360,9540,9675,9780],
                    [5135,5402,5654,5717,5985,6158,6347,6495,6647,6851,7088,7261,7434,7607,7796,7985,8159,8363,8615,9214,9308,9482,9645,9825,9990,9990],
                    [5245,5481,5812,5891,6080,6284,6473,6631,6788,7025,7261,7434,7623,7812,8001,8190,8379,8552,8726,9419,9513,9702,9860,10035,10215,10275],
                    [5402,5670,6001,6017,6284,6505,6615,6788,6962,7214,7434,7639,7828,8064,8206,8411,8615,8789,8993,9734,9825,10020,10185,10365,10530,10515],
                    [5513,5859,6111,6206,6395,6694,6851,6993,7135,7387,7592,7796,8017,8237,8426,8615,8789,8993,9180,9938,10049,10238,10411,10584,10785,10740],
                    [5654,6017,6347,6395,6631,6820,7103,7214,7340,7560,7812,7985,8174,8348,8584,8789,8978,9182,9371,10206,10285,10490,10663,10836,11010,11010],
                    [6048,6206,6615,6631,6851,7056,7340,7403,7592,7733,8064,8237,8442,8610,8773,8993,9182,9387,9570,10395,10505,10710,10899,11057,11235,11265],
                    [6552,6395,6851,6820,7025,7308,7592,7623,7844,7970,8316,8489,8694,8867,9056,9277,9450,9655,9840,10584,10679,10931,11088,11261,11450,11520],
                    [7387,6631,7103,6993,7261,7513,7844,7954,8096,8206,8584,8726,8970,9135,9324,9540,9749,9907,10112,10631,10805,11025,11198,11324,11561,11745],
                    [6710,6820,7340,7214,7403,7781,8096,8253,8363,8442,8852,8993,9214,9371,9576,9735,9923,10206,10379,10899,10931,11151,11356,11592,11750,12015]
                ]
            },
        };

        // State
        let currentVendor = "screen_2025";
        let currentCalculation = null; // Sparar senaste uträkningen
        let quoteItems = [];
        
        // DOM Elements
        const el = {
            vendorRadios: document.querySelectorAll('input[name="vendor"]'),
            catSelect: document.getElementById('category'),
            prodSelect: document.getElementById('product'),
            wInput: document.getElementById('width'),
            hInput: document.getElementById('height'),
            calcBtn: document.getElementById('calculate-btn'),
            addPanel: document.getElementById('add-panel'),
            displayPrice: document.getElementById('display-price'),
            displayDims: document.getElementById('display-dims'),
            qtyInput: document.getElementById('quantity'),
            addToQuoteBtn: document.getElementById('add-to-quote-btn'),
            quoteContainer: document.getElementById('quote-items'),
            emptyState: document.getElementById('empty-state'),
            totalPrice: document.getElementById('total-price'),
            quoteCount: document.getElementById('quote-count'),
            errorMsg: document.getElementById('error-msg'),
            errorText: document.getElementById('error-text'),
            dimLimits: document.getElementById('dim-limits')
        };

        // --- SETUP ---
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('sv-SE');
        document.getElementById('ref-id').innerText = 'REF-' + Math.floor(1000 + Math.random() * 9000);
        updateCategories();

        // Event Listeners
        el.vendorRadios.forEach(r => r.addEventListener('change', (e) => {
            currentVendor = e.target.value;
            updateCategories();
            resetCalculation();
        }));

        el.catSelect.addEventListener('change', updateProducts);
        
        el.prodSelect.addEventListener('change', () => {
            updateDimLimits();
            resetCalculation();
        });

        el.calcBtn.addEventListener('click', calculatePrice);
        el.addToQuoteBtn.addEventListener('click', addItemToQuote);

        // --- LOGIC ---

        function updateCategories() {
            el.catSelect.innerHTML = '<option value="">-- Välj --</option>';
            el.prodSelect.innerHTML = '<option value="">-- Välj --</option>';
            el.prodSelect.disabled = true;
            el.dimLimits.classList.add('hidden');
            
            const cats = database[currentVendor].categories;
            for(const cat in cats) {
                const opt = document.createElement('option');
                opt.value = cat;
                opt.textContent = cat;
                el.catSelect.appendChild(opt);
            }
        }

        function updateProducts() {
            const cat = el.catSelect.value;
            el.prodSelect.innerHTML = '<option value="">-- Välj --</option>';
            el.dimLimits.classList.add('hidden');
            
            if(cat) {
                el.prodSelect.disabled = false;
                const products = database[currentVendor].categories[cat];
                for(const prod in products) {
                    const opt = document.createElement('option');
                    opt.value = prod;
                    opt.textContent = prod;
                    el.prodSelect.appendChild(opt);
                }
            } else {
                el.prodSelect.disabled = true;
            }
            resetCalculation();
        }

        function updateDimLimits() {
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;
            if(cat && prod) {
                const data = database[currentVendor].categories[cat][prod];
                el.dimLimits.innerText = `Bredd: ${data.range.minW}-${data.range.maxW} cm | Höjd: ${data.range.minH}-${data.range.maxH} cm`;
                el.dimLimits.classList.remove('hidden');
            }
        }

        function resetCalculation() {
            el.addPanel.classList.add('hidden', 'opacity-0', 'translate-y-4');
            el.addPanel.classList.remove('block', 'opacity-100', 'translate-y-0');
            currentCalculation = null;
            el.errorMsg.classList.add('hidden');
        }

        function calculatePrice() {
            resetCalculation();
            const w = parseFloat(el.wInput.value);
            const h = parseFloat(el.hInput.value);
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;

            // Validering
            if (!w || !h || !cat || !prod) {
                showError("Fyll i alla fält.");
                return;
            }

            // Hämta produktdata säkert
            const prodData = database[currentVendor]?.categories?.[cat]?.[prod];
            
            if (!prodData) {
                showError("Kunde inte hitta produktdata.");
                return;
            }

            // Kontrollera måttgränser
            if (w < prodData.range.minW || w > prodData.range.maxW) {
                showError(`Ogiltig bredd. Tillåtet: ${prodData.range.minW} - ${prodData.range.maxW} cm`);
                return;
            }
            if (h < prodData.range.minH || h > prodData.range.maxH) {
                showError(`Ogiltig höjd. Tillåtet: ${prodData.range.minH} - ${prodData.range.maxH} cm`);
                return;
            }

            // BERÄKNING
            let unitPrice = 0;
            let unit = database[currentVendor].unit; // "cm" eller "mm"
            let tableW, tableH;

            // Sjekk om vi har en faktisk matrise for dette produktet
            const matrix = priceMatrices[prod];

            if (matrix) {
                // --- MATRISEOPPSLAG (Alternativ A) ---
                
                // 1. Finn nærmeste bredde (oppover)
                let wIndex = -1;
                // Om enheten är mm men matrisen är i mm, måste vi matcha inmatat cm mot mm-matrisen
                let searchW = (unit === "mm") ? w * 10 : w;
                let searchH = (unit === "mm") ? h * 10 : h;

                for (let i = 0; i < matrix.w.length; i++) {
                    if (matrix.w[i] >= searchW) {
                        wIndex = i;
                        tableW = matrix.w[i];
                        break;
                    }
                }

                // 2. Finn nærmeste høyde (oppover)
                let hIndex = -1;
                for (let i = 0; i < matrix.h.length; i++) {
                    if (matrix.h[i] >= searchH) {
                        hIndex = i;
                        tableH = matrix.h[i];
                        break;
                    }
                }

                if (wIndex === -1 || hIndex === -1) {
                    // Om vi är utanför tabellen men inom max-gränserna, använd sista raden/kolumnen (vanligt i prislistor "eller större")
                     if (searchW > matrix.w[matrix.w.length-1] || searchH > matrix.h[matrix.h.length-1]) {
                        // Specialfall: om dimensionen är större än tabellen men mindre än max
                        // kan vi använda sista värdet om logiken tillåter det, annars felmeddelande
                        // Här väljer vi att visa felmeddelande för säkerhets skull
                        showError("Dimensjonen er utenfor standardtabellen. Kontakt salg.");
                        return;
                     }
                }

                // 3. Hent pris
                if (matrix.prices[hIndex] && matrix.prices[hIndex][wIndex] !== undefined) {
                    unitPrice = matrix.prices[hIndex][wIndex];
                } else {
                    showError("Prisdata mangler for denne kombinasjonen.");
                    return;
                }

            } else {
                // --- FALLBACK FORMEL (Alternativ B) ---
                // Denna kod kommer nu mycket sällan att köras då vi lagt in nästan allt
                
                let stepsW, stepsH;
                if (unit === "mm") {
                    const startW = (prod.includes("C80")) ? 1000 : 700;
                    const wMM = w * 10; 
                    const hMM = h * 10;

                    tableW = Math.max(startW, Math.ceil(wMM / 100) * 100);
                    tableH = Math.max(1000, Math.ceil(hMM / 100) * 100);
                    stepsW = (tableW - startW) / 100;
                    stepsH = (tableH - 1000) / 100;
                } else {
                    const isXL = prod.includes("XL");
                    const startW = isXL ? 610 : 100;
                    const startH = 100;
                    tableW = Math.max(startW, Math.ceil(w / 10) * 10);
                    tableH = Math.max(startH, Math.ceil(h / 10) * 10);
                    stepsW = (tableW - startW) / 10;
                    stepsH = (tableH - startH) / 10;
                }

                if (prod.includes("XL")) {
                     unitPrice = prodData.base + (stepsW * 150) + (stepsH * 100);
                } else {
                    const factor = prodData.factor - 1;
                    unitPrice = prodData.base * (1 + (stepsW * factor) + (stepsH * factor));
                }
            }
            
            unitPrice = Math.round(unitPrice);

            // Spara resultatet i minnet
            currentCalculation = {
                product: prod,
                category: cat,
                vendor: database[currentVendor].name,
                width: w,
                height: h,
                tableW: tableW,
                tableH: tableH,
                unit: unit,
                price: unitPrice
            };

            // Visa i UI
            el.displayPrice.innerText = unitPrice.toLocaleString('no-NO');
            el.displayDims.innerText = `${tableW} x ${tableH} ${unit}`;
            
            // Animera fram panelen
            el.addPanel.classList.remove('hidden');
            setTimeout(() => {
                el.addPanel.classList.remove('opacity-0', 'translate-y-4');
                el.addPanel.classList.add('opacity-100', 'translate-y-0');
            }, 10);
        }

        function addItemToQuote() {
            if (!currentCalculation) return;

            const qty = parseInt(el.qtyInput.value) || 1;
            const totalPrice = currentCalculation.price * qty;

            const item = {
                id: Date.now(), // Unikt ID
                ...currentCalculation,
                qty: qty,
                total: totalPrice
            };

            quoteItems.push(item);
            renderQuote();
            
            // Återställ för nästa inmatning
            resetCalculation();
            el.wInput.value = '';
            el.hInput.value = '';
            el.qtyInput.value = '1';
        }

        function renderQuote() {
            el.quoteContainer.innerHTML = '';
            let grandTotal = 0;

            if (quoteItems.length === 0) {
                el.emptyState.style.display = 'flex';
            } else {
                el.emptyState.style.display = 'none';
                
                quoteItems.forEach(item => {
                    grandTotal += item.total;
                    
                    const row = document.createElement('div');
                    row.className = "grid grid-cols-12 gap-2 px-6 py-3 border-b border-slate-100 items-center hover:bg-slate-50 transition text-sm fade-in";
                    row.innerHTML = `
                        <div class="col-span-5">
                            <p class="font-bold text-slate-800">${item.product}</p>
                            <p class="text-[10px] text-slate-500 uppercase tracking-wide">${item.vendor} • ${item.category}</p>
                        </div>
                        <div class="col-span-2 text-center font-mono text-slate-600">
                            ${item.width} x ${item.height}
                        </div>
                        <div class="col-span-2 text-center">
                            <span class="bg-slate-100 text-slate-700 px-2 py-0.5 rounded text-xs font-bold border border-slate-200">${item.qty}</span>
                        </div>
                        <div class="col-span-2 text-right font-bold text-slate-800">
                            ${item.total.toLocaleString('no-NO')}
                        </div>
                        <div class="col-span-1 text-right no-print">
                            <button onclick="removeItem(${item.id})" class="text-slate-300 hover:text-red-500 transition p-1">
                                <i class="fa-solid fa-xmark"></i>
                            </button>
                        </div>
                    `;
                    el.quoteContainer.appendChild(row);
                });
            }

            el.totalPrice.innerText = grandTotal.toLocaleString('no-NO') + " NOK";
            el.quoteCount.innerText = `${quoteItems.length} artiklar`;
        }

        function removeItem(id) {
            quoteItems = quoteItems.filter(item => item.id !== id);
            renderQuote();
        }

        function clearQuote() {
            if(quoteItems.length > 0 && confirm("Rensa hela offerten?")) {
                quoteItems = [];
                renderQuote();
            }
        }

        function changeQty(delta) {
            let val = parseInt(el.qtyInput.value) || 1;
            val += delta;
            if(val < 1) val = 1;
            el.qtyInput.value = val;
        }

        function showError(msg) {
            el.errorText.textContent = msg;
            el.errorMsg.classList.remove('hidden');
            setTimeout(() => el.errorMsg.classList.add('hidden'), 4000);
        }

        // --- AI Logic ---
        const aiInput = document.getElementById('ai-input');
        const aiResponse = document.getElementById('ai-response');

        window.fillPrompt = (txt) => {
            aiInput.value = txt;
        };

        async function handleChat() {
            const txt = aiInput.value.trim().toLowerCase();
            if (!txt) return;

            aiResponse.innerHTML = '<i class="fa-solid fa-spinner fa-spin text-indigo-500"></i> Tänker...';
            aiResponse.classList.remove('hidden');

            setTimeout(() => {
                let ans = "Jag är inte säker. Försök fråga om en specifik modell.";
                
                if(txt.includes("xl")) ans = "<strong>RS Smart 130 XL</strong> är för stora bredder (upp till 600 cm). Den kräver oftast motorstyrning på minst 20 Nm pga vikten.";
                else if(txt.includes("zip")) ans = "<strong>Mini ZIP</strong> är mycket vindtålig tack vare låsning i sidoskenorna. Kassetten är endast 75mm hög.";
                else if(txt.includes("c80")) ans = "<strong>C80</strong> (Neva) är en robust utv. persienn med falsade lameller för extra stabilitet i vind.";
                else if(txt.includes("universal")) ans = "<strong>RS Universal</strong> har unika tvådelade styrskenor (UTG) som döljer infästningen, perfekt för nischer.";
                
                aiResponse.innerHTML = ans;
            }, 600);
        }
    </script>
</body>
</html>
