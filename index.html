<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prima Sol - Tilbudsverktøy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Animationer */
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }

        /* Utskriftsanpassning */
        @media print {
            body { background: white; }
            #view-calculator { display: block; }
            #config-panel, #ai-panel, #header-controls, #main-nav, .no-print { display: none !important; }
            #quote-section { width: 100%; border: none; shadow: none; }
            #quote-items, #accessories-container { overflow: visible; height: auto; }
            header { border-bottom: 2px solid #000; margin-bottom: 20px; }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col text-slate-800">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm">
        <div class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <div class="flex items-center gap-6">
                <!-- KUNDLOGGA -->
                <div class="h-12 w-auto">
                    <img src="https://raw.githubusercontent.com/GusHem/Primasol/refs/heads/main/Prima%20Sol%20As%20Logga%202.svg" alt="Prima Sol As" class="h-full object-contain">
                </div>
                <div class="h-8 w-px bg-slate-200 hidden md:block"></div>
                <div>
                    <h1 class="text-sm font-bold text-slate-900 uppercase tracking-wider">Tilbudsverktøy</h1>
                    <p class="text-xs text-slate-500">Neva & Screen Prislister</p>
                </div>
            </div>

            <!-- NY NAVIGASJON (MENY) -->
            <nav id="main-nav" class="hidden md:flex items-center gap-1 bg-slate-100 p-1 rounded-lg border border-slate-200">
                <button onclick="switchView('dashboard')" id="nav-dashboard" class="px-4 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-white transition flex items-center gap-2">
                    <i class="fa-solid fa-list-ul"></i> Oversikt
                </button>
                <button onclick="switchView('calculator')" id="nav-calculator" class="px-4 py-2 rounded-md text-sm font-medium bg-white text-blue-700 shadow-sm flex items-center gap-2">
                    <i class="fa-solid fa-plus-circle"></i> Nytt Tilbud
                </button>
            </nav>
            
            <div id="header-controls" class="flex items-center gap-4">
                <div class="text-right hidden sm:block">
                    <p class="text-xs text-slate-400">Logget inn</p>
                    <p class="text-sm font-medium text-slate-700">Selger</p>
                </div>
                <div class="bg-slate-100 p-2 rounded-full text-slate-500 border border-slate-200">
                    <i class="fa-solid fa-user"></i>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-6 flex-grow w-full">
        
        <!-- VIEW 1: DASHBOARD / OVERSIKT -->
        <div id="view-dashboard" class="hidden h-full fade-in">
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <div class="p-6 border-b border-slate-200 flex justify-between items-center bg-slate-50">
                    <div>
                        <h2 class="text-lg font-bold text-slate-800">Mine Tilbud</h2>
                        <p class="text-sm text-slate-500">Oversikt over aktive og arkiverte tilbud</p>
                    </div>
                    <div class="flex gap-3">
                        <div class="relative">
                            <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"></i>
                            <input type="text" placeholder="Søk etter kunde eller ref..." class="pl-9 pr-4 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none">
                        </div>
                        <button onclick="switchView('calculator')" class="bg-slate-900 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-slate-800 transition shadow-sm flex items-center gap-2">
                            <i class="fa-solid fa-plus"></i> Opprett Nytt
                        </button>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-slate-50 text-slate-500 font-medium uppercase text-xs border-b border-slate-200">
                            <tr>
                                <th class="px-6 py-4">Ref #</th>
                                <th class="px-6 py-4">Kunde</th>
                                <th class="px-6 py-4">Dato</th>
                                <th class="px-6 py-4">Status</th>
                                <th class="px-6 py-4 text-right">Beløp (Eks. MVA)</th>
                                <th class="px-6 py-4 text-center">Handling</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100 text-slate-700">
                            <!-- Mock Data Row 1 -->
                            <tr class="hover:bg-slate-50 transition group cursor-pointer">
                                <td class="px-6 py-4 font-mono text-slate-500">REF-83921</td>
                                <td class="px-6 py-4 font-medium">Ola Nordmann<div class="text-xs text-slate-400 font-normal">Oslo</div></td>
                                <td class="px-6 py-4">19.11.2025</td>
                                <td class="px-6 py-4"><span class="bg-green-100 text-green-700 px-2.5 py-1 rounded-full text-[10px] font-bold border border-green-200 uppercase tracking-wide">Akseptert</span></td>
                                <td class="px-6 py-4 text-right font-bold text-slate-900">42 500 NOK</td>
                                <td class="px-6 py-4 text-center">
                                    <button class="text-slate-400 hover:text-blue-600 transition bg-white border border-slate-200 rounded p-2 shadow-sm"><i class="fa-solid fa-eye"></i></button>
                                </td>
                            </tr>
                            <!-- Mock Data Row 2 -->
                            <tr class="hover:bg-slate-50 transition group cursor-pointer">
                                <td class="px-6 py-4 font-mono text-slate-500">REF-77210</td>
                                <td class="px-6 py-4 font-medium">Kari Hansen<div class="text-xs text-slate-400 font-normal">Bergen</div></td>
                                <td class="px-6 py-4">18.11.2025</td>
                                <td class="px-6 py-4"><span class="bg-blue-50 text-blue-600 px-2.5 py-1 rounded-full text-[10px] font-bold border border-blue-100 uppercase tracking-wide">Sendt</span></td>
                                <td class="px-6 py-4 text-right font-bold text-slate-900">15 200 NOK</td>
                                <td class="px-6 py-4 text-center">
                                    <button class="text-slate-400 hover:text-blue-600 transition bg-white border border-slate-200 rounded p-2 shadow-sm"><i class="fa-solid fa-eye"></i></button>
                                </td>
                            </tr>
                             <!-- Mock Data Row 3 -->
                             <tr class="hover:bg-slate-50 transition group cursor-pointer">
                                <td class="px-6 py-4 font-mono text-slate-500">REF-12094</td>
                                <td class="px-6 py-4 font-medium">Peder Ås<div class="text-xs text-slate-400 font-normal">Drammen</div></td>
                                <td class="px-6 py-4">15.11.2025</td>
                                <td class="px-6 py-4"><span class="bg-slate-100 text-slate-500 px-2.5 py-1 rounded-full text-[10px] font-bold border border-slate-200 uppercase tracking-wide">Utkast</span></td>
                                <td class="px-6 py-4 text-right font-bold text-slate-900">8 900 NOK</td>
                                <td class="px-6 py-4 text-center">
                                    <button onclick="switchView('calculator')" class="text-slate-400 hover:text-blue-600 transition bg-white border border-slate-200 rounded p-2 shadow-sm"><i class="fa-solid fa-pen"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="p-4 border-t border-slate-200 bg-slate-50 text-center">
                    <button class="text-xs text-slate-500 hover:text-slate-800 font-medium uppercase tracking-wide">Vis alle tilbud (14)</button>
                </div>
            </div>
        </div>

        <!-- VIEW 2: CALCULATOR (TIDLIGERE MAIN LAYOUT) -->
        <div id="view-calculator" class="grid grid-cols-1 lg:grid-cols-12 gap-8 h-[calc(100vh-8rem)]">

            <!-- VÄNSTER: Konfigurator (5 kolumner) -->
            <div id="config-panel" class="lg:col-span-5 flex flex-col gap-6 overflow-y-auto custom-scroll pr-2 pb-10">
                
                <!-- 1. Produktval -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="bg-slate-800 px-5 py-3 flex justify-between items-center">
                        <h2 class="text-white font-semibold text-sm flex items-center gap-2">
                            <i class="fa-solid fa-gear"></i> 1. Konfigurer Produkt
                        </h2>
                    </div>
                    
                    <div class="p-5 space-y-5">
                        
                        <!-- Katalog -->
                        <div>
                            <label class="text-xs font-bold text-slate-500 uppercase mb-2 block">Katalog</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="vendor" value="screen_2025" class="peer sr-only" checked>
                                    <div class="py-2.5 px-3 text-center rounded-lg border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 peer-checked:bg-blue-50 peer-checked:border-blue-600 peer-checked:text-blue-700 peer-checked:shadow-sm transition-all">
                                        Hansen Screen
                                    </div>
                                </label>
                                <label class="cursor-pointer relative">
                                    <input type="radio" name="vendor" value="neva_2023" class="peer sr-only">
                                    <div class="py-2.5 px-3 text-center rounded-lg border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 peer-checked:bg-orange-50 peer-checked:border-orange-600 peer-checked:text-orange-700 peer-checked:shadow-sm transition-all">
                                        Neva Persienner
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Dropdowns -->
                        <div class="grid grid-cols-1 gap-4">
                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Produktfamilie</label>
                                <div class="relative">
                                    <select id="category" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer appearance-none">
                                        <!-- JS fyller -->
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-chevron-down text-xs"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Modell</label>
                                <div class="relative">
                                    <select id="product" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer disabled:opacity-50 disabled:bg-slate-100" disabled>
                                        <option>-- Velg familie --</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-chevron-down text-xs"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mått -->
                        <div class="bg-blue-50 rounded-lg border border-blue-100 p-4 relative">
                            <div class="flex justify-between mb-2">
                                <label class="text-xs font-bold text-blue-800 uppercase">Dimensjoner (cm)</label>
                                <span id="dim-limits" class="text-[10px] text-blue-600 bg-white px-2 rounded-full border border-blue-200 hidden"></span>
                            </div>
                            
                            <!-- Mått Feedback -->
                            <div id="dim-visual-q" class="hidden rounded px-3 py-2 flex items-center gap-2 text-xs transition-colors mb-3">
                                <span id="dim-text"></span>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div class="relative">
                                    <span class="absolute left-3 top-2.5 text-blue-400 text-xs font-bold">B</span>
                                    <input type="number" id="width" class="w-full pl-8 p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-500 outline-none font-mono font-bold text-slate-700" placeholder="Bredde">
                                </div>
                                <div class="relative">
                                    <span class="absolute left-3 top-2.5 text-blue-400 text-xs font-bold">H</span>
                                    <input type="number" id="height" class="w-full pl-8 p-2 border border-blue-200 rounded-md focus:ring-2 focus:ring-blue-500 outline-none font-mono font-bold text-slate-700" placeholder="Høyde">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tillval (Kassett, Motor & Färg) -->
                        <div class="grid grid-cols-1 gap-4 pt-2 border-t border-slate-100">
                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Kassett / System</label>
                                <div class="relative">
                                    <select id="box-shape" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer" disabled>
                                        <option value="">-- Velg modell først --</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-box-archive text-xs"></i>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Motor / Betjening</label>
                                <div class="relative">
                                    <select id="motor" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer">
                                        <!-- Fylls av JS -->
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-bolt text-xs"></i>
                                    </div>
                                </div>
                            </div>
                             <div>
                                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Profilfarge</label>
                                <div class="relative">
                                    <select id="color" class="w-full p-2.5 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition cursor-pointer">
                                        <!-- Fylls av JS -->
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-slate-500">
                                        <i class="fa-solid fa-palette text-xs"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- BERÄKNA KNAPP -->
                        <button id="calculate-btn" class="w-full bg-slate-800 text-white hover:bg-slate-900 font-bold py-3 px-4 rounded-lg shadow-md transition flex items-center justify-center gap-2 mt-2">
                            <i class="fa-solid fa-calculator"></i> Beregn Pris
                        </button>
                        
                        <div id="error-msg" class="hidden text-xs text-red-600 font-medium bg-red-50 p-3 rounded-lg border border-red-100 flex items-center gap-2">
                            <i class="fa-solid fa-triangle-exclamation"></i> <span id="error-text"></span>
                        </div>

                    </div>
                </div>

                <!-- 2. RESULTAT & LÄGG TILL -->
                <div id="result-panel" class="bg-white rounded-xl shadow-md border border-green-200 z-10 hidden transition-all duration-500 transform translate-y-4 opacity-0">
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-5 border-b border-green-100">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-xs text-green-700 font-bold uppercase tracking-wide">Stykkpris</p>
                                <div class="flex flex-col">
                                    <div class="flex items-baseline gap-1">
                                        <span id="res-price-net" class="text-3xl font-black text-slate-900">0</span>
                                        <span class="text-sm font-bold text-slate-500">NOK</span>
                                    </div>
                                    <span class="text-[10px] text-slate-400 line-through" id="res-price-gross"></span>
                                </div>
                            </div>
                            <div class="text-right text-xs text-slate-500">
                                <p id="res-dims" class="font-mono font-bold">--</p>
                                <p id="res-details" class="italic text-[10px] mt-1 text-slate-400">Inkl. motorvalg</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-5 bg-white space-y-4 relative z-20 pointer-events-auto">
                        <!-- Rabatt -->
                        <div>
                            <label class="text-xs font-bold text-slate-500 uppercase mb-1 block">Rabatt (%)</label>
                            <input type="number" id="res-discount" class="w-full p-2 border border-slate-200 rounded text-sm" placeholder="0">
                        </div>

                        <div class="flex items-end gap-4">
                            <div class="flex-1">
                                <label class="text-xs font-bold text-slate-500 uppercase mb-1 block">Antall</label>
                                <div class="flex items-center h-10">
                                    <button onclick="changeQty(-1)" class="h-full px-3 bg-slate-100 border border-r-0 border-slate-300 rounded-l hover:bg-slate-200 text-slate-600 font-bold">-</button>
                                    <input type="number" id="res-qty" value="1" min="1" class="h-full w-full border-y border-slate-300 outline-none text-center font-bold text-slate-800">
                                    <button onclick="changeQty(1)" class="h-full px-3 bg-slate-100 border border-l-0 border-slate-300 rounded-r hover:bg-slate-200 text-slate-600 font-bold">+</button>
                                </div>
                            </div>
                            <button id="add-to-quote-btn" class="flex-[2] h-10 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md shadow-green-200 transition flex items-center justify-center gap-2">
                                <i class="fa-solid fa-cart-plus"></i> Legg til
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 3. TILLBEHÖR & TJÄNSTER -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4">
                     <div class="flex items-center gap-2 mb-3">
                        <i class="fa-solid fa-screwdriver-wrench text-slate-400"></i>
                        <h3 class="font-bold text-xs uppercase text-slate-600">Tilbehør & Tjenester</h3>
                    </div>
                    
                    <!-- Accessories -->
                    <div class="grid grid-cols-1 gap-2 mb-4">
                        <select id="acc-cat" class="w-full p-2 border border-slate-200 bg-slate-50 rounded text-xs">
                             <option value="">-- Velg kategori --</option>
                             <option value="faher_remote_uni">Faher Fjernkontroll (Uni-Directional)</option>
                             <option value="faher_remote_bi">Faher Fjernkontroll (Bi-Directional)</option>
                             <option value="faher_veggbrytere">Faher Veggbrytere</option>
                             <option value="somfy_remote_rts">Somfy RTS Fjernkontroll</option>
                             <option value="somfy_remote_io">Somfy io Fjernkontroll</option>
                             <option value="somfy_veggbrytere">Somfy Veggbrytere</option>
                             <option value="sensorer">Sol/Vind/Temperatur Sensorer</option>
                             <option value="smart_hubs">Smart Home Hubs</option>
                             <option value="kablar_tillbehor">Kabler & Tilbehør</option>
                             <option value="services">Tjenester (Montering/Frakt)</option>
                        </select>
                        <div class="flex gap-2">
                            <select id="acc-item" class="flex-1 p-2 border border-slate-200 bg-slate-50 rounded text-xs" disabled>
                                <option>-- Velg --</option>
                            </select>
                            <input type="number" id="acc-qty" value="1" class="w-12 p-2 border border-slate-200 rounded text-center text-xs font-bold">
                        </div>
                        <button onclick="addAccessory()" class="w-full bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold py-2 rounded text-xs transition">
                            + Legg til Tilbehør
                        </button>
                    </div>

                    <!-- Services -->
                    <div class="border-t border-slate-100 pt-3">
                        <div class="flex gap-2 mb-2">
                            <select id="service-type" class="flex-1 p-2 border border-slate-200 bg-slate-50 rounded text-xs">
                                <option>Montering (timer)</option>
                                <option>Frakt (fast pris)</option>
                                <option>Kranbil (timer)</option>
                                <option>Annet</option>
                            </select>
                            <input type="number" id="service-price" placeholder="Pris/stk" class="w-20 p-2 border border-slate-200 rounded text-xs">
                        </div>
                        <button onclick="addService()" class="w-full bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold py-2 rounded text-xs transition">
                            + Legg til Tjeneste
                        </button>
                    </div>
                </div>

            </div>

            <!-- HÖGER: Offertöversikt + AI Assistent -->
            <div class="lg:col-span-7 flex flex-col gap-6 h-[calc(100vh-8rem)] overflow-y-auto custom-scroll pb-10">
                
                <!-- OFFERT SEKTION -->
                <div id="quote-section" class="bg-white rounded-2xl shadow-sm border border-slate-200 flex flex-col min-h-[500px]">
                    
                    <!-- Quote Header -->
                    <div class="px-6 py-4 border-b border-slate-200 bg-slate-50/80 rounded-t-2xl flex justify-between items-center">
                        <div>
                            <h2 class="font-bold text-slate-800 text-lg flex items-center gap-2">
                                <i class="fa-solid fa-file-invoice text-slate-400"></i> Aktuelt Tilbud
                            </h2>
                            <div class="text-[10px] text-slate-500 mt-1 flex gap-3">
                                <span>Dato: <span id="current-date" class="font-medium text-slate-700"></span></span>
                                <span class="w-px h-3 bg-slate-300"></span>
                                <span>Ref: <span id="ref-id" class="font-medium text-slate-700"></span></span>
                            </div>
                        </div>
                        <span id="quote-count" class="bg-slate-200 text-slate-600 text-xs font-bold px-2 py-1 rounded-full">0 artikler</span>
                    </div>

                    <!-- Table Header -->
                    <div class="grid grid-cols-12 gap-2 px-6 py-2 bg-slate-100 text-[10px] font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200">
                        <div class="col-span-5">Produktbeskrivelse</div>
                        <div class="col-span-2 text-center">Mål (cm)</div>
                        <div class="col-span-2 text-center">Antall</div>
                        <div class="col-span-2 text-right">Beløp</div>
                        <div class="col-span-1"></div>
                    </div>

                    <!-- Quote Items (Products) -->
                    <div id="quote-items" class="flex-1 overflow-y-auto custom-scroll p-2 space-y-1 bg-white min-h-[300px]">
                        <!-- Empty State -->
                        <div id="empty-state" class="flex flex-col items-center justify-center h-full text-slate-300 py-10">
                            <i class="fa-solid fa-cart-arrow-down text-5xl mb-3 opacity-20"></i>
                            <p class="text-sm font-medium">Listen er tom</p>
                            <p class="text-xs">Gjør en beregning til venstre for å starte</p>
                        </div>
                    </div>
                    
                    <!-- Accessories List Container -->
                    <div id="accessory-section" class="hidden border-t border-slate-100 bg-slate-50/50">
                        <div class="px-6 py-2 text-[10px] font-bold text-slate-400 uppercase">Tilbehør & Tjenester</div>
                        <div id="accessories-container" class="space-y-1 pb-2"></div>
                    </div>

                    <!-- Quote Footer -->
                    <div class="p-6 bg-slate-50 border-t border-slate-200 rounded-b-2xl">
                        <div class="flex flex-col items-end gap-1 mb-6">
                            <div class="text-sm text-slate-500 font-medium">Totalt Netto (Ekskl. MVA)</div>
                            <div class="text-4xl font-black text-slate-900 tracking-tight" id="total-price">0 NOK</div>
                        </div>
                        
                        <div class="flex gap-3 justify-end no-print">
                            <button onclick="clearQuote()" class="px-4 py-2.5 text-sm text-red-600 font-semibold hover:bg-red-50 rounded-lg transition">
                                Nullstill
                            </button>
                            <button onclick="window.print()" class="px-6 py-2.5 bg-slate-900 text-white text-sm font-bold rounded-lg hover:bg-slate-800 transition shadow-lg flex items-center gap-2">
                                <i class="fa-solid fa-print"></i> Eksporter PDF / Skriv ut
                            </button>
                        </div>
                    </div>

                </div>

                <!-- AI Panel (Flyttad hit) -->
                <div id="ai-panel" class="bg-indigo-50 rounded-xl border border-indigo-100 p-5 flex items-start gap-4 shadow-sm">
                    <div class="bg-white p-3 rounded-full text-indigo-600 shadow-sm flex-shrink-0">
                        <i class="fa-solid fa-robot text-xl"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <h3 class="text-sm font-bold text-indigo-900">Produktassistent</h3>
                        <p class="text-xs text-indigo-700 mb-3">Spør meg om tekniske detaljer, maksbredder eller motoralternativer.</p>
                        <div class="flex gap-2">
                            <input type="text" id="ai-input" class="w-full text-sm p-2.5 rounded-lg border border-indigo-200 focus:ring-2 focus:ring-indigo-500 outline-none bg-white" placeholder="Eks: Hva er maks bredde på RS Smart XL?">
                            <button onclick="handleChat()" class="bg-indigo-600 text-white px-5 py-2.5 rounded-lg text-sm font-bold hover:bg-indigo-700 transition shadow-sm">Spør</button>
                        </div>
                        <div id="ai-response" class="hidden mt-3 text-sm text-slate-700 bg-white p-3 rounded-lg border border-indigo-100 shadow-sm leading-relaxed"></div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        // --- VIEW SWITCHING LOGIC ---
        function switchView(viewName) {
            const dash = document.getElementById('view-dashboard');
            const calc = document.getElementById('view-calculator');
            const btnDash = document.getElementById('nav-dashboard');
            const btnCalc = document.getElementById('nav-calculator');
            
            if (viewName === 'dashboard') {
                dash.classList.remove('hidden');
                calc.classList.add('hidden');
                
                // Active State Dashboard
                btnDash.className = "px-4 py-2 rounded-md text-sm font-medium bg-white text-blue-700 shadow-sm flex items-center gap-2 transition-all";
                btnCalc.className = "px-4 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-white transition flex items-center gap-2";
            } else {
                dash.classList.add('hidden');
                calc.classList.remove('hidden');
                
                // Active State Calculator
                btnCalc.className = "px-4 py-2 rounded-md text-sm font-medium bg-white text-blue-700 shadow-sm flex items-center gap-2 transition-all";
                btnDash.className = "px-4 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-slate-900 hover:bg-white transition flex items-center gap-2";
            }
        }

        // --- DATABAS ---
        const database = {
            "screen_2025": {
                "name": "Hansen Screen",
                "unit": "cm",
                "currency": "NOK",
                "motors": [
                    { name: "Ingen motor (Kun duk/kassett)", price: 0 },
                    { name: "Faher Radio (Standard)", price: 1495 },
                    { name: "Somfy IO (Standard)", price: 2598 },
                    { name: "Somfy IO (Maestria+ 50)", price: 3064 },
                    { name: "Somfy Solar IO (Innebygd batteri)", price: 3413 },
                    { name: "Elero RolSolar", price: 2760 }
                ],
                "colors": [
                    { name: "Standard RAL (9010, 7016, etc)", surcharge: 0 },
                    { name: "Annen RAL (+15%)", surcharge: 0.15 },
                    { name: "Strukturlakk (+20%)", surcharge: 0.20 }
                ],
                "categories": {
                    "RS Classic": {
                        "RS Classic 75": { base: 2154, stepW: 100, stepH: 100, factor: 1.04, range: {minW: 60, maxW: 230, minH: 60, maxH: 170} },
                        "RS Classic 85": { base: 2213, stepW: 100, stepH: 100, factor: 1.04, range: {minW: 60, maxW: 300, minH: 60, maxH: 320} },
                        "RS Classic 95": { base: 2301, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 350, minH: 60, maxH: 350} },
                        "RS Classic 105": { base: 2550, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 70, maxW: 400, minH: 60, maxH: 350} },
                        "RS Classic 120": { base: 2693, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} },
                        "RS Classic 125": { base: 2693, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} }
                    },
                    "Mini ZIP": {
                        "Mini ZIP": { base: 2482, stepW: 100, stepH: 100, factor: 1.035, range: {minW: 60, maxW: 340, minH: 60, maxH: 170} }
                    },
                    "RS Universal": {
                        "RS Universal 85": { base: 2475, stepW: 100, stepH: 100, factor: 1.045, range: {minW: 60, maxW: 200, minH: 60, maxH: 200} },
                        "RS Universal 95": { base: 2535, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 350, minH: 60, maxH: 350} },
                        "RS Universal 105": { base: 2715, stepW: 100, stepH: 100, factor: 1.055, range: {minW: 70, maxW: 400, minH: 60, maxH: 350} },
                        "RS Universal 120": { base: 2790, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} },
                        "RS Universal 125": { base: 2790, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 350} }
                    },
                    "RS Smart": {
                        "RS Smart 85": { base: 2715, stepW: 100, stepH: 100, factor: 1.05, range: {minW: 60, maxW: 300, minH: 60, maxH: 200} },
                        "RS Smart 100": { base: 3030, stepW: 100, stepH: 100, factor: 1.055, range: {minW: 70, maxW: 400, minH: 60, maxH: 350} },
                        "RS Smart 130": { base: 3480, stepW: 100, stepH: 100, factor: 1.06, range: {minW: 80, maxW: 350, minH: 80, maxH: 500} },
                        "RS Smart 130 XL": { base: 14448, stepW: 610, stepH: 100, factor: 1.015, range: {minW: 610, maxW: 700, minH: 100, maxH: 300} }
                    }
                }
            },
            "neva_2023": {
                "name": "Neva Utvendig",
                "unit": "mm", 
                "currency": "NOK",
                "motors": [
                    { name: "Standard Motor (Inkludert)", price: 0 },
                    { name: "Somfy IO Protect (+tillegg)", price: 1100 },
                    { name: "Elero Comfort (+tillegg)", price: 1100 },
                    { name: "Geiger AIR (+tillegg)", price: 1600 }
                ],
                "colors": [
                    { name: "Standard RAL", surcharge: 0 },
                    { name: "Spesialfarge (på forespørsel)", surcharge: 0.25 }
                ],
                "categories": {
                    "Utvendige Persienner": {
                        "C80 / F80": { base: 2410, stepW: 700, stepH: 700, factor: 1.04, range: {minW: 60, maxW: 500, minH: 60, maxH: 500} },
                    }
                }
            }
        };

        // --- TILLBEHÖRS-DATABAS (Ny) ---
        const accessoriesDb = {
            "faher_remote_uni": [
                { id: "dc250", name: "DC 250 (1-kanal, Hvit)", price: 221 },
                { id: "dc251", name: "DC 251 (5-kanal, Hvit)", price: 280 },
                { id: "dc262", name: "DC 262 (15-kanal, Hvit)", price: 400 },
                { id: "dc356", name: "DC 356 (9-kanal)", price: 521 },
                { id: "dc921", name: "DC 921 (5-kanal + timer)", price: 560 },
                { id: "dc308", name: "DC 308 (15-kanal + timer)", price: 660 },
                { id: "dc305w", name: "DC 305 (1-kanal, Hvit)", price: 381 },
                { id: "dc305b", name: "DC 305 (1-kanal, Svart)", price: 400 },
                { id: "dc306w", name: "DC 306 (5-kanal, Hvit)", price: 440 },
                { id: "dc306b", name: "DC 306 (5-kanal, Svart)", price: 461 },
                { id: "dc313w", name: "DC 313 (15-kanal, Hvit)", price: 475 },
                { id: "dc313b", name: "DC 313 (15-kanal, Svart)", price: 580 }
            ],
            "faher_remote_bi": [
                { id: "dd250h", name: "Faher DD 250H (1-kanal Bi, Hvit)", price: 260 },
                { id: "dd251h", name: "Faher DD 251H (5-kanal Bi, Hvit)", price: 280 },
                { id: "dd2700h", name: "Faher DD 2700H (5-kanal timer)", price: 341 },
                { id: "dd2702h", name: "Faher DD 2702H (5-kanal timer)", price: 368 },
                { id: "dd2705h", name: "Faher DD 2705H (15-kanal)", price: 345 },
                { id: "dd1805h", name: "Faher DD 1805H (15-kanal LCD)", price: 485 },
                { id: "dd2770h", name: "Faher DD 2770H (1-kanal)", price: 341 },
                { id: "dd2773h", name: "Faher DD 2773H (15-kanal)", price: 378 }
            ],
            "faher_veggbrytere": [
                { id: "dc315", name: "Faher DC 315 (1-kanal vegg)", price: 341 },
                { id: "dc316", name: "Faher DC 316 (2-kanal vegg)", price: 400 },
                { id: "dc317", name: "Faher DC 317 (5-kanal vegg)", price: 560 },
                { id: "dc409", name: "Faher DC 409 (15-kanal vegg)", price: 602 },
                { id: "dc229a", name: "Faher DC 229A (1-kanal vegg)", price: 341 },
                { id: "dc230a", name: "Faher DC 230A (2-kanal vegg)", price: 400 },
                { id: "dc559", name: "Faher DC 559 (1-kanal vegg)", price: 447 },
                { id: "dc660", name: "Faher DC 660 (2-kanal vegg)", price: 521 },
                { id: "dc661", name: "Faher DC 661 (5-kanal vegg)", price: 602 }
            ],
            "somfy_remote_rts": [
                { id: "situo1_rts_pure", name: "Situo 1 RTS Pure II", price: 596 },
                { id: "situo5_rts_pure", name: "Situo 5 RTS Pure II", price: 760 },
                { id: "situo1_soliris_rts", name: "Situo 1 Soliris RTS Pure II", price: 910 },
                { id: "situo1_var_rts", name: "Situo 1 Var RTS Pure II (Scroll)", price: 1075 },
                { id: "situo5_var_rts", name: "Situo 5 Var RTS Pure II (Scroll)", price: 1441 },
                { id: "telis1_rts_patio", name: "Telis 1 RTS Patio (Vanntett)", price: 706 },
                { id: "telis16_rts_pure", name: "Telis 16 RTS Pure (16-kanal)", price: 2250 },
                { id: "telis6_chronis_rts", name: "Telis 6 Chronis RTS (Timer)", price: 2871 }
            ],
            "somfy_remote_io": [
                { id: "situo1_io_pure", name: "Situo 1 io Pure II", price: 781 },
                { id: "situo1_io_iron", name: "Situo 1 io Iron II", price: 781 },
                { id: "situo5_io_pure", name: "Situo 5 io Pure II", price: 1220 },
                { id: "situo5_io_iron", name: "Situo 5 io Iron II", price: 1238 },
                { id: "situo1_var_io", name: "Situo 1 Var io Pure II (Scroll)", price: 2037 },
                { id: "nina_timer_io", name: "Nina Timer io (Touch)", price: 3064 }
            ],
            "somfy_veggbrytere": [
                 { id: "smoove_origin_rts", name: "Smoove Origin RTS", price: 513 },
                 { id: "smoove_rts_pure", name: "Smoove RTS Pure (Touch)", price: 719 },
                 { id: "smoove_rts_black", name: "Smoove RTS Black (Touch)", price: 719 },
                 { id: "smoove_rts_silver", name: "Smoove RTS Silver (Touch)", price: 719 },
                 { id: "smoove_origin_io", name: "Smoove Origin io", price: 741 },
                 { id: "smoove_1_io_pure", name: "Smoove 1 io Pure (Touch)", price: 719 },
                 { id: "smoove_1_io_black", name: "Smoove 1 io Black (Touch)", price: 741 }
            ],
            "sensorer": [
                { id: "dc116", name: "Faher DC 116 (Sol/Vind)", price: 700 },
                { id: "dc1187", name: "Faher DC 1187 (Sol/Vind m/automatikk)", price: 700 },
                { id: "eolis_rts", name: "Somfy Eolis Sensor RTS (Vind)", price: 1164 },
                { id: "soliris_rts", name: "Somfy Soliris Sensor RTS (Sol/Vind)", price: 1431 },
                { id: "sunis_rts", name: "Somfy Sunis WireFree RTS (Sol)", price: 1229 },
                { id: "sunis_io", name: "Somfy Sunis WireFree II io (Sol)", price: 1513 },
                { id: "eolis_io", name: "Somfy Eolis WireFree io (Vind)", price: 1962 }
            ],
            "smart_hubs": [
                { id: "dd1554", name: "Faher Mini Bridge Wi-Fi Hub", price: 1103 },
                { id: "dd7006", name: "Faher P-Box Hub (Control4/Crestron)", price: 2140 },
                { id: "tahoma_switch", name: "Somfy TaHoma Switch Pro", price: 2990 },
                { id: "connexoon_io", name: "Somfy Connexoon BOX io", price: 2176 },
                { id: "tahoma_dock", name: "Somfy TaHoma Serenity Dock", price: 3688 }
            ],
            "kablar_tillbehor": [
                { id: "cable_somfy_90cm", name: "Somfy kabel 90cm m/STAS3", price: 300 },
                { id: "cable_somfy_3m", name: "Somfy kabel 3m u/STAS3", price: 400 },
                { id: "cable_somfy_10m", name: "Somfy forlengelseskabel 10m", price: 550 },
                { id: "hirschmann_stak3", name: "Hirschmann STAK 3 (Hunn)", price: 65 },
                { id: "hirschmann_stas3", name: "Hirschmann STAS 3 (Hann)", price: 65 }
            ],
            "services": [
                { id: "montering_time", name: "Montering (per time)", price: 950 },
                { id: "frakt_std", name: "Frakt (Standard)", price: 500 },
                { id: "frakt_exp", name: "Frakt (Ekspress)", price: 1200 },
                { id: "kranbil", name: "Kranbil (per time)", price: 1800 },
                { id: "oppmaling", name: "Oppmåling / Befaring", price: 750 }
            ]
        };

        // --- MATRISDATA (ALLA PRODUKTER) ---
        const priceMatrices = {
            // RS Smart 100 (Tidigare inlagd)
            "RS Smart 100": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [3030,3165,3330,3495,3675,3825,4020,4170,4350,4485,4650,4800,4980,5130,5295,5460,5610,5775,5925,6090,6255,6420,6585,6750,6930,7095,7245,7410,7560,7740,7890],
                    [3150,3315,3495,3675,3825,4005,4170,4350,4485,4650,4815,4995,5145,5340,5490,5670,5820,6015,6150,6315,6495,6645,6810,6975,7170,7320,7485,7635,7830,7980,8145],
                    [3300,3465,3660,3810,4005,4140,4350,4485,4680,4815,5025,5160,5355,5505,5700,5865,6045,6195,6390,6540,6720,6870,7080,7230,7410,7560,7770,7905,8111,8250,8445],
                    [3435,3630,3795,3975,4125,4320,4485,4650,4815,5025,5175,5355,5520,5715,5895,6060,6240,6420,6585,6765,6945,7140,7310,7455,7635,7815,7980,8160,8355,8520,8685],
                    [3540,3750,3900,4095,4305,4455,4650,4815,5025,5175,5370,5535,5715,5895,6075,6255,6435,6615,6795,6975,7170,7335,7515,7725,7890,8070,8250,8445,8595,8775,8970],
                    [3705,3870,4065,4230,4440,4635,4800,4995,5160,5355,5535,5730,5910,6090,6270,6465,6630,6825,7035,7200,7380,7560,7770,7950,8130,8325,8505,8655,8865,9060,9240],
                    [3840,4035,4215,4410,4575,4785,4980,5145,5355,5520,5730,5910,6090,6300,6495,6645,6855,7050,7245,7425,7605,7815,7980,8160,8370,8550,8745,8940,9120,9300,9510],
                    [4005,4170,4380,4545,4755,4950,5130,5340,5505,5715,5895,6090,6300,6495,6690,6855,7080,7260,7440,7635,7830,8010,8235,8430,8610,8790,9000,9195,9360,9600,9780],
                    [4095,4320,4500,4725,4905,5100,5290,5490,5700,5895,6075,6270,6495,6690,6870,7095,7260,7455,7665,7875,8070,8250,8460,8640,8865,9060,9255,9435,9645,9840,10020],
                    [4230,4440,4650,4830,5055,5250,5460,5670,5865,6060,6255,6465,6645,6870,7095,7275,7485,7695,7890,8145,8340,8505,8685,8895,9105,9285,9510,9705,9900,10095,10305],
                    [4395,4575,4785,5025,5205,5415,5610,5850,6045,6240,6435,6645,6855,7080,7260,7485,7695,7890,8130,8325,8520,8700,8925,9150,9330,9555,9735,9960,10185,10365,10575],
                    [4530,4740,4935,5145,5355,5550,5775,6015,6195,6420,6615,6825,7050,7260,7455,7695,7890,8100,8325,8535,8730,8970,9165,9360,9600,9795,9990,10215,10410,10620,10875],
                    [4650,4860,5100,5295,5505,5730,5925,6150,6390,6600,6795,7035,7245,7440,7665,7890,8100,8325,8535,8745,8970,9180,9375,9615,9825,10020,10260,10470,10680,10920,11100],
                    [4785,5025,5235,5460,5685,5895,6105,6315,6540,6765,6975,7200,7425,7635,7875,8120,8325,8535,8745,8985,9180,9375,9630,9840,10035,10290,10515,10710,10950,11130,11385],
                    [4935,5145,5370,5595,5820,6060,6270,6510,6720,6945,7170,7380,7605,7860,8070,8280,8520,8730,8970,9180,9420,9645,9855,10065,10305,10530,10725,10995,11205,11430,11655],
                    [5085,5295,5505,5760,5970,6195,6435,6645,6870,7140,7335,7590,7815,8010,8265,8505,8700,8970,9180,9375,9645,9855,10065,10335,10545,10785,11010,11235,11490,11685,11910],
                    [5175,5430,5670,5895,6135,6375,6600,6810,7080,7305,7515,7785,7980,8235,8460,8685,8940,9165,9375,9630,9855,10095,10335,10560,10785,11025,11250,11505,11730,11955,12210],
                    [5340,5550,5820,6045,6270,6525,6765,6690,7230,7455,7725,7950,8175,8430,8640,8895,9150,9360,9615,9840,10065,10335,10560,10785,11025,11265,11520,11745,11970,12225,12435],
                    [5475,5715,5955,6195,6435,6690,6930,7170,7410,7635,7890,8130,8370,8610,8865,9105,9330,9600,9825,10035,10305,10545,10785,11025,11265,11520,11745,12000,12240,12465,12720],
                    [5610,5865,6090,6345,6600,6825,7095,7320,7590,7830,8070,8325,8550,8805,9060,9285,9555,9810,10020,10290,10530,10785,11025,11265,11520,11760,12015,12255,12510,12750,12975],
                    [5730,6015,6240,6510,6750,6690,7245,7500,7770,7980,8250,8505,8745,9000,9255,9510,9780,9990,10275,10515,10740,11010,11265,11520,11745,12015,12255,12525,12750,13020,13275],
                    [6645,6960,7245,7545,7815,8100,8415,8685,8985,9255,9555,9825,10110,10395,10695,10995,11280,11565,11850,12150,12420,12720,13020,13305,13575,13875,14160,14430,14730,15015,15315],
                    [6720,7035,7305,7605,7890,8160,8460,8745,9030,9300,9615,9885,10200,10470,10740,11025,11310,11625,11910,12210,12510,12765,13065,13335,13635,13920,14190,14460,14775,15015,15420],
                    [6855,7170,7440,7770,8010,8340,8610,8925,9195,9465,9795,10035,10365,10635,10950,11235,11550,11820,12150,12405,12720,12990,13305,13605,13875,14175,14430,14760,15015,15330,15630],
                    [6990,7305,7590,7890,8160,8505,8775,9090,9345,9660,9960,10260,10545,10875,11145,11430,11730,12030,12345,12615,12945,13230,13530,13800,14100,14400,14700,15000,15300,15615,15870],
                    [7140,7440,7740,8055,8340,8625,8940,9140,9555,9825,10155,10410,10725,11025,11325,11640,11955,12240,12555,12855,13140,13455,13755,14040,14340,14640,14940,15270,15540,15855,16170]
                ]
            },
            // NY: RS Smart 130 (Baserad på PDF s.84/90)
            "RS Smart 130": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [3480,3675,3840,4035,4200,4410,4590,4785,4980,5145,5355],
                    [3660,3825,4035,4200,4410,4575,4785,4980,5145,5355,5535],
                    [3810,4005,4185,4380,4575,4770,4980,5145,5370,5535,5760],
                    [3945,4140,4365,4560,4755,4950,5145,5355,5535,5760,5970],
                    [4075,4320,4500,4740,4935,5130,5355,5535,5760,5970,6165],
                    [4245,4455,4680,4875,5115,5280,5520,5730,5955,6150,6390],
                    [4425,4635,4860,5085,5280,5505,5715,5910,6150,6375,6600],
                    [4575,4785,5040,5235,5460,5700,5895,6135,6345,6585,6780],
                    [4740,4950,5175,5415,5670,5865,6075,6315,6540,6780,6990],
                    [4875,5115,5355,5550,5820,6045,6270,6510,6750,6960,7200],
                    [5055,5280,5505,5760,6015,6210,6465,6720,6945,7185,7410]
                ]
            },
            // NY: Mini ZIP (Baserad på PDF s.41)
            "Mini ZIP": {
                w: [100, 110, 120, 130, 140, 150],
                h: [100, 110, 120, 130, 140, 150],
                prices: [
                    [2482,2635,2720,2856,2958,3077],
                    [2635,2737,2856,2975,3094,3196],
                    [2720,2856,2975,3111,3230,3383],
                    [2856,2975,3111,3230,3383,3519],
                    [2958,3094,3230,3383,3536,3672],
                    [3077,3196,3383,3519,3672,3791]
                ]
            },
            // Neva C80/F80
            "C80 / F80": {
                 w: [600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000],
                 h: [600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000],
                 prices: [
                    [2410,2450,2500,2530,2570,2610,2650,2730,2690,2790,2830,2880,2920,3040,2960,3000,3230,3080,3120,3180,3270,3310,3350,3790,3840,3880,3920,3970,4070,4020,4120,4150,4200,4240,4280,4370,4330,4410,4530,4490,4580,4620,4670,4710,4750],
                    [2480,2500,2540,2580,2640,2680,2730,2770,2810,2890,2930,2990,3030,3070,3120,3100,3220,3260,3300,3380,3420,3520,3470,3900,4000,4040,4100,4140,4240,4280,4340,4380,4440,4480,4530,4580,4630,4700,4680,4810,4800,4910,4900,5000,5050],
                    [2510,2540,2590,2640,2650,2740,2790,2890,2840,2960,3020,3130,3070,3280,3230,3180,3430,3380,3320,3510,3560,3580,3620,4190,4250,4310,4340,4470,4570,4630,4650,4710,4800,4850,4910,4970,5020,5080,5200,5320,5380,5440,5400,5500,5550],
                    [2550,2580,2640,2690,2750,2810,2870,2920,2980,3060,3120,3180,3040,3290,3390,3400,3470,3520,3680,3580,3720,3770,3840,4370,4430,4480,4590,4680,4610,4850,4910,4870,5040,5090,5240,5310,5370,5440,5550,5610,5670,5730,5800,5860,5910],
                    [2580,2630,2680,2750,2810,2870,2930,3050,2990,3140,3200,3340,3270,3480,3300,3520,3640,3600,3790,3710,3920,3800,3980,4570,4630,4710,4780,4840,5020,5000,5240,5320,5280,5370,5510,5530,5600,5740,5850,5870,5930,6070,6140,6210,6280],
                    [2610,2670,2740,2800,2870,2930,3010,3140,3070,3240,3300,3440,3380,3580,3640,3610,3710,3950,3850,3780,4080,4010,4150,4700,4840,4900,5070,5230,5350,5430,5500,5680,5600,5730,5890,5820,5900,5970,6050,6170,6250,6320,6400,6460,6540],
                    [2650,2710,2780,2830,2900,3000,3070,3220,3140,3310,3380,3540,3470,3760,3880,3610,4080,3970,3900,3830,4230,4150,4290,5020,4950,5190,5260,5380,5440,5570,5680,5730,5820,5910,5990,6060,6160,6230,6320,6450,6530,6700,6780,6870,6950],
                    [2680,2700,2830,2910,2990,3090,3150,3300,3230,3410,3490,3650,3560,3690,3730,3880,4200,4120,4030,3900,4380,4310,4470,5230,5320,5410,5520,5680,5890,5960,6090,6000,6180,6270,6350,6440,6630,6770,6840,6960,7040,7030,7120,7220,7300],
                    [2710,2740,2840,2900,3020,3110,3220,3370,3290,3490,3560,3720,3630,3770,3990,4040,4380,4290,4210,4530,4530,4450,4610,5440,5504,5640,5720,5820,5920,6070,6180,6260,6350,6450,6550,6640,6740,6990,7070,6830,7270,7170,7470,7370,7560],
                    [2740,2800,2890,2960,3040,3130,3200,3440,3350,3500,3660,3760,3710,3880,4040,4100,4460,4430,4450,4610,4700,4620,4770,5620,5720,5820,6080,6130,6290,6360,6460,6560,6630,6790,6830,6900,7000,7100,7260,7380,7480,7580,7680,7780,7870],
                    [2770,2840,2900,3020,3110,3190,3300,3490,3410,3620,3700,3800,3790,3900,4140,4210,4510,4510,4590,4730,4890,4730,4930,5830,5940,6050,6200,6360,6530,6640,6750,6880,6970,7070,7130,7180,7290,7400,7510,7670,7780,7890,7820,7910,8010],
                    [2800,2890,2980,3070,3160,3220,3370,3540,3460,3660,3770,3880,3870,3950,4230,4300,4640,4570,4730,4890,4950,4850,4980,6040,6150,6270,6330,6500,6610,6780,6800,7010,7130,7240,7390,7470,7500,7700,7820,7860,7910,8010,8120,8220,8320],
                    [2830,2900,3020,3040,3130,3290,3440,3590,3520,3660,3830,3910,3950,4080,4290,4380,4700,4710,4800,4930,5060,5020,5140,6220,6340,6480,6580,6700,6820,7000,7120,7240,7350,7480,7600,7730,7850,7780,7890,8060,8100,8150,8260,8310,8410],
                    [2860,2960,3070,3110,3190,3350,3490,3630,3570,3700,3900,3990,4030,4240,4380,4510,4820,4830,4920,5050,5230,5170,5290,6420,6550,6680,6800,6930,7090,7250,7380,7500,7630,7750,7880,7830,7940,8060,8100,8340,8460,8570,8690,8800,8920],
                    [2900,3020,3110,3160,3200,3280,3530,3660,3700,3760,3830,4040,4120,4290,4430,4540,4890,4940,5000,5210,5330,5330,5400,6630,6770,6900,7030,7160,7300,7500,7630,7760,7890,7850,7970,8060,8210,8330,8450,8620,8560,8730,8940,9050,9150],
                    [2930,3070,3130,3190,3220,3300,3560,3700,3750,3800,3910,4080,4210,4380,4510,4640,4990,5000,5170,5320,5440,5590,5710,6810,6950,7100,7240,7370,7510,7720,7860,7820,7940,8060,8180,8320,8400,8570,8680,8690,8880,8830,8950,9070,9190],
                    [2960,3120,3160,3200,3260,3370,3610,3760,3820,3880,3950,4120,4290,4430,4610,4710,5050,5210,5320,5450,5560,5610,5880,7020,7170,7310,7460,7610,7760,7760,7910,8040,8160,8310,8440,8570,8700,8830,9050,9240,9360,9480,9610,9740,9860],
                    [2990,3140,3190,3220,3300,3470,3660,3800,3880,3990,4030,4170,4380,4510,4670,4830,5100,5320,5400,5570,5740,5740,5880,7230,7380,7530,7680,7840,7900,8010,8150,8250,8430,8560,8700,8930,9050,9170,9320,9520,9680,9780,9970,10100,10340],
                    [3020,3180,3200,3350,3440,3540,3700,3830,3910,4040,4120,4210,4430,4640,4710,4920,5180,5400,5600,5780,5810,5880,6190,7410,7580,7730,7880,7880,8000,8210,8350,8490,8630,8770,8920,9150,9290,9420,9550,9780,9900,10030,10220,10450,10580],
                    [3040,3190,3220,3370,3490,3640,3760,3880,3950,4100,4140,4240,4510,4730,4850,4990,5340,5570,5770,5810,6050,6000,6340,7620,7760,7920,7990,8140,8280,8440,8580,8730,8870,9100,9250,9460,9600,9740,9890,10060,10240,10380,10610,10820,10970],
                    [3070,3200,3300,3440,3540,3690,3800,3990,4030,4140,4230,4300,4530,4770,4990,5050,5520,5770,5810,6190,6200,6300,6510,7830,7970,8120,8260,8380,8560,8700,8840,9080,9220,9340,9490,9710,9880,10010,10220,10450,10610,10750,10980,11120,11270],
                    [3110,3220,3350,3490,3660,3770,3880,4030,4120,4240,4380,4510,4640,4850,5100,5240,5730,5910,6300,6350,6340,6440,6700,7980,8140,8270,8420,8540,8760,8910,9060,9250,9410,9560,9770,10000,10160,10390,10540,10700,10850,11000,11150,11380,11500],
                    [3130,3300,3440,3500,3660,3800,3910,4080,4210,4290,4430,4510,4670,4890,5120,5300,5770,6140,6330,6510,6500,6650,6910,8200,8350,8510,8650,8750,8920,9170,9320,9480,9640,9800,10020,10260,10600,10850,10810,10970,11130,11280,11450,11780,11920],
                    [3160,3370,3490,3610,3760,3830,3990,4140,4240,4330,4450,4640,4730,4930,5200,5340,5840,6220,6410,6530,6700,6790,7030,8360,8520,8700,8880,8970,9220,9380,9600,9770,9930,10080,10280,10660,10780,10920,11090,11250,11410,11650,11820,12070,12200],
                    [3190,3470,3540,3660,3800,3910,4030,4230,4290,4430,4540,4770,4890,5020,5220,5420,6090,6230,6450,6700,6820,7000,7220,8450,8630,8810,8950,9230,9410,9570,9800,10050,10220,10470,10730,10900,11060,11200,11400,11600,11880,12070,12240,12460,12580],
                    [3220,3500,3690,3770,3880,3990,4120,4300,4380,4530,4610,4800,4980,5130,5240,5450,6270,6340,6700,6820,7000,7150,7370,8640,8820,9000,9270,9440,9680,9850,10000,10260,10540,10710,10980,11150,11300,11560,11750,11920,12190,12350,12540,12710,12880],
                    [3250,3540,3700,3880,3950,4120,4240,4380,4510,4540,4770,4890,5000,5140,5300,5500,6340,6580,6850,7000,7310,7300,7530,8830,9010,9290,9460,9650,9890,10070,10250,10500,10780,10950,11230,11400,11690,12020,11850,12210,12470,12650,12830,13090,13280],
                    [3290,3580,3760,3910,4030,4210,4310,4430,4640,4730,4920,5050,5240,5280,5320,5600,6440,6710,6940,7110,7200,7490,7670,9000,9330,9470,9700,9850,10040,10310,10570,10750,10930,11190,11380,11640,11830,12010,12190,12460,12630,12820,13000,13180,13360],
                    [3320,3610,3800,3950,4140,4290,4430,4510,4770,4930,5050,5100,5300,5430,5620,5650,6500,6790,7120,7220,7440,7680,7880,9280,9630,9710,9910,10080,10300,10560,10750,11030,11220,11410,11680,11970,12350,12350,12540,12730,13000,13280,13470,13860,14050],
                    [3350,3660,3830,3990,4230,4380,4510,4640,4850,4990,5100,5320,5440,5570,5770,5910,6580,6880,7240,7260,7540,7880,8060,9520,9710,9910,10100,10300,10500,10780,10980,11200,11400,11740,12000,12220,12420,12610,12810,13090,13370,13570,13960,14100,14380],
                    [3380,3710,3880,4040,4300,4510,4640,4730,4930,5100,5300,5400,5600,5770,5910,6090,6790,7140,7430,7520,7670,8060,8430,9680,9880,10060,10200,10500,10770,10970,11170,11470,11750,11950,12240,12450,12640,12840,13130,13330,13630,13820,14220,14610,14700],
                    [3440,3770,3910,4120,4380,4640,4850,4990,5180,5240,5440,5620,5710,5910,6100,6270,6820,7190,7500,7750,7880,8250,8540,9880,10070,10380,10580,10770,10980,11108,11300,11770,11980,12190,12490,12700,12910,13200,13500,13810,14100,14310,14610,14810,15020],
                    [3470,3820,3950,4140,4510,4770,4930,5120,5290,5410,5550,5770,5840,6020,6200,6330,7000,7250,7630,7900,8070,8430,8650,9830,10040,10330,10540,10750,10950,11170,11407,11700,11970,12180,12408,12600,12900,13100,13310,13620,13820,14030,14340,14540,14850],
                    [3490,3880,3990,4210,4640,4890,5010,5180,5320,5450,5620,5800,5980,6090,6300,6440,7130,7300,7760,8000,8200,8510,8790,10000,10210,10510,10730,10930,11150,11370,11600,11970,12190,12390,12700,12920,13120,13340,13560,13770,14070,14290,14510,14720,14930]
                ]
            },
            "RS Smart 130 XL": {
                w: [610,620,630,640,650,660,670,680,690,700],
                h: [100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],
                prices: [
                    [14448,14592,14768,14912,15040,15200,15344,15520,15632,15792],
                    [14768,14928,15104,15256,15424,15600,15776,15952,16128,16304],
                    [15744,15936,16128,16320,16512,16704,16896,17088,17280,17488],
                    [16016,16272,16480,16688,16896,17104,17312,17536,17744,17952],
                    [16288,16480,16672,16864,17040,17248,17456,17648,17792,17984],
                    [16544,16752,16944,17136,17312,17520,17712,17904,18096,18288],
                    [16784,16960,17136,17296,17488,17664,17792,17968,18160,18320],
                    [17088,17280,17488,17680,17872,18064,18256,18448,18640,18832],
                    [18080,18288,18496,18720,18928,19120,19360,19552,19808,20032],
                    [19352,18400,18768,18992,19216,19440,19648,19856,20080,20272],
                    [19328,19552,19824,20064,20272,20512,20768,20992,21232,21472],
                    [19648,19888,20160,20416,20688,20912,21184,21456,21680,21984],
                    [20032,20256,20512,20800,21024,21280,21552,21632,22080,22160],
                    [20160,20400,20640,20864,21088,21360,21584,21792,22064,22320],
                    [20432,20688,20896,21136,21408,21616,21680,22112,22320,22528],
                    [20688,20880,21088,21344,21536,21728,21984,22352,22384,22592],
                    [21680,21984,22224,22448,22768,22992,23216,23520,23760,24000],
                    [21984,22224,22448,22768,22992,23216,23520,23760,24000,24288],
                    [22384,22640,22928,23168,23472,23712,23968,24256,24480,24752],
                    [22695,23010,23340,23505,23835,24135,24420,24750,25024,25552],
                    [23152,23472,23808,24144,24480,24816,25152,25488,25824,26160]
                ]
            },
            // RS Smart 85
            "RS Smart 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [2715, 2820, 2985, 3090, 3180, 3330, 3465, 3570, 3705, 3825, 3945, 4080, 4185, 4320, 4440, 4575, 4695, 4815, 4950, 5055, 5175],
                    [2850, 3000, 3090, 3240, 3345, 3495, 3570, 3645, 3870, 4020, 4125, 4245, 4380, 4500, 4635, 4770, 4860, 4995, 5130, 5280, 5430],
                    [3000, 3150, 3120, 3285, 3525, 3675, 3645, 3750, 4065, 4185, 4320, 4320, 4545, 4695, 4635, 4950, 5055, 5145, 5325, 5460, 5610],
                    [3150, 3300, 3240, 3405, 3705, 3825, 3750, 3810, 4230, 4380, 4500, 4440, 4740, 4860, 4800, 5130, 5250, 5325, 5475, 5640, 5790],
                    [3300, 3450, 3285, 3435, 3855, 4020, 3810, 3900, 4425, 4545, 4695, 4455, 4905, 5055, 4800, 5325, 5430, 5475, 5670, 5820, 6015],
                    [3450, 3570, 3405, 3540, 4035, 4170, 3900, 3975, 4575, 4740, 4860, 4635, 5100, 5250, 4995, 5475, 5610, 5640, 5850, 6015, 6165],
                    [3630, 3750, 3435, 3570, 4185, 4350, 3975, 4080, 4770, 4905, 5055, 4635, 5280, 5430, 5145, 5670, 5790, 5820, 6030, 6195, 6375],
                    [3750, 3885, 3540, 3720, 4365, 4485, 4080, 4125, 4950, 5100, 5250, 4800, 5460, 5610, 5325, 5850, 6015, 6015, 6195, 6390, 6540],
                    [3885, 4050, 3570, 3720, 4500, 4650, 4125, 4245, 5130, 5280, 5430, 4980, 5640, 5790, 5475, 6030, 6195, 6165, 6390, 6570, 6750],
                    [4050, 4185, 3720, 3870, 4580, 4800, 4245, 4320, 5325, 5460, 5610, 4995, 5820, 6015, 5640, 6195, 6390, 6375, 6540, 6750, 6930],
                    [4185, 4365, 3720, 3885, 4815, 4995, 4320, 4440, 5475, 5640, 5790, 5145, 6015, 6165, 5790, 6390, 6570, 6540, 6820, 6930, 7125]
                ]
            },
            // RS Classic 75
            "RS Classic 75": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230],
                h: [100, 110, 120, 130, 140, 150, 160, 170],
                prices: [
                    [2237, 2315, 2426, 2489, 2583, 2662, 2788, 2867, 2945, 3119, 3040, 3213, 3292, 3418],
                    [2284, 2378, 2473, 2567, 2646, 2756, 2867, 2945, 3040, 3229, 3134, 3308, 3434, 3497],
                    [2347, 2457, 2552, 2630, 2741, 2835, 2930, 3008, 3134, 3308, 3229, 3434, 3512, 3607],
                    [2394, 2520, 2599, 2709, 2819, 2914, 3008, 3119, 3213, 3308, 3434, 3512, 3623, 3733],
                    [2457, 2567, 2662, 2788, 2898, 2977, 3103, 3213, 3292, 3512, 3434, 3623, 3749, 3827],
                    [2520, 2615, 2741, 2867, 2961, 3087, 3166, 3276, 3418, 3623, 3512, 3733, 3827, 3938],
                    [2567, 2662, 2819, 2930, 3040, 3150, 3260, 3402, 3497, 3607, 3733, 3827, 3938, 4079],
                    [2615, 2756, 2882, 2977, 3119, 3229, 3323, 3465, 3591, 3812, 3701, 3922, 4079, 4174]
                ]
            },
            // RS Classic 85
            "RS Classic 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320],
                prices: [
                    [2213, 2331, 2404, 2537, 2640, 2729, 2847, 2950, 3068, 3157, 3260, 3393, 3466, 3599, 3702, 3806, 3938, 4027, 4145, 4292, 4381],
                    [2331, 2434, 2537, 2655, 2744, 2876, 3009, 3083, 3216, 3304, 3422, 3570, 3643, 3761, 3879, 3983, 4101, 4233, 4337, 4455, 4573],
                    [2404, 2537, 2655, 2758, 2891, 3024, 3112, 3230, 3348, 3466, 3599, 3702, 3806, 3953, 4027, 4145, 4307, 4425, 4573, 4705, 4853],
                    [2537, 2655, 2758, 2891, 3024, 3112, 3245, 3378, 3481, 3629, 3747, 3835, 3983, 4101, 4233, 4337, 4469, 4617, 4735, 4897, 5030],
                    [2640, 2744, 2891, 3024, 3127, 3260, 3393, 3511, 3643, 3761, 3909, 4012, 4130, 4292, 4381, 4499, 4661, 4779, 4941, 5059, 5207],
                    [2729, 2876, 3024, 3112, 3260, 3393, 3511, 3658, 3776, 3938, 4027, 4160, 4322, 4425, 4573, 4691, 4823, 4971, 5089, 5251, 5384],
                    [2847, 3009, 3112, 3245, 3393, 3511, 3658, 3806, 3953, 4056, 4174, 4337, 4469, 4617, 4735, 4897, 5045, 5207, 5369, 5517, 5679],
                    [2950, 3083, 3230, 3378, 3511, 3658, 3806, 3953, 4071, 4233, 4351, 4484, 4617, 4750, 4912, 5059, 5236, 5384, 5546, 5694, 5856],
                    [3068, 3186, 3304, 3466, 3658, 3806, 3953, 4071, 4233, 4296, 4499, 4661, 4779, 4941, 5059, 5251, 5399, 5576, 5723, 5871, 6033],
                    [3157, 3275, 3422, 3614, 3806, 3953, 4071, 4233, 4351, 4514, 4676, 4794, 4956, 5074, 5236, 5413, 5590, 5753, 5915, 6048, 6210],
                    [3260, 3393, 3511, 3732, 3953, 4071, 4233, 4351, 4484, 4691, 4823, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402],
                    [3393, 3466, 3599, 3843, 4056, 4174, 4351, 4484, 4691, 4823, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579],
                    [3466, 3599, 3702, 3969, 4174, 4337, 4484, 4617, 4823, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726],
                    [3599, 3702, 3806, 4027, 4337, 4469, 4691, 4750, 4971, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918],
                    [3702, 3806, 3953, 4145, 4469, 4617, 4823, 4912, 5089, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094],
                    [3806, 3953, 4027, 4233, 4573, 4735, 4971, 5059, 5251, 5384, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271],
                    [3938, 4027, 4145, 4337, 4691, 4897, 5089, 5236, 5399, 5605, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448],
                    [4027, 4145, 4307, 4469, 4823, 5045, 5251, 5384, 5576, 5767, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610],
                    [4145, 4233, 4425, 4617, 4971, 5207, 5384, 5546, 5723, 5930, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801],
                    [4292, 4337, 4573, 4735, 5089, 5369, 5605, 5694, 5871, 6062, 6239, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978],
                    [4381, 4455, 4705, 4897, 5251, 5517, 5767, 5856, 6033, 6210, 6402, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978, 8184],
                    [4469, 4573, 4853, 5045, 5384, 5679, 5930, 6033, 6210, 6372, 6579, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978, 8184, 8346],
                    [4617, 4691, 5030, 5207, 5605, 5856, 6062, 6210, 6402, 6548, 6726, 6918, 7094, 7271, 7448, 7610, 7801, 7978, 8184, 8346, 8522]
                ]
            },
            "RS Classic 95": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2301,2375,2493,2581,2699,2803,2935,3039,3127,3452,3378,3245,3688,3599,3791,3909,4012,4115,4248,4337,4455,4573,4676,4897,4779,5015],
                    [2375,2493,2581,2699,2832,2950,3053,3157,3275,3407,3481,3629,3835,3747,3983,4174,4071,4322,4425,4514,4661,4750,4897,5118,5015,5251],
                    [2478,2581,2699,2832,3068,3186,2950,3289,3422,3776,3658,3570,4012,3909,4130,4366,4278,4484,4617,4720,4853,4971,5074,5207,5325,5428],
                    [2581,2699,2832,2950,3216,3304,3083,3437,3599,3953,3806,3702,4174,4071,4322,4573,4425,4691,4794,4941,5059,5192,5325,5428,5590,5694],
                    [2685,2832,2950,3068,3304,3452,3216,3599,3732,4101,3983,3820,4351,4248,4484,4735,4617,4868,5015,5118,5266,5384,5517,5635,5782,5915],
                    [2773,2935,3068,3216,3452,3614,3304,3747,3835,3997,4130,4307,4381,4514,4676,4794,4941,5059,5207,5325,5443,5590,5723,5974,5826,6092],
                    [2921,3053,3186,3304,3452,3614,3747,3879,4012,4145,4307,4425,4573,4705,4853,5000,5118,5266,5399,5546,5679,5812,5959,6239,6092,6387],
                    [3024,3127,3289,3437,3732,3879,3599,4012,4145,4602,4425,4307,4868,4720,5015,5310,5163,5428,5590,5753,5871,6003,6151,6431,6298,6579],
                    [3098,3260,3407,3584,3702,3835,3997,4145,4307,4455,4602,4735,4897,5045,5192,5340,5458,5635,5782,5944,6062,6210,6357,6490,6638,6756],
                    [3230,3393,3511,3688,3820,3983,4130,4307,4405,4912,4602,4735,5207,5059,5369,5664,5517,5812,5974,6136,6284,6431,6579,6844,6697,7006],
                    [3304,3481,3629,3791,4115,4278,3968,4425,4602,4912,4735,5059,5369,5207,5517,5812,5664,5974,6136,6284,6431,6579,6697,7006,6844,7124],
                    [3437,3629,3747,3938,4248,4381,4101,4573,4735,5207,4897,5059,5517,5369,5664,5974,5812,6136,6284,6431,6579,6697,6844,7006,7124,7331],
                    [3570,3747,3820,4027,4366,4233,4499,4705,4897,5384,5236,5045,5679,5546,5826,5989,6151,6298,6451,6593,6711,6859,7021,7360,7139,7567],
                    [3643,3835,3997,282,4705,4469,4337,4897,5045,5576,5384,5236,5826,5679,5989,6298,6151,6451,6593,6711,6859,7021,7139,7360,7567,7695],
                    [3820,3983,4145,4337,4469,4705,4897,5059,5251,5399,5576,5694,5856,6003,6166,6475,6313,6608,8068,6874,7036,7154,7375,7596,7801,7954],
                    [4056,4278,4425,4573,4853,5015,5207,5384,5576,5871,5753,6003,6357,6166,6520,6815,6667,6977,7124,7287,7390,7596,7781,7954,8111,8285],
                    [4307,4425,4573,4853,5207,5015,5399,5576,5767,5915,6033,6195,6387,6534,6682,6829,7006,7139,7301,7419,7655,7844,7985,8159,8363,8489],
                    [4484,4617,4705,5118,5399,5163,5605,5753,5974,6195,6048,6387,6579,6844,6863,7006,7154,7316,7478,7670,7891,7970,8190,8363,8521,8710],
                    [4705,4779,4853,5399,5605,5325,5790,5930,6195,6534,6357,6210,6756,6962,7021,7331,7139,7493,7670,7828,8017,8143,8316,8552,8726,8930],
                    [4897,5118,5207,5428,5635,5974,6239,6431,6490,6844,7006,7006,7360,7360,7596,7124,7308,7478,7670,7331,7596,7567,7567,9214,10395,10663],
                    [5015,5251,5428,5694,5915,6092,6387,6579,6756,7006,7124,7331,7567,7360,7596,7390,7844,7478,7670,7331,7596,7567,7567,9450,10663,10845]
                ]
            },
            "RS Classic 105": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2550,2685,2775,2880,3000,3105,3180,3315,3435,3510,3660,3750,3855,3975,4065,4245,4395,4500,4635,4755,4860,4995,5115,5235,5355,5475,5595,5700,5895,6030,6105],
                    [2685,2790,2895,3030,3135,3240,3345,3465,3570,3705,3825,3945,4050,4140,4245,4440,4545,4650,4755,4830,4950,5055,5145,5250,5355,5460,5580,5790,5955,6165,6300],
                    [2805,2925,3060,3150,3285,3408,3510,3660,3750,3855,3975,4080,4200,4365,4455,4680,4770,4860,4980,5085,5160,5280,5370,5475,5550,5685,5800,5955,6060,6240,6405],
                    [2925,3060,3150,3300,3435,3525,3675,3795,3885,4035,4140,4245,4395,4530,4650,4860,4995,5115,5235,5355,5475,5595,5715,5850,5855,6075,6240,6495,6585,6705,6810],
                    [3075,3165,3300,3450,3540,3690,3825,3945,4065,4200,4350,4455,4575,4725,4830,5100,5205,5340,5460,5550,5700,5820,5925,6060,6165,6300,6510,6615,6750,6855,6975],
                    [3165,3300,3450,3540,3705,3840,3975,4095,4215,4380,4500,4635,4770,4875,5040,5295,5430,5550,5715,5865,6015,6135,6270,6420,6570,6705,6780,6900,7050,7170,7275],
                    [3300,3435,3540,3705,3840,4005,4125,4245,4395,4530,4680,4800,4935,5100,5205,5475,5610,5760,5895,6045,6165,6390,6525,6630,6750,6870,7050,7185,7305,7440,7560],
                    [3435,3540,3705,3840,4005,4125,4245,4425,4560,4725,4830,4995,5130,5280,5415,5700,5850,5970,6105,6255,6405,6615,6765,6900,7035,7125,7305,7440,7590,7740,7875],
                    [3525,3690,3825,4005,4125,4245,4425,4560,4725,4860,5025,5160,5325,5460,5595,5895,6060,6210,6390,6540,6750,6870,7035,7170,7305,7500,7590,7740,7875,8010,8160],
                    [3675,3825,3975,4125,4245,4425,4575,4740,4875,5040,5175,5340,5490,5670,5790,6105,6270,6435,6600,6765,6960,7140,7260,7410,7560,7740,7860,7995,8145,8280,8460],
                    [3795,3945,4095,4230,4410,4560,4740,4875,5055,5175,5355,5505,5685,5850,6015,6300,6435,6585,6720,6855,7230,7365,7515,7695,7830,8010,8130,8280,8460,8595,8745],
                    [3885,4065,4215,4395,4545,4740,4875,5055,5205,5370,5520,5700,5865,6030,6165,6510,6645,6810,6975,7155,7455,7605,7785,7920,8085,8265,8415,8550,8700,8880,9030],
                    [4035,4200,4380,4530,4725,4860,5040,5205,5370,5520,5700,5880,6045,6195,6390,6720,6870,7050,7200,7365,7695,7860,7995,8160,8340,8505,8655,8820,9000,9165,9300],
                    [4140,4350,4485,4680,4815,5025,5175,5355,5520,5700,5880,6045,6210,6405,6570,6930,7125,7275,7455,7635,7950,8100,8265,8460,8610,8775,8970,9120,9270,9450,9630],
                    [4305,4440,4635,4800,4995,5160,5340,5505,5700,5880,6060,6240,6405,6585,6765,7155,7320,7500,7695,7875,8160,8355,8520,8685,8880,9030,9225,9360,9570,9720,9900],
                    [4395,4560,4755,4935,5130,5325,5490,5685,5865,6045,6210,6435,6585,6765,6945,7320,7500,7695,7875,8055,8445,8610,8790,8970,9150,9300,9510,9675,9840,10005,10215],
                    [4530,4725,4875,5100,5280,5475,5670,5850,6030,6195,6405,6630,6765,6960,7155,7515,7725,7890,8070,8250,8655,8865,9030,9225,9375,9600,9780,9930,10100,10305,10500],
                    [4650,4815,5040,5205,5415,5610,5790,5970,6165,6390,6570,6810,6990,7155,7320,7770,7950,8100,8280,8475,8895,9090,9270,9450,9645,9840,10005,10215,10395,10575,10740],
                    [4770,4980,5145,5355,5595,5775,5955,6132,6345,6540,6750,6990,7200,7320,7515,7950,8145,8340,8520,8700,9165,9330,9555,9720,9915,10095,10305,10515,10680,10905,11070],
                    [4875,5100,5295,5490,5730,5925,6090,6300,6510,6705,6900,7200,7380,7515,7740,8160,8370,8565,8775,8970,9360,9600,9795,9975,10200,10365,10560,10740,10965,11175,11325],
                    [5025,5205,5415,5640,5895,6075,6255,6465,6645,6855,7095,7380,7590,7695,7905,8355,8550,8775,8985,9180,9645,9840,10020,10260,10455,10635,10875,11055,11250,11445,11655]
                ]
            },
            // RS Classic 120 / 125 (Delar samma matris 100-350cm)
            "RS Classic 120": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4741,4851,4961,5072,5182,5324,5418,5528],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,5119,5182,5324,5418,5544,5670,5765],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5056,5166,5371,5434,5544,5670,5780,5906,6048],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5292,5418,5607,5670,5780,5906,6048,6158,6284],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5513,5670,5891,5985,6095,6237,6379,6495,6615],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5749,5906,6127,6206,6347,6495,6631,6773,6900],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4820,4961,5119,5245,5387,5528,5670,5780,6001,6158,6379,6473,6615,6757,6900,7050,7170],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,4946,5150,5324,5465,5576,5733,5875,6032,6174,6395,6631,6725,6883,7025,7170,7305,7440],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5213,5355,5497,5654,5780,5954,6080,6221,6410,6600,6899,6993,7135,7287,7425,7590,7725],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6647,6810,7166,7261,7410,7560,7718,7860,7980],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6851,7080,7434,7513,7670,7815,7970,8130,8250],
                    [4316,4489,4646,4820,4961,5135,5292,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7056,7230,7655,7785,7920,8085,8235,8415,8505],
                    [4473,4646,4820,4961,5135,5324,5465,5639,5765,5954,6111,6269,6426,6615,6757,6930,7103,7277,7455,7938,8017,8175,8340,8489,8655,8745],
                    [4631,4804,4946,5119,5324,5465,5639,5780,5985,6127,6300,6473,6647,6788,6962,7135,7308,7466,7695,8174,8280,8442,8610,8775,8940,9000],
                    [4725,4946,5135,5261,5465,5639,5812,6001,6158,6332,6505,6678,6820,6993,7166,7340,7513,7733,7920,8442,8537,8694,8865,9025,9195,9255],
                    [4883,5119,5324,5418,5639,5780,5985,6127,6300,6473,6694,6851,7040,7214,7387,7576,7749,7954,8160,8694,8789,8970,9135,9300,9465,9510],
                    [4993,5261,5481,5560,5780,5922,6111,6269,6426,6631,6867,7056,7245,7418,7592,7781,7954,8159,8363,8930,9030,9195,9360,9540,9675,9780],
                    [5135,5402,5654,5717,5985,6158,6347,6495,6647,6851,7088,7261,7434,7607,7796,7985,8159,8363,8615,9214,9308,9482,9645,9825,9990,9990],
                    [5245,5481,5812,5891,6080,6284,6473,6631,6788,7025,7261,7434,7623,7812,8001,8190,8379,8552,8726,9419,9513,9702,9860,10035,10215,10275],
                    [5402,5670,6001,6017,6284,6505,6615,6788,6962,7214,7434,7639,7828,8064,8206,8411,8615,8789,8993,9734,9825,10020,10185,10365,10530,10515],
                    [5513,5859,6111,6206,6395,6694,6851,6993,7135,7387,7592,7796,8017,8237,8426,8615,8789,8993,9180,9938,10049,10238,10411,10584,10785,10740],
                    [5654,6017,6347,6395,6631,6820,7103,7214,7340,7560,7812,7985,8174,8348,8584,8789,8978,9182,9371,10206,10285,10490,10663,10836,11010,11010],
                    [6048,6206,6615,6631,6851,7056,7340,7403,7592,7733,8064,8237,8442,8610,8773,8993,9182,9387,9570,10395,10505,10710,10899,11057,11235,11265],
                    [6552,6395,6851,6820,7025,7308,7592,7623,7844,7970,8316,8489,8694,8867,9056,9277,9450,9655,9840,10584,10679,10931,11088,11261,11450,11520],
                    [7387,6631,7103,6993,7261,7513,7844,7954,8096,8206,8584,8726,8970,9135,9324,9540,9749,9907,10112,10631,10805,11025,11198,11324,11561,11745],
                    [6710,6820,7340,7214,7403,7781,8096,8253,8363,8442,8852,8993,9214,9371,9576,9735,9923,10206,10379,10899,10931,11151,11356,11592,11750,12015]
                ]
            },
            // NY: RS Universal 105 (Baserad på PDF s.69)
            "RS Universal 105": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [2715,2820,2970,3090,3180,3315,3450,3540,3690,3810,3900],
                    [2820,3000,3120,3240,3360,3495,3645,3750,3870,4020,4125],
                    [2970,3120,3285,3405,3525,3675,3810,3900,4065,4185,4350],
                    [3090,3240,3450,3570,3705,3840,4005,4095,4230,4395,4500],
                    [3180,3360,3525,3705,3870,4020,4140,4305,4425,4560,4725],
                    [3315,3495,3675,3840,4020,4185,4350,4455,4590,4770,4905],
                    [3450,3645,3810,4005,4140,4350,4500,4650,4800,4950,5100],
                    [3540,3750,3900,4095,4305,4455,4650,4815,4995,5130,5295],
                    [3690,3870,4065,4230,4425,4590,4800,4995,5160,5340,5490],
                    [3810,4020,4185,4395,4560,4770,4950,5130,5340,5505,5685],
                    [3900,4125,4350,4500,4725,4905,5100,5295,5490,5685,5880]
                ]
            },
            // --- RS Universal ---
            "RS Universal 85": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                prices: [
                    [2475, 2610, 2730, 2850, 2985, 3105, 3210, 3330, 3465, 3570, 3705],
                    [2610, 2730, 2880, 3000, 3120, 3240, 3360, 3495, 3645, 3750, 3870],
                    [2745, 2880, 3030, 3135, 3285, 3405, 3525, 3675, 3810, 3900, 4065],
                    [2895, 3030, 3150, 3300, 3435, 3540, 3705, 3825, 3975, 4095, 4230],
                    [3060, 3150, 3300, 3450, 3570, 3720, 3855, 4020, 4140, 4305, 4410],
                    [3150, 3300, 3465, 3630, 3750, 3870, 4035, 4170, 4320, 4440, 4575],
                    [3300, 3450, 3630, 3750, 3870, 4050, 4185, 4350, 4485, 4635, 4770],
                    [3450, 3570, 3750, 3885, 4050, 4200, 4365, 4500, 4650, 4800, 4950],
                    [3570, 3720, 3870, 4050, 4200, 4365, 4500, 4680, 4815, 4995, 5130],
                    [3705, 3855, 4035, 4185, 4365, 4500, 4680, 4815, 4995, 5145, 5325],
                    [3840, 4020, 4185, 4365, 4500, 4680, 4815, 5025, 5160, 5340, 5490]
                ]
            },
            "RS Universal 95": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2535,2655,2775,2895,3030,3135,3270,3360,3495,3645,3750,3855,4185,4095,4215,4365,4455,4575,4725,4830,4950,4995,5145,5250,5355,5460],
                    [2685,2805,2940,3075,3165,3300,3450,3540,3690,3810,3945,4065,4455,4320,4440,4560,4695,4800,4935,5085,5160,5055,5370,5490,5355,5685],
                    [2805,2970,3090,3210,3330,3480,3630,3720,3855,4455,4125,4230,4560,4500,4650,4980,4875,5040,5145,5355,5475,5280,5610,5730,5550,5970],
                    [2970,3105,3240,223,3495,3660,3765,3885,4050,4170,4320,4440,4395,4725,4830,4770,5115,5250,5370,5550,5700,5595,5865,5970,5855,6210],
                    [3105,3360,3360,3690,3675,3975,4095,4080,4200,4365,4485,4635,5145,4905,5055,5175,5340,5460,5820,5865,6015,5820,6135,6270,6165,6570],
                    [3240,3240,3510,3510,3825,3810,3945,4230,4395,4530,4860,4800,5355,5115,5250,5400,5520,5685,5595,6045,6100,6135,6390,6525,6645,6795],
                    [3360,3525,3690,3825,4455,4125,4440,4425,4560,4725,5055,5025,5535,5325,5460,5595,5760,8895,6045,6255,6345,6240,6615,6865,6900,7050],
                    [3510,3690,3825,4455,4125,4305,4590,4575,4755,4875,5235,5175,5730,5490,5670,5820,5970,6105,6255,6540,6585,6495,6900,7080,7230,7380],
                    [3675,3825,4455,4140,4305,4440,4245,4770,4860,5085,5790,5400,5925,5700,5865,6030,6165,6315,6495,6765,6795,6750,7095,7230,7365,7500],
                    [3810,3975,4125,4590,4440,4770,5115,4935,9057,5610,5595,5550,6105,8895,6255,6630,6795,6540,6930,6855,7050,6945,7320,7455,7605,7770],
                    [3945,4245,4305,4440,4770,4935,4950,5115,5280,5430,5415,5775,7125,6090,6465,6624,6390,6765,6705,7155,7275,7185,7605,7785,7920,8085],
                    [4080,4095,4425,4305,4590,4590,4770,5280,5460,5250,6900,5970,7275,6300,6060,6420,6600,6975,7155,7365,7515,7440,7860,7995,8160,8340],
                    [4215,4410,4575,4755,4935,5115,5280,5460,5610,6705,6720,6900,6525,6510,6855,6825,7875,8055,8475,7635,7785,7695,8130,8325,8505,8655],
                    [4095,4695,4860,5085,5250,5430,5610,5790,6075,6270,6465,6630,6810,6705,7170,7335,7515,7725,7890,8280,8445,8610,8775,8970,9195,9360],
                    [4440,4830,5040,5205,5400,5595,5775,5970,6255,6465,6645,6825,7035,6870,7380,7560,7770,7920,8100,8535,8640,8820,9090,9255,9435,9630],
                    [4365,4995,5160,5370,5535,5760,5925,6135,6465,6645,6825,7035,7230,7095,7590,7800,7965,8145,8370,8775,8895,9090,9285,9510,9675,9855],
                    [4695,5130,5340,5505,5715,5910,6105,6300,6645,6825,7050,7230,7425,7275,7815,7995,8175,8415,8565,9000,9150,9300,9540,9702,9990,10215],
                    [4800,5325,5475,5685,5880,6075,6270,6495,6855,7050,7230,7425,7620,7485,8010,8220,8430,8610,8805,9240,9375,9615,9735,9923,10260,10455],
                    [4935,5475,5610,5850,6045,6240,6435,6645,7080,7230,7425,7620,7830,7695,8235,8445,8625,8820,9030,9465,9645,9840,10065,10305,10500,10680],
                    [5250,5610,5775,5970,6195,6420,6615,6810,7260,7425,7620,7830,8010,7890,8460,8640,8865,9060,9255,9705,9885,10065,10200,10530,10830,11025],
                    [5370,5775,5925,6135,6255,6495,6795,6990,7440,7605,7815,8010,8235,8085,8640,8880,9090,9270,9510,9930,10155,10350,10411,10725,11085,11310],
                    [5490,5925,6090,6300,6420,6615,6975,7185,7665,7800,7995,8235,8445,8265,8880,9090,9285,9540,9720,10185,10350,10545,10694,10931,11295,11482],
                    [5610,6075,6255,6435,6540,6780,7170,7365,7890,7980,8220,8445,8625,8475,9090,9285,9540,9735,9960,10395,10590,10845,11009,11205,11505,11655],
                    [5730,6135,6390,6600,6690,6930,7320,7545,8100,8160,8415,8610,8865,8655,9285,9540,9735,9960,10350,10635,10875,11070,11309,11505,11745,11939],
                    [5865,6300,6525,6765,6825,7095,7440,7740,8325,8370,8595,8805,9060,9270,9510,9735,9960,10350,10395,10890,11085,11295,11639,11790,12060,12269],
                    [5970,6405,6690,6870,7050,7230,7410,7590,7770,7905,8130,8340,8610,8820,9015,9225,9465,9720,10635,10215,10695,10845,11070,11355,11550,11730]
                ]
            },
            // RS Universal 120 / 125
            "RS Universal 120": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4741,4851,4961,5072,5182,5324,5418,5528],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,5119,5182,5324,5418,5544,5670,5765],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5056,5166,5371,5434,5544,5670,5780,5906,6048],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5292,5418,5607,5670,5780,5906,6048,6158,6284],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5513,5670,5891,5985,6095,6237,6379,6495,6615],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5749,5906,6127,6206,6347,6495,6631,6773,6900],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4820,4961,5119,5245,5387,5528,5670,5780,6001,6158,6379,6473,6615,6757,6900,7050,7170],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,4946,5150,5324,5465,5576,5733,5875,6032,6174,6395,6631,6725,6883,7025,7170,7305,7440],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5213,5355,5497,5654,5780,5954,6080,6221,6410,6600,6899,6993,7135,7287,7425,7590,7725],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6647,6810,7166,7261,7410,7560,7718,7860,7980],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6851,7080,7434,7513,7670,7815,7970,8130,8250],
                    [4316,4489,4646,4820,4961,5135,5292,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7056,7230,7655,7785,7920,8085,8235,8415,8505],
                    [4473,4646,4820,4961,5135,5324,5465,5639,5765,5954,6111,6269,6426,6615,6757,6930,7103,7277,7455,7938,8017,8175,8340,8489,8655,8745],
                    [4631,4804,4946,5119,5324,5465,5639,5780,5985,6127,6300,6473,6647,6788,6962,7135,7308,7466,7695,8174,8280,8442,8610,8775,8940,9000],
                    [4725,4946,5135,5261,5465,5639,5812,6001,6158,6332,6505,6678,6820,6993,7166,7340,7513,7733,7920,8442,8537,8694,8865,9025,9195,9255],
                    [4883,5119,5324,5418,5639,5780,5985,6127,6300,6473,6694,6851,7040,7214,7387,7576,7749,7954,8160,8694,8789,8970,9135,9300,9465,9510],
                    [4993,5261,5481,5560,5780,5922,6111,6269,6426,6631,6867,7056,7245,7418,7592,7781,7954,8159,8363,8930,9030,9195,9360,9540,9675,9780],
                    [5135,5402,5654,5717,5985,6158,6347,6495,6647,6851,7088,7261,7434,7607,7796,7985,8159,8363,8615,9214,9308,9482,9645,9825,9990,9990],
                    [5245,5481,5812,5891,6080,6284,6473,6631,6788,7025,7261,7434,7623,7812,8001,8190,8379,8552,8726,9419,9513,9702,9860,10035,10215,10275],
                    [5402,5670,6001,6017,6284,6505,6615,6788,6962,7214,7434,7639,7828,8064,8206,8411,8615,8789,8993,9734,9825,10020,10185,10365,10530,10515],
                    [5513,5859,6111,6206,6395,6694,6851,6993,7135,7387,7592,7796,8017,8237,8426,8615,8789,8993,9180,9938,10049,10238,10411,10584,10785,10740],
                    [5654,6017,6347,6395,6631,6820,7103,7214,7340,7560,7812,7985,8174,8348,8584,8789,8978,9182,9371,10206,10285,10490,10663,10836,11010,11010],
                    [6048,6206,6615,6631,6851,7056,7340,7403,7592,7733,8064,8237,8442,8610,8773,8993,9182,9387,9570,10395,10505,10710,10899,11057,11235,11265],
                    [6552,6395,6851,6820,7025,7308,7592,7623,7844,7970,8316,8489,8694,8867,9056,9277,9450,9655,9840,10584,10679,10931,11088,11261,11450,11520],
                    [7387,6631,7103,6993,7261,7513,7844,7954,8096,8206,8584,8726,8970,9135,9324,9540,9749,9907,10112,10631,10805,11025,11198,11324,11561,11745],
                    [6710,6820,7340,7214,7403,7781,8096,8253,8363,8442,8852,8993,9214,9371,9576,9735,9923,10206,10379,10899,10931,11151,11356,11592,11750,12015]
                ]
            },
            "RS Universal 125": {
                w: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                h: [100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350],
                prices: [
                    [2693,2819,2930,3040,3150,3260,3402,3497,3607,3733,3827,3938,4079,4174,4284,4394,4505,4631,4741,4851,4961,5072,5182,5324,5418,5528],
                    [2867,2961,3087,3182,3308,3449,3560,3654,3780,3906,4032,4142,4253,4379,4489,4599,4725,4851,4914,5119,5182,5324,5418,5544,5670,5765],
                    [2993,3119,3229,3339,3481,3607,3733,3843,3953,4111,4205,4316,4457,4552,4709,4820,4946,5056,5166,5371,5434,5544,5670,5780,5906,6048],
                    [3134,3260,3418,3512,3638,3780,3875,4032,4158,4268,4394,4520,4646,4788,4898,5024,5150,5292,5418,5607,5670,5780,5906,6048,6158,6284],
                    [3276,3434,3560,3670,3812,3938,4095,4190,4316,4457,4568,4725,4851,4993,5119,5245,5387,5513,5670,5891,5985,6095,6237,6379,6495,6615],
                    [3449,3575,3701,3827,3969,4127,4253,4379,4505,4646,4788,4898,5040,5182,5339,5465,5576,5749,5906,6127,6206,6347,6495,6631,6773,6900],
                    [3591,3733,3859,3985,4142,4284,4426,4536,4709,4820,4961,5119,5245,5387,5528,5670,5780,6001,6158,6379,6473,6615,6757,6900,7050,7170],
                    [3749,3859,4032,4174,4300,4457,4568,4741,4867,4946,5150,5324,5465,5576,5733,5875,6032,6174,6395,6631,6725,6883,7025,7170,7305,7440],
                    [3875,4048,4174,4316,4473,4631,4772,4898,5056,5213,5355,5497,5654,5780,5954,6080,6221,6410,6600,6899,6993,7135,7287,7425,7590,7725],
                    [4048,4190,4347,4489,4646,4804,4946,5087,5245,5402,5544,5702,5859,6017,6158,6300,6442,6647,6810,7166,7261,7410,7560,7718,7860,7980],
                    [4174,4347,4489,4646,4804,4961,5119,5261,5418,5560,5733,5891,6048,6190,6347,6521,6678,6851,7080,7434,7513,7670,7815,7970,8130,8250],
                    [4316,4489,4646,4820,4961,5135,5292,5434,5591,5749,5922,6080,6237,6395,6552,6725,6867,7056,7230,7655,7785,7920,8085,8235,8415,8505],
                    [4473,4646,4820,4961,5135,5324,5465,5639,5765,5954,6111,6269,6426,6615,6757,6930,7103,7277,7455,7938,8017,8175,8340,8489,8655,8745],
                    [4631,4804,4946,5119,5324,5465,5639,5780,5985,6127,6300,6473,6647,6788,6962,7135,7308,7466,7695,8174,8280,8442,8610,8775,8940,9000],
                    [4725,4946,5135,5261,5465,5639,5812,6001,6158,6332,6505,6678,6820,6993,7166,7340,7513,7733,7920,8442,8537,8694,8865,9025,9195,9255],
                    [4883,5119,5324,5418,5639,5780,5985,6127,6300,6473,6694,6851,7040,7214,7387,7576,7749,7954,8160,8694,8789,8970,9135,9300,9465,9510],
                    [4993,5261,5481,5560,5780,5922,6111,6269,6426,6631,6867,7056,7245,7418,7592,7781,7954,8159,8363,8930,9030,9195,9360,9540,9675,9780],
                    [5135,5402,5654,5717,5985,6158,6347,6495,6647,6851,7088,7261,7434,7607,7796,7985,8159,8363,8615,9214,9308,9482,9645,9825,9990,9990],
                    [5245,5481,5812,5891,6080,6284,6473,6631,6788,7025,7261,7434,7623,7812,8001,8190,8379,8552,8726,9419,9513,9702,9860,10035,10215,10275],
                    [5402,5670,6001,6017,6284,6505,6615,6788,6962,7214,7434,7639,7828,8064,8206,8411,8615,8789,8993,9734,9825,10020,10185,10365,10530,10515],
                    [5513,5859,6111,6206,6395,6694,6851,6993,7135,7387,7592,7796,8017,8237,8426,8615,8789,8993,9180,9938,10049,10238,10411,10584,10785,10740],
                    [5654,6017,6347,6395,6631,6820,7103,7214,7340,7560,7812,7985,8174,8348,8584,8789,8978,9182,9371,10206,10285,10490,10663,10836,11010,11010],
                    [6048,6206,6615,6631,6851,7056,7340,7403,7592,7733,8064,8237,8442,8610,8773,8993,9182,9387,9570,10395,10505,10710,10899,11057,11235,11265],
                    [6552,6395,6851,6820,7025,7308,7592,7623,7844,7970,8316,8489,8694,8867,9056,9277,9450,9655,9840,10584,10679,10931,11088,11261,11450,11520],
                    [7387,6631,7103,6993,7261,7513,7844,7954,8096,8206,8584,8726,8970,9135,9324,9540,9749,9907,10112,10631,10805,11025,11198,11324,11561,11745],
                    [6710,6820,7340,7214,7403,7781,8096,8253,8363,8442,8852,8993,9214,9371,9576,9735,9923,10206,10379,10899,10931,11151,11356,11592,11750,12015]
                ]
            },
        };
        
        // Koppla RS Classic 125 till samma matris som 120
        priceMatrices["RS Classic 125"] = priceMatrices["RS Classic 120"];
        
        // TODO: Lägg till matriser för:
        // - Mini ZIP
        // - RS Universal 105
        // - RS Smart 130 (ej XL)

        // State
        let currentVendor = "screen_2025";
        let currentCalc = null;
        let quote = {
            products: [],
            accessories: [],
            services: []
        };

        // DOM Elements
        const el = {
            vendorRadios: document.querySelectorAll('input[name="vendor"]'),
            catSelect: document.getElementById('category'),
            prodSelect: document.getElementById('product'),
            boxSelect: document.getElementById('box-shape'),
            width: document.getElementById('width'),
            height: document.getElementById('height'),
            motor: document.getElementById('motor'),
            color: document.getElementById('color'),
            
            // Valideringselement (Fixat)
            dimVisualQ: document.getElementById('dim-visual-q'), 
            dimText: document.getElementById('dim-text'), 
            
            // Resultatpanel (Fixat ID)
            resPanel: document.getElementById('result-panel'),
            resPriceGross: document.getElementById('res-price-gross'),
            resPriceNet: document.getElementById('res-price-net'),
            resDims: document.getElementById('res-dims'),
            resDetails: document.getElementById('res-details'),
            resQty: document.getElementById('res-qty'),
            resDiscount: document.getElementById('res-discount'),
            
            calcBtn: document.getElementById('calculate-btn'),
            
            // Tillbehör (Fixat element)
            accCat: document.getElementById('acc-cat'),
            accItem: document.getElementById('acc-item'),
            accQty: document.getElementById('acc-qty'),

            // Tjänster
            svcType: document.getElementById('service-type'),
            svcPrice: document.getElementById('service-price'),

            // Listor
            prodList: document.getElementById('quote-items'),
            accList: document.getElementById('accessories-container'), // Fixat container ID
            accSection: document.getElementById('accessory-section'),
            totalSum: document.getElementById('total-price'), // Fixat ID
            emptyMsg: document.getElementById('empty-state'), // Fixat ID
            refId: document.getElementById('ref-id'),
            currentDate: document.getElementById('current-date')
        };

        // --- INIT ---
        if(el.refId) el.refId.innerText = 'REF-' + Math.floor(10000 + Math.random() * 90000);
        if(el.currentDate) el.currentDate.innerText = new Date().toLocaleDateString('nb-NO');
        updateCategories();

        // --- LISTENERS ---
        el.vendorRadios.forEach(r => r.addEventListener('change', (e) => {
            currentVendor = e.target.value;
            updateCategories();
            clearCalc();
        }));

        el.catSelect.addEventListener('change', updateProducts);
        
        el.prodSelect.addEventListener('change', () => {
            updateBoxShapes();
            updateVisualQ(); 
            clearCalc();
        });

        [el.width, el.height].forEach(input => {
            if(input) input.addEventListener('input', validateDimensions);
        });

        if(el.resDiscount) {
            el.resDiscount.addEventListener('input', () => {
                if (currentCalc) updateDiscountDisplay();
            });
        }

        if(el.accCat) {
            el.accCat.addEventListener('change', () => {
                const cat = el.accCat.value;
                el.accItem.innerHTML = '<option value="">-- Velg --</option>';
                
                if (cat && accessoriesDb && accessoriesDb[cat]) {
                    el.accItem.disabled = false;
                    accessoriesDb[cat].forEach(item => {
                        const opt = document.createElement('option');
                        opt.value = item.id;
                        opt.textContent = `${item.name} (${item.price} kr)`;
                        opt.dataset.price = item.price;
                        opt.dataset.name = item.name;
                        el.accItem.appendChild(opt);
                    });
                } else {
                    el.accItem.disabled = true;
                }
            });
        }

        if(el.calcBtn) el.calcBtn.addEventListener('click', calculateProductPrice);
        const addToQuoteBtn = document.getElementById('add-to-quote-btn');
        if(addToQuoteBtn) addToQuoteBtn.addEventListener('click', addProductToQuote);

        // --- LOGIC FUNCTIONS ---

        function updateCategories() {
            el.catSelect.innerHTML = '<option value="">-- Velg Familie --</option>';
            el.prodSelect.innerHTML = '<option value="">-- Velg --</option>';
            el.prodSelect.disabled = true;
            
            if(el.boxSelect) { 
                el.boxSelect.disabled = true;
                el.boxSelect.innerHTML = '<option value="">-- Velg modell først --</option>';
            }
            
            if(el.dimVisualQ) el.dimVisualQ.classList.add('hidden');
            
            const cats = database[currentVendor].categories;
            for(const cat in cats) {
                const opt = document.createElement('option');
                opt.value = cat;
                opt.textContent = cat;
                el.catSelect.appendChild(opt);
            }
            updateExtras();
        }

        function updateExtras() {
            el.motor.innerHTML = '';
            database[currentVendor].motors.forEach(m => {
                const opt = document.createElement('option');
                opt.value = m.price;
                opt.textContent = `${m.name} (+${m.price})`;
                el.motor.appendChild(opt);
            });
            el.color.innerHTML = '';
            database[currentVendor].colors.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c.surcharge;
                opt.textContent = c.name + (c.surcharge > 0 ? ` (+${Math.round(c.surcharge*100)}%)` : '');
                el.color.appendChild(opt);
            });
        }

        function updateProducts() {
            const cat = el.catSelect.value;
            el.prodSelect.innerHTML = '<option value="">-- Velg Modell --</option>';
            
            if (cat) {
                el.prodSelect.disabled = false;
                const prods = database[currentVendor].categories[cat];
                for(const prod in prods) {
                    const opt = document.createElement('option');
                    opt.value = prod;
                    opt.textContent = prod;
                    el.prodSelect.appendChild(opt);
                }
            } else {
                el.prodSelect.disabled = true;
                if(el.boxSelect) el.boxSelect.disabled = true; 
            }
        }

        function updateBoxShapes() {
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;
            if(!el.boxSelect) return;
            
            el.boxSelect.innerHTML = '';
            el.boxSelect.disabled = false;

            let shapes = database[currentVendor].boxTypes || {}; 

            if (cat && prod) {
                const prodData = database[currentVendor].categories[cat][prod];
                if (prodData.boxTypes) {
                    shapes = prodData.boxTypes;
                }
            }
            
            const defaultOpt = document.createElement('option');
            defaultOpt.value = "";
            defaultOpt.textContent = Object.keys(shapes).length > 0 ? "-- Velg Kassett --" : "Standard (Ingen valg)";
            el.boxSelect.appendChild(defaultOpt);

            for (const [key, val] of Object.entries(shapes)) {
                const opt = document.createElement('option');
                opt.value = JSON.stringify(val);
                let surchargeText = "";
                if (val.surcharge > 0) {
                    surchargeText = val.surcharge < 1 ? ` (+${Math.round(val.surcharge*100)}%)` : ` (+${val.surcharge} kr)`;
                }
                opt.textContent = val.name + surchargeText;
                el.boxSelect.appendChild(opt);
            }
        }

        function updateVisualQ() {
            if(!el.dimVisualQ) return;
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;
            
            if (cat && prod) {
                const prodData = database[currentVendor].categories[cat][prod];
                const range = prodData.range || {minW:0, maxW:0, minH:0, maxH:0};
                const unit = database[currentVendor].unit;
                
                el.dimText.textContent = `Tillatte mål for ${prod}: Bredde ${range.minW}-${range.maxW}, Høyde ${range.minH}-${range.maxH} ${unit}`;
                el.dimVisualQ.classList.remove('hidden');
                el.dimVisualQ.className = "bg-blue-50 border border-blue-200 rounded px-3 py-2 flex items-center gap-2 text-xs text-blue-800 transition-colors mb-3 fade-in";
            } else {
                el.dimVisualQ.classList.add('hidden');
            }
        }

        function validateDimensions() {
            if(!el.dimVisualQ) return;
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;
            if (!cat || !prod) return;

            const w = parseFloat(el.width.value);
            const h = parseFloat(el.height.value);
            const prodData = database[currentVendor].categories[cat][prod];
            const range = prodData.range || {minW:0, maxW:9999, minH:0, maxH:9999};
            
            let valid = true;
            if (w && (w < range.minW || w > range.maxW)) valid = false;
            if (h && (h < range.minH || h > range.maxH)) valid = false;

            if (!valid) {
                el.dimVisualQ.className = "bg-red-50 border border-red-200 rounded px-3 py-2 flex items-center gap-2 text-xs text-red-800 transition-colors mb-3";
                el.dimText.innerHTML = `<i class="fa-solid fa-triangle-exclamation"></i> Mål utenfor grensene! (B ${range.minW}-${range.maxW}, H ${range.minH}-${range.maxH})`;
                el.calcBtn.disabled = true;
                el.calcBtn.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                el.dimVisualQ.className = "bg-blue-50 border border-blue-200 rounded px-3 py-2 flex items-center gap-2 text-xs text-blue-800 transition-colors mb-3";
                const unit = database[currentVendor].unit;
                el.dimText.textContent = `Tillatte mål for ${prod}: Bredde ${range.minW}-${range.maxW}, Høyde ${range.minH}-${range.maxH} ${unit}`;
                el.calcBtn.disabled = false;
                el.calcBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            }
        }

        function clearCalc() {
            if(el.resPanel) {
                el.resPanel.classList.add('hidden', 'translate-y-4', 'opacity-0');
                el.resPanel.classList.remove('translate-y-0', 'opacity-100');
            }
            currentCalc = null;
        }

        function calculateProductPrice() {
            const w = parseFloat(el.width.value);
            const h = parseFloat(el.height.value);
            const cat = el.catSelect.value;
            const prod = el.prodSelect.value;
            
            if (!w || !h || !cat || !prod) return;

            const prodData = database[currentVendor].categories[cat][prod];
            let basePrice = 0;

            const matrix = priceMatrices[prod];
            if (matrix) {
                let wIndex = -1;
                let searchW = (database[currentVendor].unit === "mm") ? w * 10 : w; 
                if (database[currentVendor].name.includes("Neva")) {
                     searchW = w * 10; 
                } else {
                     searchW = w;
                }

                let searchH = (database[currentVendor].name.includes("Neva")) ? h * 10 : h;
                
                for(let i=0; i < matrix.w.length; i++) {
                    if (matrix.w[i] >= searchW) {
                        wIndex = i;
                        break;
                    }
                }
                let hIndex = -1;
                for(let i=0; i < matrix.h.length; i++) {
                    if (matrix.h[i] >= searchH) {
                        hIndex = i;
                        break;
                    }
                }

                if (wIndex > -1 && hIndex > -1 && matrix.prices[hIndex] && matrix.prices[hIndex][wIndex]) {
                    basePrice = matrix.prices[hIndex][wIndex];
                } else {
                    basePrice = prodData.base * 1.5; 
                }

            } else {
                const wPerc = (w - prodData.range.minW) / (prodData.range.maxW - prodData.range.minW);
                const hPerc = (h - prodData.range.minH) / (prodData.range.maxH - prodData.range.minH);
                let matrixFactor = 1 + (wPerc * 0.85) + (hPerc * 0.65); 
                basePrice = Math.round(prodData.base * matrixFactor);
            }

            let boxName = "";
            if (el.boxSelect && !el.boxSelect.disabled && el.boxSelect.value) {
                const boxData = JSON.parse(el.boxSelect.value);
                boxName = boxData.name;
                if (boxData.surcharge > 0) {
                    if (boxData.surcharge < 1) basePrice = basePrice * (1 + boxData.surcharge);
                    else basePrice += boxData.surcharge;
                }
            }

            const colorSurcharge = parseFloat(el.color.value);
            if (colorSurcharge > 0) basePrice = basePrice * (1 + colorSurcharge);

            const motorPrice = parseFloat(el.motor.value);
            const grossPrice = Math.round(basePrice + motorPrice);

            const unit = database[currentVendor].unit;
            currentCalc = {
                type: 'product',
                name: prod,
                details: `${cat} ${boxName ? '• ' + boxName : ''}`,
                dims: `${w} x ${h} cm`,
                motor: el.motor.options[el.motor.selectedIndex].text,
                color: el.color.options[el.color.selectedIndex].text,
                grossPrice: grossPrice,
                netPrice: grossPrice
            };

            updateDiscountDisplay();
            
            if(el.resDims) el.resDims.innerText = currentCalc.dims;
            if(el.resDetails) el.resDetails.innerText = `${currentCalc.details}`;
            
            if(el.resPanel) {
                // Ta bort alla animations-klasser OCH hidden samtidigt för omedelbar interaktivitet
                el.resPanel.classList.remove('hidden', 'translate-y-4', 'opacity-0');
                el.resPanel.classList.add('translate-y-0', 'opacity-100');
            }
        }

        function updateDiscountDisplay() {
            if(!currentCalc) return;
            const discount = parseFloat(el.resDiscount ? el.resDiscount.value : 0) || 0;
            const net = Math.round(currentCalc.grossPrice * (1 - (discount/100)));
            
            if(el.resPriceGross) el.resPriceGross.innerText = currentCalc.grossPrice.toLocaleString();
            if(el.resPriceNet) el.resPriceNet.innerText = net.toLocaleString();
            currentCalc.discount = discount;
            currentCalc.netPrice = net;
        }

        function changeQty(delta) {
            const input = document.getElementById('res-qty') || document.getElementById('quantity'); // Fallback
            if(!input) return;
            let val = parseInt(input.value) + delta;
            if(val < 1) val = 1;
            input.value = val;
        }

        function addProductToQuote() {
            if (!currentCalc) return;
            const qtyInput = document.getElementById('res-qty');
            const qty = qtyInput ? parseInt(qtyInput.value) : 1;
            
            updateDiscountDisplay(); 

            quote.products.push({
                ...currentCalc,
                id: Date.now(),
                qty: qty,
                total: currentCalc.netPrice * qty
            });

            renderQuote();
            clearCalc();
            if(qtyInput) qtyInput.value = 1;
            if(el.resDiscount) el.resDiscount.value = '';
        }

        function addAccessory() {
            const sel = el.accItem;
            if (!sel || sel.selectedIndex < 1) return;
            
            const price = parseFloat(sel.options[sel.selectedIndex].dataset.price);
            const name = sel.options[sel.selectedIndex].dataset.name;
            const qty = parseInt(el.accQty.value);

            quote.accessories.push({
                id: Date.now(),
                type: 'accessory',
                name: name,
                details: 'Tilbehør',
                price: price,
                qty: qty,
                total: price * qty
            });
            renderQuote();
        }

        function addService() {
            const typeSel = el.svcType;
            const priceInp = el.svcPrice;
            if(!typeSel || !priceInp) return;

            const type = typeSel.options[typeSel.selectedIndex].text;
            const price = parseFloat(priceInp.value);
            if (!price) return;

            quote.services.push({
                id: Date.now(),
                type: 'service',
                name: type,
                details: 'Tjeneste',
                price: price,
                qty: 1,
                total: price
            });
            priceInp.value = '';
            renderQuote();
        }

        function renderQuote() {
            let grandTotal = 0;
            const container = el.prodList;
            const accContainer = el.accList;
            
            if(!container) return;
            
            container.innerHTML = '';
            if(accContainer) accContainer.innerHTML = '';

            if (quote.products.length === 0) {
                if(el.emptyMsg) el.emptyMsg.classList.remove('hidden');
            } else {
                if(el.emptyMsg) el.emptyMsg.classList.add('hidden');
                
                // Render Products
                quote.products.forEach((item, index) => {
                    grandTotal += item.total;
                    const div = document.createElement('div');
                    div.className = 'grid grid-cols-12 gap-2 p-3 bg-slate-50 rounded border border-slate-100 items-center text-xs fade-in group';
                    div.innerHTML = `
                        <div class="col-span-5">
                            <p class="font-bold text-slate-700">${item.name}</p>
                            <p class="text-[10px] text-slate-500">${item.details}</p>
                            <p class="text-[10px] text-slate-400 mt-0.5">Farge: ${item.color} | Motor: ${item.motor}</p>
                        </div>
                        <div class="col-span-2 text-center font-mono text-slate-600">${item.dims}</div>
                        <div class="col-span-2 text-center">
                            <span class="font-bold bg-white px-2 py-1 rounded border border-slate-200">${item.qty} stk</span>
                        </div>
                        <div class="col-span-2 text-right font-bold text-slate-800">
                            ${item.total.toLocaleString()} NOK
                            ${item.discount > 0 ? `<p class="text-[9px] text-green-600">-${item.discount}%</p>` : ''}
                        </div>
                        <div class="col-span-1 text-right opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="removeFromQuote('products', ${index})" class="text-red-400 hover:text-red-600 p-1">
                                <i class="fa-solid fa-trash-can"></i>
                            </button>
                        </div>
                    `;
                    container.appendChild(div);
                });
            }

            // Render Accessories & Services
            const allExtras = [...quote.accessories, ...quote.services];
            if(allExtras.length > 0) {
                if(el.accSection) el.accSection.classList.remove('hidden');
                
                allExtras.forEach((item, index) => {
                    grandTotal += item.total;
                    const div = document.createElement('div');
                    div.className = 'grid grid-cols-12 gap-2 px-6 py-2 border-b border-slate-100 last:border-0 text-xs items-center hover:bg-slate-50/50 group';
                    
                    // Find actual index in original arrays for deletion
                    const typeKey = item.type === 'service' ? 'services' : 'accessories';
                    const realIndex = quote[typeKey].findIndex(x => x.id === item.id);

                    div.innerHTML = `
                        <div class="col-span-5 pl-2 flex items-center gap-2">
                            <i class="fa-solid ${item.type === 'service' ? 'fa-hand-holding-dollar' : 'fa-box-open'} text-slate-300"></i>
                            <div>
                                <p class="font-medium text-slate-700">${item.name}</p>
                                <p class="text-[10px] text-slate-400">${item.details}</p>
                            </div>
                        </div>
                        <div class="col-span-2 text-center text-slate-400">-</div>
                        <div class="col-span-2 text-center text-slate-600">${item.qty} stk</div>
                        <div class="col-span-2 text-right font-medium text-slate-700">${item.total.toLocaleString()} NOK</div>
                        <div class="col-span-1 text-right opacity-0 group-hover:opacity-100 transition-opacity">
                            <button onclick="removeFromQuote('${typeKey}', ${realIndex})" class="text-red-400 hover:text-red-600">
                                <i class="fa-solid fa-xmark"></i>
                            </button>
                        </div>
                    `;
                    if(accContainer) accContainer.appendChild(div);
                });
            } else {
                if(el.accSection) el.accSection.classList.add('hidden');
            }

            // Update Footer
            if(el.totalSum) el.totalSum.innerText = grandTotal.toLocaleString() + " NOK";
            const totalCount = quote.products.length + quote.accessories.length + quote.services.length;
            const countBadge = document.getElementById('quote-count');
            if(countBadge) countBadge.innerText = `${totalCount} artikler`;
        }

        function removeFromQuote(type, index) {
            if(quote[type]) {
                quote[type].splice(index, 1);
                renderQuote();
            }
        }

        function clearQuote() {
            if(confirm("Er du sikker på at du vil slette hele tilbudet?")) {
                quote.products = [];
                quote.accessories = [];
                quote.services = [];
                renderQuote();
            }
        }

        function handleChat() {
            const input = document.getElementById('ai-input');
            const responseDiv = document.getElementById('ai-response');
            if(!input || !responseDiv) return;
            
            const q = input.value.toLowerCase();
            if(!q) return;

            responseDiv.classList.remove('hidden');
            responseDiv.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Tenker...';

            setTimeout(() => {
                let answer = "Jeg er ikke sikker på det. Prøv å spørre om 'motor', 'maks bredde' eller spesifikke modeller.";
                
                if(q.includes('smart xl') || q.includes('130 xl')) {
                    answer = "RS Smart 130 XL er vårt system for virkelig store vinduer. Den klarer opptil 7 meter i bredde og er vindtålig (zip-system).";
                } else if(q.includes('motor') || q.includes('somfy')) {
                    answer = "Vi anbefaler ofte Somfy IO for smarthus-integrasjon, men Faher Radio er et prisgunstig standardalternativ.";
                } else if(q.includes('max') || q.includes('bredd')) {
                    answer = "Maksbredden varierer per modell. RS Smart XL klarer 7m, mens vanlige Smart 100 klarer opptil 4m.";
                }

                responseDiv.innerText = answer;
            }, 800);
        }
    </script>
</body>
</html>
